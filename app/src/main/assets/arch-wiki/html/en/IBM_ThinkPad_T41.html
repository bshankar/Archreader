<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8">
<title>IBM ThinkPad T41 - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style></style>
<meta name="generator" content="MediaWiki 1.26.4">
<meta name="robots" content="noindex,follow">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-IBM_ThinkPad_T41 skin-archlinux action-view">

		<div id="globalWrapper" style="width: 100%">
		<div id="column-content">
			<div id="content" class="mw-body" role="main" style="margin: 0.5em; margin-bottom:0; margin-top:0">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">IBM ThinkPad T41</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="contentSub"></div>
										<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> <span style="color:red;">please use the first argument of the template to provide a brief explanation.</span> (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:IBM_ThinkPad_T41">Talk:IBM ThinkPad T41#</a>)</div>
</div>
<p>This article covers the installation and configuration of Arch Linux on an IBM/Lenovo T41 laptop.  These laptops were very popular with corporate customers, and are now available reconditioned fairly cheaply. Typical spec is a 1.6GHz Pentium M, 512MB RAM, 32MB ATI Radeon graphics adapter and a 40GB hard drive. It is possible to get most if not all of the hardware to work in Arch.
</p>
<div id="toc" class="toc">
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Preparation_and_Installation"><span class="tocnumber">1</span> <span class="toctext">Preparation and Installation</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#ACPI"><span class="tocnumber">2</span> <span class="toctext">ACPI</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Hibernation_and_Sleep"><span class="tocnumber">2.1</span> <span class="toctext">Hibernation and Sleep</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#CPU_Frequency_Scaling"><span class="tocnumber">2.2</span> <span class="toctext">CPU Frequency Scaling</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#ACPI_Events"><span class="tocnumber">2.3</span> <span class="toctext">ACPI Events</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Special_Modules"><span class="tocnumber">2.4</span> <span class="toctext">Special Modules</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#APM"><span class="tocnumber">3</span> <span class="toctext">APM</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Hibernation"><span class="tocnumber">3.1</span> <span class="toctext">Hibernation</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Speedstep"><span class="tocnumber">3.2</span> <span class="toctext">Speedstep</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10">
<a href="#Fn.2BFX_Function_Keys_and_Special_Buttons"><span class="tocnumber">4</span> <span class="toctext">Fn+FX Function Keys and Special Buttons</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Volume.2C_Brightness.2C_Thinklight_.26_Lid"><span class="tocnumber">4.1</span> <span class="toctext">Volume, Brightness, Thinklight &amp; Lid</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Back_and_Forward"><span class="tocnumber">4.2</span> <span class="toctext">Back and Forward</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Other_Keys_and_Buttons"><span class="tocnumber">4.3</span> <span class="toctext">Other Keys and Buttons</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#tpb"><span class="tocnumber">4.4</span> <span class="toctext">tpb</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#UltraPad_and_TrackPoint"><span class="tocnumber">5</span> <span class="toctext">UltraPad and TrackPoint</span></a></li>
<li class="toclevel-1 tocsection-16">
<a href="#Networking"><span class="tocnumber">6</span> <span class="toctext">Networking</span></a>
<ul>
<li class="toclevel-2 tocsection-17">
<a href="#Wireless"><span class="tocnumber">6.1</span> <span class="toctext">Wireless</span></a>
<ul>
<li class="toclevel-3 tocsection-18"><a href="#Atheros_Cards"><span class="tocnumber">6.1.1</span> <span class="toctext">Atheros Cards</span></a></li>
<li class="toclevel-3 tocsection-19"><a href="#Cisco_Cards"><span class="tocnumber">6.1.2</span> <span class="toctext">Cisco Cards</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#Intel_Cards"><span class="tocnumber">6.1.3</span> <span class="toctext">Intel Cards</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="#Display"><span class="tocnumber">7</span> <span class="toctext">Display</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="#Hard_drive_Active_Protection"><span class="tocnumber">8</span> <span class="toctext">Hard drive Active Protection</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#See_also"><span class="tocnumber">9</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Preparation_and_Installation">Preparation and Installation</span></h2>
<p>This laptop has a hidden protected area (HPA) at the end of the hard drive, which can be used to restore the default OS (usually Windows XP Pro) to the factory state.  If you do not want to use this feature, or have the recovery disks, you can reclaim about 3GB by disabling the "IBM Predesktop Area" in the BIOS.
</p>
<p>If you have the recovery disks or an intact HPA, they are the best way to install Windows (if you want to dual boot).  Do this first, as the recovery disks will overwrite your MBR, and possibly other things too. Then you can shrink down the partition it creates, and install Arch.
</p>
<p>Note you can <a rel="nofollow" class="external text" href="http://thinkwiki.org/wiki/Ordering_Recovery_CDs#Creating_Recovery_CDs_from_the_preinstalled_O.2FS">Create Recovery CDs from the preinstalled OS</a> if you need to, or if you're still under warranty, IBM may send some out to you.
</p>
<p>You can then install Arch as normal: <a href="../en/Installation_guide.html" title="Installation guide">Official Install Guide</a>.
</p>
<h2><span class="mw-headline" id="ACPI">ACPI</span></h2>
<p>The TP41 has excelent ACPI support.  For the steps below, you will need acpid, which is available through pacman.
</p>
<h3><span class="mw-headline" id="Hibernation_and_Sleep">Hibernation and Sleep</span></h3>
<p>The easiest way is to use <a href="../en/Pm-utils.html" title="Pm-utils">pm-utils</a>, which supports suspend to RAM (sleep), suspend to file and suspend to swap (hibernate).
</p>
<h3><span class="mw-headline" id="CPU_Frequency_Scaling">CPU Frequency Scaling</span></h3>
<p>This Laptop has a Pentium M Banias chip, which supports <a href="../en/CPU_frequency_scaling.html" title="Speedstep" class="mw-redirect">speedstep</a>
</p>
<p>You need the cpufrequtils package, and either cpufreqd or cpudyn.  The correct module for the Banias is acpi_cpufreq.
</p>
<h3><span class="mw-headline" id="ACPI_Events">ACPI Events</span></h3>
<p>Out of the box, Fn+F4, Fn+F12 and the power button generate ACPI events.  The thinkpad_acpi module can generate more events, see "FnFx and Special Buttons" below.
</p>
<h3><span class="mw-headline" id="Special_Modules">Special Modules</span></h3>
<p>The thinkpad_acpi module (which may or may not be loaded by udev) provides support for all hotkeys (see below) and a number of other features.  It has a procfs interface at <i>/proc/acpi/ibm/</i> which can be used to read out a number of thermal sensors, fan speed etc. and control volume, brightness, LEDs, beep codes and much more.  Control of fan speed is possible if the driver is loaded with the experimental option, but if you use this keep an eye on the thermal sensors.
</p>
<p>The tp_smapi module is available in the AUR.  On this model of thinkpad it only provides extra battery information;  Battery discharge control is not supported.  Note that this module conflicts with the hdaps module in the kernel mainline, they cannot both be loaded at the same time.
</p>
<h2><span class="mw-headline" id="APM">APM</span></h2>
<p>As an alternative to acpi, you can use apm. By default Arch Linux uses the much more modern acpi, so you have to boot your kernel with apm. The only reason to use apm is that with apm the ThinkPad keys work out of the box. apm is missing some features of acpi. To do so, append <code>apm=on acpi=off</code> to <a href="../en/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a>.
</p>
<h3><span class="mw-headline" id="Hibernation">Hibernation</span></h3>
<p>With apm enabled, all hotkeys work out of the box, but to use suspend to disk (Fn+F12), you have to prepare a "save2dsk.bin" file on a fat16 partition using the program <a rel="nofollow" class="external text" href="http://samba.org/junkcode/#tphdisk">tphdisk</a>. The Size of this file should be ramsize+videoramsize+few mb more. eg:
</p>
<pre>tphdisk 565 &gt; save2dsk.bin
</pre>
<p>Do a cold reboot, so the bios can see the new file.
</p>
<h3><span class="mw-headline" id="Speedstep">Speedstep</span></h3>
<p>As per ACPI
</p>
<h2><span class="mw-headline" id="Fn.2BFX_Function_Keys_and_Special_Buttons">Fn+FX Function Keys and Special Buttons</span></h2>
<h3><span class="mw-headline" id="Volume.2C_Brightness.2C_Thinklight_.26_Lid">Volume, Brightness, Thinklight &amp; Lid</span></h3>
<p>The volume buttons, Fn+Home, Fn+End, Fn+PgUp and lid buttons are wired directly to the relevant piece of hardware, so do not need any configuration.  With an appropriate mask (see below) they will still produce an acpi event, which can be used to display onscreen messages using xosd or libnotify.
</p>
<h3><span class="mw-headline" id="Back_and_Forward">Back and Forward</span></h3>
<p>The two buttons next to the arrow keys generate normal keystrokes (233 and 234) when pressed, and can used in xbindkeys or xmodmap, or as shortcut keys.  They can be used to change workspace in Metacity for example.  If you want Windows-like back and forward in your browser, there are some instructions for most browsers on the <a rel="nofollow" class="external text" href="http://www.thinkwiki.org/wiki/How_to_get_special_keys_to_work#Example_Applications">Thinkwiki</a>.
</p>
<h3><span class="mw-headline" id="Other_Keys_and_Buttons">Other Keys and Buttons</span></h3>
<p>If you are using APM most Fn+Fx keys just work. 
</p>
<p>If you are using ACPI without the thinkpad_acpi module, many work out of the box.  If you want more/better/configurable keys, read on.
</p>
<p>By default most of the keys and buttons produce an acpi event. You can test which using:
</p>
<pre>$ acpi_listen
</pre>
<p>Exactly which keys produce an event depends on the mask set in <i>/proc/acpi/ibm/hotkey</i>.  You can read the mask using cat, and change it with something like:
</p>
<pre># echo enable,0x00ffffff &gt; /proc/acpi/ibm/hotkey
</pre>
<p>The hex value is a mask, which controls which keys are handled by the laptop firmware and which ones are handled by acpid.  Exactly which bit affects which key/button is unknown, but 0x00000000 sends all events to the firmware, and 0x00ffffff send all events to acpid. The default is0 x008c7fff, which creates acpi events for most buttons, but not those listed above which are connected directly to the hardware.  If you want to set the mask at every boot, just add the above command to <i>/etc/rc.local</i>.
If unsure, just leave it alone.
</p>
<p>You must then set up acpid to handle the acpi events.  In Arch this is done through <i>/etc/acpi/handler.sh</i>, which is a bash script, and uses case structures to decide what action to take for each event.  With a mask of 0x00ffffff the following script handles most of the Fn+Fx keys according to the blue icons on them.
</p>
<p><b>FIXME: If you know how to toggle the external display on this laptop (Fn+F7), please update the script</b>
</p>
<pre>
#!/bin/sh

# Acpi script that takes an entry for all actions. For an IBM 
# Thinkpad t41, assumes hotkey mask 0x00ffffff. Uses netcfg package.
# by Jack Barraclough

set $*

case "$1" in
	ibm/hotkey)
	case "$4" in
		'00001003') # Fn + F3 switch off backlight
		        xset -display :0 dpms force off
		;;
		'00001004') # Fn + F4 suspend
			/usr/sbin/pm-suspend
		;;
		'00001005') #Fn + F5 toggles network
			if [ -f /var/run/daemons/net-profiles ]
			then
				/etc/rc.d/net-profiles stop
			else
				/etc/rc.d/net-profiles start
			fi
		;;
		'0000100c') # Fn + F12 hibernates
			/usr/sbin/pm-hibernate
		;;
		*)
			logger "ACPI action undefined: $*"
		;;
		#
		# Add your own events here.
		#
	esac
	;;
	*)
	logger "ACPI action undefined: $*"
esac
</pre>
<p>This may seem like a lot of work just to get the hotkeys working, but it is also very powerful and extensible.  You can easily add more actions, and every Fn+Fx combo generates an event.  To control <a href="../en/Music_Player_Daemon.html" title="Mpd" class="mw-redirect">mpd</a> with Fn+{F9-F11} for example:
</p>
<pre>
	'00001009') # Tell MPD to skip back Fn+F9
		mpc prev
	;;
	'0000100a') # Tell MPD to play/pause Fn+F10
		mpc toggle
	;;
	'0000100b') # Tell MPD to skip forward Fn+F11
		mpc next
	;;
</pre>
<p>One word of warning: the script runs as root, so be careful.  If you want to start firefox using the Access IBM button for example, use su or sudo to start it as your normal user, not root.
</p>
<p>A complete list of buttons/keys and the events they produce is available on the <a rel="nofollow" class="external text" href="http://www.thinkwiki.org/wiki/How_to_get_special_keys_to_work#Triggering_key_events">Thinkwiki</a>.
</p>
<h3><span class="mw-headline" id="tpb">tpb</span></h3>
<p>There is another method of getting these keys to work, using the nvram kernel module and a piece of software called tpb.  This is quite complicated, and does not work as well.  It is not recommended as thinkpad_acpi supports all the buttons on this laptop.  For the curious, there is some information on the <a href="../en/ThinkPad_OSD.html" title="ThinkPad OSD">ThinkPad OSD</a> page.
</p>
<h2><span class="mw-headline" id="UltraPad_and_TrackPoint">UltraPad and TrackPoint</span></h2>
<p>Both the pad and TrackPoint are supported by the standard mouse driver, and by the <a href="../en/Touchpad_Synaptics.html" title="Synaptics" class="mw-redirect">synaptics</a> package, which provides more functionality, such as scrolling using the edges of the pad.
The below code will give you windows like functionality.  It'll let you scroll with the middle mouse button, and also use it as a third mouse button for pasting and such.
There are more details on how to configure more options on
<a rel="nofollow" class="external text" href="http://thinkwiki.org/wiki/How_to_configure_the_TrackPoint">Thinkwiki</a>
</p>
<pre>Section "InputDevice"
      Identifier  "Configured Mouse"
      Driver      "mouse"
      Option      "CorePointer"
      Option      "Device" "/dev/input/mice"
      Option      "Protocol" "ExplorerPS/2"
      Option      "Emulate3Buttons"   "on"
      Option      "Emulate3TimeOut"   "50"
      Option      "EmulateWheel"      "on"
      Option      "EmulateWheelTimeOut" "200"
      Option      "EmulateWheelButton"        "2"
      Option      "YAxisMapping" "4 5"
      Option      "XAxisMapping" "6 7"
      Option      "ZAxisMapping" "4 5"
EndSection
</pre>
<h2><span class="mw-headline" id="Networking">Networking</span></h2>
<h3><span class="mw-headline" id="Wireless">Wireless</span></h3>
<p>The T41 comes with three diffrent wireless cards:
</p>
<ul>
<li> IBM 11a/b/g Wireless LAN Mini PCI Adapter (which uses an Atheros chipset)</li>
<li> Cisco Aironet Wireless 802.11b</li>
<li> Intel PRO/Wireless LAN 2100 3B Mini PCI Adapter</li>
</ul>
<p>You can check which you have with:
</p>
<pre>lspci | grep Ethernet
</pre>
<p>All of which should work under linux, and more details can be found on the <a href="../en/Wireless_network_configuration.html" title="Wireless network configuration">Wireless network configuration</a> page.
</p>
<h4><span class="mw-headline" id="Atheros_Cards">Atheros Cards</span></h4>
<p>These cards work out of the box with the ath5k driver. The card appears as wlan0.
</p>
<h4><span class="mw-headline" id="Cisco_Cards">Cisco Cards</span></h4>
<p><b>FIXME: If you have a cisco card in your T41, please update this section</b>
These should be supported by the open source airo module, or the closed source mpi350 module from cisco.
</p>
<h4><span class="mw-headline" id="Intel_Cards">Intel Cards</span></h4>
<p>See <a href="../en/Wireless_network_configuration.html#ipw2100_and_ipw2200" title="Wireless network configuration">Wireless network configuration#ipw2100 and ipw2200</a>.
</p>
<h2><span class="mw-headline" id="Display">Display</span></h2>
<p>The laptop has a ATI Radeon 7500 or 9000 graphics adapter, supported by the <a href="../en/ATI.html#Open-Source_ATI_Drivers" title="ATI">open source ATI driver</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" title="ArchWiki:Requests">broken link</a>: invalid section]</sup>.  Note that as of fglrx 8.28.8 these chipsets are not supported, so stick with the open source drivers.
Most of the options on the radeon man page and on the ATI driver page can be used with this chip, but there are reports of crashes or blank screens when FastAGPWrites is enabled.  On option of interest not on the ATI page is DynamicClocks, which can be used to reduce power consumption.
</p>
<h2><span class="mw-headline" id="Hard_drive_Active_Protection">Hard drive Active Protection</span></h2>
<p>The T41 has a built in accelerometer, which can be used to detect when the laptop is dropped, and park the hard drive heads.  As of Kernel 2.6.29, you no longer need to patch the kernel to make it work.  See the <a href="../en/Hard_Drive_Active_Protection_System.html" title="HDAPS" class="mw-redirect">HDAPS</a> page for a guide on setting this up.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li> <a rel="nofollow" class="external text" href="http://thinkwiki.org/">ThinkWiki (an invaluable resource) </a>
</li>
<li> <a rel="nofollow" class="external text" href="http://thinkwiki.org/wiki/Category:T41">ThinkWiki Page on the T41 </a>
</li>
<li> <a rel="nofollow" class="external text" href="ftp://ftp.software.ibm.com/pc/pccbbs/mobiles_pdf/13n6243.pdf">Thinkpad T41 Hardware Maintenance Manual</a>
</li>
</ul>

</div>
<div id="catlinks" class="catlinks">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:IBM.html" title="Category:IBM">IBM</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
<li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li>
</ul>
</div>
</div>					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
Extracted from <a href="https://wiki.archlinux.org"> ArchWiki </a> and licensed under <a href="http://www.gnu.org/copyleft/fdl.html"> GDL >= 1.3</a>
		</div>
		</div>
		</body>
</html>
