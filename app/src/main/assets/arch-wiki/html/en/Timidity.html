<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8">
<title>Timidity - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style></style>
<meta name="generator" content="MediaWiki 1.26.4">
<meta name="robots" content="noindex,follow">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Timidity skin-archlinux action-view">

		<div id="globalWrapper" style="width: 100%">
		<div id="column-content">
			<div id="content" class="mw-body" role="main" style="margin: 0.5em; margin-bottom:0; margin-top:0">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Timidity</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="contentSub"></div>
										<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<p>TiMidity++ is a <a href="https://en.wikipedia.org/wiki/software_synthesizer" class="extiw" title="wikipedia:software synthesizer">software synthesizer</a> that can play MIDI files without a hardware synthesizer. It can either render to the sound card in real time, or it can save the result to a file, such as a PCM .wav file.
</p>
<div id="toc" class="toc">
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Installation"><span class="tocnumber">1</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Configuration"><span class="tocnumber">2</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-3">
<a href="#SoundFonts"><span class="tocnumber">2.1</span> <span class="toctext">SoundFonts</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Freepats"><span class="tocnumber">2.1.1</span> <span class="toctext">Freepats</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Fluidr3"><span class="tocnumber">2.1.2</span> <span class="toctext">Fluidr3</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-6"><a href="#Daemon"><span class="tocnumber">2.2</span> <span class="toctext">Daemon</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#Usage"><span class="tocnumber">3</span> <span class="toctext">Usage</span></a>
<ul>
<li class="toclevel-2 tocsection-8">
<a href="#Play_files"><span class="tocnumber">3.1</span> <span class="toctext">Play files</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="#Standalone_mode"><span class="tocnumber">3.1.1</span> <span class="toctext">Standalone mode</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Daemon_mode"><span class="tocnumber">3.1.2</span> <span class="toctext">Daemon mode</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Connect_to_virtual_MIDI_device"><span class="tocnumber">3.1.3</span> <span class="toctext">Connect to virtual MIDI device</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-12">
<a href="#Troubleshooting"><span class="tocnumber">4</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#TiMidity.2B.2B_does_not_play_MIDI_files"><span class="tocnumber">4.1</span> <span class="toctext">TiMidity++ does not play MIDI files</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Daemon_mode_plays_sound_out_of_pace"><span class="tocnumber">4.2</span> <span class="toctext">Daemon mode plays sound out of pace</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15">
<a href="#Tips_and_tricks"><span class="tocnumber">5</span> <span class="toctext">Tips and tricks</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#Convert_files"><span class="tocnumber">5.1</span> <span class="toctext">Convert files</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#How_to_make_DOSBox_use_TiMidity.2B.2B"><span class="tocnumber">5.2</span> <span class="toctext">How to make DOSBox use TiMidity++</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#See_also"><span class="tocnumber">6</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" title="Install" class="mw-redirect">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=timidity%2B%2B">timidity++</a></span> package from the <a href="../en/Official_repositories.html" title="Official repositories">official repositories</a>.
</p>
<p>You should also install a <a href="https://en.wikipedia.org/wiki/SoundFont" class="extiw" title="wikipedia:SoundFont">SoundFont</a> to be able to produce sound. Here is a list of SoundFonts:
</p>
<ul>
<li> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=timidity-freepats">timidity-freepats</a></span>.</li>
<li> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=soundfont-fluid">soundfont-fluid</a></span>
</li>
</ul>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>First you should add yourself to the audio group.
</p>
<pre># gpasswd -a &lt;user&gt; audio
</pre>
<h3><span class="mw-headline" id="SoundFonts">SoundFonts</span></h3>
<p>Configure your preferred SoundFont.
</p>
<h4><span class="mw-headline" id="Freepats">Freepats</span></h4>
<p>The <a rel="nofollow" class="external text" href="http://freepats.zenvoid.org/">Freepats</a> project provides a set of instrument samples which are compatible with TiMidity++. 
</p>
<p>To use Freepats with TiMidity, add the following lines to <code>timidity.cfg</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/timidity++/timidity.cfg</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
dir /usr/share/timidity/freepats
source /etc/timidity++/freepats/freepats.cfg
</pre>
<h4><span class="mw-headline" id="Fluidr3">Fluidr3</span></h4>
<p>There are other SoundFonts available. To install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=soundfont-fluid">soundfont-fluid</a></span> SoundFont, append its path to the TiMidity++ configuration file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/timidity++/timidity.cfg</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
soundfont /usr/share/soundfonts/FluidR3_GM2-2.sf2
</pre>
<h3><span class="mw-headline" id="Daemon">Daemon</span></h3>
<p><a href="../en/Systemd.html#Using_units" title="Start" class="mw-redirect">Start</a> and <a href="../en/Systemd.html#Using_units" title="Enable" class="mw-redirect">enable</a> the <code>timidity.service</code>.
</p>
<p>If you are using <a href="../en/PulseAudio.html" title="PulseAudio">PulseAudio</a>, that may not work. You may want to add the following command as an auto start program in your desktop environment. Or, if you just want to start TiMidity++ in daemon mode once, you can use the following command which will make console output viewable:
</p>
<pre>$ timidity -iA
</pre>
<p>You can also use <a href="../en/Systemd/User.html" title="Systemd/User">Systemd/User</a> to write an user TiMidity++ service. To do so, write a <code>timidity.service</code> file in <code>~/.config/systemd/user/</code> like that oneÂ :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/user/timidity.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=TiMidity++ Daemon
After=sound.target

[Service]
ExecStart=/usr/bin/timidity -iA -Os

[Install]
WantedBy=default.target
</pre>
<p>Then enable the service with:
</p>
<pre> $ systemctl --user enable timidity.service
</pre>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<h3><span class="mw-headline" id="Play_files">Play files</span></h3>
<p>There are two ways to use TiMidity++. Either as MIDI player or as daemon adding MIDI support to <a href="../en/Advanced_Linux_Sound_Architecture.html" title="ALSA" class="mw-redirect">ALSA</a>.
</p>
<h4><span class="mw-headline" id="Standalone_mode">Standalone mode</span></h4>
<p>You can simply use TiMidity++ to play MIDI files:
</p>
<pre>$ timidity example.midi
</pre>
<p>Add option <code>-in</code> or <code>-ig</code> for a text-based/gtk+ interface. E.g. as a Xfce/GNOME user you may want to set MIDI files to open with the custom command <code>timidity -ig</code>. There are many other options to TiMidity++. See <code>man timidity</code> or use <code>-h</code> to get help.
</p>
<p>The GTK+ interface offers such features as a playlist, track length estimates, volume control, a file load dialog box, play and pause buttons, rewind and fast forward buttons, as well as options to change the pitch of or speed up or slow down the playback of a midi file.
</p>
<h4><span class="mw-headline" id="Daemon_mode">Daemon mode</span></h4>
<p>If you are runing TiMidity++ as a <a href="#Daemon">daemon</a> (ALSA sequencer client), it will provide MIDI output support for other programs such as rosegarden, aplaymidi, vkeybd, etc.
</p>
<p>This will give you four output software MIDI ports (in addition of hardware MIDI ports on your system, if any):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$  aconnect -o</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">client 128: 'TiMidity' [type=user]
    0 'TiMidity port 0 '
    1 'TiMidity port 1 '
    2 'TiMidity port 2 '
    3 'TiMidity port 3 '</pre>
<p>You can now play MIDI files using aplaymidi:
</p>
<pre>$ aplaymidi filename.mid --port 128:0
</pre>
<p>Another example is <b>vkeybd</b>, a virtual MIDI keyboard for X.
</p>
<p>You can <a href="../en/Help:Reading.html#Installation_of_packages" title="Install" class="mw-redirect">install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/vkeybd/">vkeybd</a></span><sup><small>AUR</small></sup> from the <a href="../en/Arch_User_Repository.html" title="AUR" class="mw-redirect">AUR</a>.
</p>
<pre>$ vkeybd --addr 128:0
</pre>
<p>Option <code>--addr 128:0</code> connects the input (readable) software MIDI port provided by vkeybd to the first output (writable) ALSA port provided by Timidity. Alternatively you can use aconnect, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/aconnectgui/">aconnectgui</a></span><sup><small>AUR</small></sup><sup>[<a href="../en/ArchWiki:Requests.html#Broken_package_links" title="ArchWiki:Requests">broken link</a>: archived in <a rel="nofollow" class="external text" href="https://github.com/felixonmars/aur3-mirror/tree/master/aconnectgui">aur-mirror</a>]</sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=patchage">patchage</a></span> or kaconnect. As a result when you play around with the keys on the vkeybd TiMidity++ plays the appropriate notes.
</p>
<h4><span class="mw-headline" id="Connect_to_virtual_MIDI_device">Connect to virtual MIDI device</span></h4>
<p>Once you have the TiMidity++ daemon running and it is working with aplaymidi, you can connect it to a virtual MIDI device that will work in programs such as rosegarden or scala.
</p>
<p>Load the <code>snd-virmidi</code> <b>kernel module</b> and (optionally) configure it to be loaded at boot. Read <a href="../en/Kernel_modules.html" title="Kernel modules">Kernel modules</a> for more information.
</p>
<p>Use aconnect to verify the port numbers:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ aconnect -o</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">client 14: 'Midi Through' [type=kernel]
     0 'Midi Through Port-0'
 client 20: 'Virtual Raw MIDI 1-0' [type=kernel]
     0 'VirMIDI 1-0     '
 client 21: 'Virtual Raw MIDI 1-1' [type=kernel]
     0 'VirMIDI 1-1     '
 client 22: 'Virtual Raw MIDI 1-2' [type=kernel]
     0 'VirMIDI 1-2     '
 client 23: 'Virtual Raw MIDI 1-3' [type=kernel]
     0 'VirMIDI 1-3     '
 client 128: 'TiMidity' [type=user]
     0 'TiMidity port 0 '
     1 'TiMidity port 1 '
     2 'TiMidity port 2 '
     3 'TiMidity port 3 '</pre>
<p>Now create the connection:
</p>
<pre>$ aconnect 20:0 128:0
</pre>
<p>You should now have a working MIDI output device on your system (<code>/dev/snd/midiC1D0</code>).
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="TiMidity.2B.2B_does_not_play_MIDI_files">TiMidity++ does not play MIDI files</span></h3>
<p>It may be that your SoundFile is not set up correctly. Just run:
</p>
<pre>$ timidity example.midi
</pre>
<p>If you find a line like this in the terminal output, your SoundFile is not set up properly.
</p>
<pre>No instrument mapped to tone bank 0, program XX - \
this instrument will not be heard
</pre>
<p>Make sure you've installed some samples and your SoundFile is added to <code>/etc/timidity++/timidity.cfg</code>. See <a href="#SoundFonts">SoundFonts</a> for more details.
</p>
<h3><span class="mw-headline" id="Daemon_mode_plays_sound_out_of_pace">Daemon mode plays sound out of pace</span></h3>
<p>TiMidity++'s ALSA output module (default) may cause this issue in ALSA server mode. Try another output option, for example, <b>libao</b>:
</p>
<pre>$ timidity -iA -OO
</pre>
<p>And test it using aplaymidi. If this does not work, you may want to configure <a href="../en/JACK_Audio_Connection_Kit.html" title="JACK" class="mw-redirect">JACK</a> and set TiMidity++'s output to jack.
</p>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3><span class="mw-headline" id="Convert_files">Convert files</span></h3>
<p>TiMidity++ can also convert MIDI files into other formats. The following command saves the resulting sound to a WAV file:
</p>
<pre>$ timidity <i>input.mid</i> -Ow -o <i>out.wav</i>
</pre>
<p>To convert to another formats, you can use <a href="../en/FFmpeg.html" title="FFmpeg">FFmpeg</a>. This will convert it to mp3:
</p>
<pre>$ timidity <i>input.mid</i> -Ow -o - | ffmpeg -i - -acodec libmp3lame -ab 256k <i>out.mp3</i>
</pre>
<h3><span class="mw-headline" id="How_to_make_DOSBox_use_TiMidity.2B.2B">How to make DOSBox use TiMidity++</span></h3>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>The following method is tested in version <a href="../en/DOSBox.html" title="DOSBox">DOSBox</a> 0.72</div>
<p>First of all, you need to write a config file. Input the following in <a href="../en/DOSBox.html" title="DOSBox">DOSBox</a> to create a configuration file:
</p>
<pre>config -writeconf dosbox.conf
</pre>
<p>you can replace <code>dosbox.conf</code> by any name that you want, add a dot in front of it if you want to hide it.
</p>
<p>Make sure you started TiMidity++ as <a href="#Daemon">daemon</a> as the instructions above, use the <b>aconnect</b> command.
</p>
<p>Edit this configuration file with any editor, go to the section:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">dosbox.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[midi]
mpu401=intelligent
device=default
config=</pre>
<p>put the ALSA connection port into the back of <i>config=</i>, in default:
</p>
<pre>config=128:0
</pre>
<p>Restart DOSBox within a terminal so you can see its debug messages, by no accident you should see a successful initiation on port 128:0.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li> <a href="../en/USB_MIDI_keyboards.html" title="USB MIDI keyboards">USB MIDI keyboards</a>
</li></ul>

</div>
<div id="catlinks" class="catlinks">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Multimedia.html" title="Category:Multimedia">Multimedia</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li></ul>
</div>
</div>					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
Extracted from <a href="https://wiki.archlinux.org"> ArchWiki </a> and licensed under <a href="http://www.gnu.org/copyleft/fdl.html"> GDL >= 1.3</a>
		</div>
		</div>
		</body>
</html>
