<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8">
<title>Microsoft Office 2007 - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style></style>
<meta name="generator" content="MediaWiki 1.26.4">
<meta name="robots" content="noindex,follow">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Microsoft_Office_2007 skin-archlinux action-view">

		<div id="globalWrapper" style="width: 100%">
		<div id="column-content">
			<div id="content" class="mw-body" role="main" style="margin: 0.5em; margin-bottom:0; margin-top:0">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Microsoft Office 2007</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="contentSub"></div>
										<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> <span style="color:red;">please use the first argument of the template to provide a brief explanation.</span> (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Microsoft_Office_2007">Talk:Microsoft Office 2007#</a>)</div>
</div>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements.</b><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> pacman commands, "sudo nano", etc., see <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Microsoft_Office_2007">Talk:Microsoft Office 2007#</a>)</div>
</div>
<div id="toc" class="toc">
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Install_2014_update"><span class="tocnumber">1</span> <span class="toctext">Install 2014 update</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Install"><span class="tocnumber">2</span> <span class="toctext">Install</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Office_2007_SP3"><span class="tocnumber">2.1</span> <span class="toctext">Office 2007 SP3</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Office_2007_Fonts"><span class="tocnumber">2.2</span> <span class="toctext">Office 2007 Fonts</span></a></li>
<li class="toclevel-2 tocsection-5">
<a href="#Winetricks"><span class="tocnumber">2.3</span> <span class="toctext">Winetricks</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#Droid_fonts"><span class="tocnumber">2.3.1</span> <span class="toctext">Droid fonts</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Lucida_and_Tahoma_fonts"><span class="tocnumber">2.3.2</span> <span class="toctext">Lucida and Tahoma fonts</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Install_2014_update">Install 2014 update</span></h2>
<pre># pacman -S wine winetricks wine_gecko wine-mono lib32-ncurses
</pre>
<p>create a 32 bit wineprefix e.g. directory win32
</p>
<pre>$ WINEARCH=win32 WINEPREFIX=~/win32 winecfg
</pre>
<p>A pop up will appear, set it to Windows XP.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong> Do not manually create the directory before running that command; Wine must create it.</div>
<p>Install msxml3
</p>
<pre>$ WINEPREFIX=~/win32 winetricks msxml3
</pre>
<p>Install office
</p>
<pre>$ WINEPREFIX=~/win32 wine /path/to/office2007image/setup.exe
</pre>
<p>Install SP
</p>
<pre>$ WINEPREFIX=~/win32 wine /path/to/office2007sp3-kb2526086-fullfile-en-us.exe
</pre>
<p>Set riched20 to native
</p>
<pre>$ WINEPREFIX=~/win32 winecfg
</pre>
<p>Libraries -&gt; add riched20 -&gt; native
</p>
<h2><span class="mw-headline" id="Install">Install</span></h2>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong> To work with JPG images (i.e. in PowerPoint) install <code>lib32-lcms</code>.</div>
<p>The following has been reported to work, using wine-1.5.0. See these forum posts for details:
</p>
<ul>
<li> <a rel="nofollow" class="external free" href="https://bbs.archlinux.org/viewtopic.php?id=138082">https://bbs.archlinux.org/viewtopic.php?id=138082</a>
</li>
<li> <a rel="nofollow" class="external free" href="https://bbs.archlinux.org/viewtopic.php?id=86436">https://bbs.archlinux.org/viewtopic.php?id=86436</a>
</li>
</ul>
<p>Or have a look at the install instructions on Wine's Application Database
</p>
<ul><li><a rel="nofollow" class="external free" href="http://appdb.winehq.org/objectManager.php?sClass=version&amp;iId=4992">http://appdb.winehq.org/objectManager.php?sClass=version&amp;iId=4992</a></li></ul>
<div style="padding: 5px; margin: 0.50em 0; background-color: #FFDDDD; border: thin solid #DDBBBB; overflow: hidden;">
<strong> Warning: </strong> You should never run Wine commands as root.  Only run Wine as your user. </div>
<p>To get office 2007 working, install bin32-wine, winetricks. This is necessary if you are running a x64 Arch, but are using a 32bit Office installer
</p>
<pre># pacman -S wine winetricks wine_gecko wine-mono
</pre>
<p>Then run:
</p>
<pre>$ WINEARCH=win32 WINEPREFIX=~/win32 winecfg
</pre>
<p>A pop up will appear, set it to Windows XP, then run: (this download is ~1gb so be prepared)
</p>
<pre>$ WINEPREFIX=~/win32 winetricks msxml3  gdiplus riched20 riched30 vcrun2005sp1 allfonts
</pre>
<p>Mount the installation image, then run:
</p>
<pre>$ WINEPREFIX=~/win32 wine /path/to/office2007image/setup.exe
</pre>
<p><br>
To actually use any of the executables you must cd to the directory. IE:
</p>
<pre>$ cd ~/win32/drive_c/Program Files/Microsoft Office/Office12
$ WINEPREFIX=~/win32 wine ./EXCEL.EXE
</pre>
<p>You could set WINEPREFIX in your <code>.bash_profile</code>, or make 32bit wine your default (then you only have to do <code>WINEARCH=win32 winecfg</code>). 
Two reported issues are accidentally emulating 64bit Windows instead of 32 bit and that the programs hang if you don't <code>cd</code> into the directory, probably because the dlls are linked with the local directory.
</p>
<h3><span class="mw-headline" id="Office_2007_SP3">Office 2007 SP3</span></h3>
<p>To upgrade to Service Pack 3
</p>
<p>Download from:  <a rel="nofollow" class="external free" href="http://www.microsoft.com/en-us/download/details.aspx?id=27838">http://www.microsoft.com/en-us/download/details.aspx?id=27838</a>
</p>
<p>Install with:
</p>
<pre>WINEPREFIX=~/win32 wine office2007sp3-kb2526086-fullfile-en-us.exe
</pre>
<h3><span class="mw-headline" id="Office_2007_Fonts">Office 2007 Fonts</span></h3>
<p>To install the Office 2007 Fonts, (this probably isn't necessary)
</p>
<p>First download <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ttf-office-2007-fonts/">ttf-office-2007-fonts</a></span><sup><small>AUR</small></sup> from the AUR
</p>
<p>Change to the directory you will be building the package, then run
</p>
<pre>$ cabextract --filter *.TTF /path/to/office2007image/Enterprise.WW/EnterWW.cab
</pre>
<p>Then proceed to install the package as usual.
</p>
<p>See <a href="../en/Microsoft_fonts.html" title="MS Fonts" class="mw-redirect">MS Fonts</a> for more details
</p>
<h3><span class="mw-headline" id="Winetricks">Winetricks</span></h3>
<p>The Droid, Lucida and Tahoma fonts will fail to download due to broken URLs or IP addresses. To fix these perform the following steps:
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong><i>Both</i> steps must be performed <i>prior</i> to installing the allfonts package using winetricks</div>
<h4><span class="mw-headline" id="Droid_fonts">Droid fonts</span></h4>
<p>Edit the winetricks script:
</p>
<pre>sudo nano -w /usr/bin/winetricks
</pre>
<p>and search for <code>load_droid()</code>
</p>
<p>You should see this:
</p>
<pre>load_droid()
{
   # See http://en.wikipedia.org/wiki/Droid_(font)
   # Old url was http://android.git.kernel.org/?p=platform/frameworks/base.git;a=blob_plain;f=data/fonts/'
   DROID_URL='https://github.com/android/platform_frameworks_base/blob/master/data/fonts/'

   do_droid DroidSans-Bold.ttf        "Droid Sans Bold"         560e4bcafdebaf29645fbf92633a2ae0d2f9801f
   do_droid DroidSansFallback.ttf     "Droid Sans Fallback"     c5e4f11e2f1d0b84e5f268a7ebfd28b54dc6bcdc
   do_droid DroidSansJapanese.ttf     "Droid Sans Japanese"     b3a248c11692aa88a30eb25df425b8910fe05dc5
   do_droid DroidSansMono.ttf         "Droid Sans Mono"         133fb6cf26ea073b456fb557b94ce8c46143b117
   do_droid DroidSans.ttf             "Droid Sans"              62f2841f61e4be66a0303cd1567ed2d300b4e31c
   do_droid DroidSerif-BoldItalic.ttf "Droid Serif Bold Italic" 41ce5fef1bd0164caed6958885d7285c841c95f1
   do_droid DroidSerif-Bold.ttf       "Droid Serif Bold"        2775e9b8e96a3e9593acb5cf6923abb2e6008187
   do_droid DroidSerif-Italic.ttf     "Droid Serif Italic"      e91cc6c1ae9a6699683bcee024551cb58d1be790
   do_droid DroidSerif-Regular.ttf    "Droid Serif"             a689ce25a4063cf501c12d616f832f2235b5b93b
}
</pre>
<p>Since both the download URL and the checksums for the Droid font files have changed, replace
</p>
<pre>   DROID_URL='https://github.com/android/platform_frameworks_base/blob/master/data/fonts/'

   do_droid DroidSans-Bold.ttf        "Droid Sans Bold"         560e4bcafdebaf29645fbf92633a2ae0d2f9801f
   do_droid DroidSansFallback.ttf     "Droid Sans Fallback"     c5e4f11e2f1d0b84e5f268a7ebfd28b54dc6bcdc
   do_droid DroidSansJapanese.ttf     "Droid Sans Japanese"     b3a248c11692aa88a30eb25df425b8910fe05dc5
   do_droid DroidSansMono.ttf         "Droid Sans Mono"         133fb6cf26ea073b456fb557b94ce8c46143b117
   do_droid DroidSans.ttf             "Droid Sans"              62f2841f61e4be66a0303cd1567ed2d300b4e31c
   do_droid DroidSerif-BoldItalic.ttf "Droid Serif Bold Italic" 41ce5fef1bd0164caed6958885d7285c841c95f1
   do_droid DroidSerif-Bold.ttf       "Droid Serif Bold"        2775e9b8e96a3e9593acb5cf6923abb2e6008187
   do_droid DroidSerif-Italic.ttf     "Droid Serif Italic"      e91cc6c1ae9a6699683bcee024551cb58d1be790
   do_droid DroidSerif-Regular.ttf    "Droid Serif"             a689ce25a4063cf501c12d616f832f2235b5b93b
</pre>
<p>with
</p>
<pre>   DROID_URL='https://www.codeaurora.org/gitweb/quic/la/?p=platform/frameworks/base.git;a=blob_plain;f=data/fonts/'

   do_droid DroidSans-Bold.ttf        "Droid Sans Bold"         ada4e79c592f3c54546b7587b48f2b232d95ce2f
   do_droid DroidSansFallback.ttf     "Droid Sans Fallback"     2f8a266389a8e22f68f402b775731eec6b760334
   do_droid DroidSansJapanese.ttf     "Droid Sans Japanese"     d2db187953a457d7791f03a50ceda4aecc389dcd
   do_droid DroidSansMono.ttf         "Droid Sans Mono"         f0815c6f36c72be1d0f2f5e2b82fa85c8bf95655
   do_droid DroidSans.ttf             "Droid Sans"              de95860690f2b1d72f567b01a5ee18dd0f1f1c1f
   do_droid DroidSerif-BoldItalic.ttf "Droid Serif Bold Italic" c1602dc11bf0f7131aec21c7c3888195ad78e486
   do_droid DroidSerif-Bold.ttf       "Droid Serif Bold"        d7896b9c0723299553e95a00d27cbe52f7515c8c
   do_droid DroidSerif-Italic.ttf     "Droid Serif Italic"      117941be102c8f38a86a70ebccaecb8078f7027e
   do_droid DroidSerif-Regular.ttf    "Droid Serif"             7f243858e496ed1bb1faca9f3a7bbe52defcbb5d
</pre>
<h4><span class="mw-headline" id="Lucida_and_Tahoma_fonts">Lucida and Tahoma fonts</span></h4>
<p>Attempts to download the Lucida and Tahoma fonts will time out due to a broken IP address.
Still in the winetricks script, search for <code>ftp_microsoft_com</code> and replace 
</p>
<pre>ftp_microsoft_com=64.4.17.176
</pre>
<p>with
</p>
<pre>ftp_microsoft_com=134.170.188.232
</pre>
<p>Save and exit, then install the fonts:
</p>
<pre>$ WINEPREFIX=~/win32 winetricks allfonts
</pre>
</div>
<div id="catlinks" class="catlinks">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Office.html" title="Category:Office">Office</a></li>
<li><a href="../en/Category:Wine.html" title="Category:Wine">Wine</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
</ul>
</div>
</div>					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
Extracted from <a href="https://wiki.archlinux.org"> ArchWiki </a> and licensed under <a href="http://www.gnu.org/copyleft/fdl.html"> GDL >= 1.3</a>
		</div>
		</div>
		</body>
</html>
