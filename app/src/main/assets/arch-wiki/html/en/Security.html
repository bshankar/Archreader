<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8">
<title>Security - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style></style>
<meta name="generator" content="MediaWiki 1.26.4">
<meta name="robots" content="noindex,follow">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Security skin-archlinux action-view">

		<div id="globalWrapper" style="width: 100%">
		<div id="column-content">
			<div id="content" class="mw-body" role="main" style="margin: 0.5em; margin-bottom:0; margin-top:0">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Security</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="contentSub"></div>
										<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div style="width:45%; margin: 0 0 0.5em 0.5em;">
<p style="background:#333; color:white; padding:0.2em; border-bottom:5px #08c solid; margin:0; text-align:center; font-weight:bold;">Related articles</p>
<ul style="list-style-type:none; margin:0; padding:0.3em;">
<li style="padding:0.4em 0; line-height:1;"><a href="../en/PAM.html" title="PAM">PAM</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/Capabilities.html" title="Capabilities">Capabilities</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/List_of_applications/Security.html" title="List of Applications/Security" class="mw-redirect">List of Applications/Security</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/Category:Security.html" title="Category:Security">Category:Security</a></li>
</ul>
</div>
<p>This article contains recommendations and best practices for hardening an Arch Linux system.
</p>
<div id="toc" class="toc">
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Concepts"><span class="tocnumber">1</span> <span class="toctext">Concepts</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Passwords"><span class="tocnumber">2</span> <span class="toctext">Passwords</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Choosing_secure_passwords"><span class="tocnumber">2.1</span> <span class="toctext">Choosing secure passwords</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Maintaining_passwords"><span class="tocnumber">2.2</span> <span class="toctext">Maintaining passwords</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Password_hashes"><span class="tocnumber">2.3</span> <span class="toctext">Password hashes</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Enforcing_strong_passwords_using_pam_cracklib"><span class="tocnumber">2.4</span> <span class="toctext">Enforcing strong passwords using pam_cracklib</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#Storage"><span class="tocnumber">3</span> <span class="toctext">Storage</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Disk_encryption"><span class="tocnumber">3.1</span> <span class="toctext">Disk encryption</span></a></li>
<li class="toclevel-2 tocsection-9">
<a href="#File_systems"><span class="tocnumber">3.2</span> <span class="toctext">File systems</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#Mount_options"><span class="tocnumber">3.2.1</span> <span class="toctext">Mount options</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-11"><a href="#File_access_permissions"><span class="tocnumber">3.3</span> <span class="toctext">File access permissions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12">
<a href="#User_setup"><span class="tocnumber">4</span> <span class="toctext">User setup</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#Lockout_user_after_three_failed_login_attempts"><span class="tocnumber">4.1</span> <span class="toctext">Lockout user after three failed login attempts</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Limit_amount_of_processes"><span class="tocnumber">4.2</span> <span class="toctext">Limit amount of processes</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15">
<a href="#Restricting_root"><span class="tocnumber">5</span> <span class="toctext">Restricting root</span></a>
<ul>
<li class="toclevel-2 tocsection-16">
<a href="#Use_sudo_instead_of_su"><span class="tocnumber">5.1</span> <span class="toctext">Use sudo instead of su</span></a>
<ul>
<li class="toclevel-3 tocsection-17"><a href="#Editing_files_using_sudo"><span class="tocnumber">5.1.1</span> <span class="toctext">Editing files using sudo</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-18">
<a href="#Restricting_root_login"><span class="tocnumber">5.2</span> <span class="toctext">Restricting root login</span></a>
<ul>
<li class="toclevel-3 tocsection-19"><a href="#Allow_only_certain_users"><span class="tocnumber">5.2.1</span> <span class="toctext">Allow only certain users</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#Denying_ssh_login"><span class="tocnumber">5.2.2</span> <span class="toctext">Denying ssh login</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-21">
<a href="#Mandatory_access_control"><span class="tocnumber">6</span> <span class="toctext">Mandatory access control</span></a>
<ul>
<li class="toclevel-2 tocsection-22"><a href="#Pathname_MAC"><span class="tocnumber">6.1</span> <span class="toctext">Pathname MAC</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Role-based_access_control"><span class="tocnumber">6.2</span> <span class="toctext">Role-based access control</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Labels_MAC"><span class="tocnumber">6.3</span> <span class="toctext">Labels MAC</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Access_Control_Lists"><span class="tocnumber">6.4</span> <span class="toctext">Access Control Lists</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-26">
<a href="#Kernel_hardening"><span class="tocnumber">7</span> <span class="toctext">Kernel hardening</span></a>
<ul>
<li class="toclevel-2 tocsection-27"><a href="#Restricting_access_to_kernel_logs"><span class="tocnumber">7.1</span> <span class="toctext">Restricting access to kernel logs</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Restricting_access_to_kernel_pointers_in_the_proc_filesystem"><span class="tocnumber">7.2</span> <span class="toctext">Restricting access to kernel pointers in the proc filesystem</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#Keep_BPF_JIT_compiler_disabled"><span class="tocnumber">7.3</span> <span class="toctext">Keep BPF JIT compiler disabled</span></a></li>
<li class="toclevel-2 tocsection-30">
<a href="#ptrace_scope"><span class="tocnumber">7.4</span> <span class="toctext">ptrace scope</span></a>
<ul>
<li class="toclevel-3 tocsection-31"><a href="#Examples_of_broken_functionality"><span class="tocnumber">7.4.1</span> <span class="toctext">Examples of broken functionality</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-32"><a href="#hidepid"><span class="tocnumber">7.5</span> <span class="toctext">hidepid</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#grsecurity"><span class="tocnumber">7.6</span> <span class="toctext">grsecurity</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-34">
<a href="#Sandboxing_applications"><span class="tocnumber">8</span> <span class="toctext">Sandboxing applications</span></a>
<ul>
<li class="toclevel-2 tocsection-35"><a href="#Firejail"><span class="tocnumber">8.1</span> <span class="toctext">Firejail</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#chroots"><span class="tocnumber">8.2</span> <span class="toctext">chroots</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#Linux_containers"><span class="tocnumber">8.3</span> <span class="toctext">Linux containers</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#Other_virtualization_options"><span class="tocnumber">8.4</span> <span class="toctext">Other virtualization options</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-39">
<a href="#Network_and_firewalls"><span class="tocnumber">9</span> <span class="toctext">Network and firewalls</span></a>
<ul>
<li class="toclevel-2 tocsection-40"><a href="#Firewalls"><span class="tocnumber">9.1</span> <span class="toctext">Firewalls</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="#Kernel_parameters"><span class="tocnumber">9.2</span> <span class="toctext">Kernel parameters</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#SSH"><span class="tocnumber">9.3</span> <span class="toctext">SSH</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#DNS"><span class="tocnumber">9.4</span> <span class="toctext">DNS</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#Proxies"><span class="tocnumber">9.5</span> <span class="toctext">Proxies</span></a></li>
<li class="toclevel-2 tocsection-45"><a href="#Managing_SSL_certificates"><span class="tocnumber">9.6</span> <span class="toctext">Managing SSL certificates</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-46"><a href="#Authenticating_packages"><span class="tocnumber">10</span> <span class="toctext">Authenticating packages</span></a></li>
<li class="toclevel-1 tocsection-47"><a href="#Follow_NVD.2FCVE_alerts"><span class="tocnumber">11</span> <span class="toctext">Follow NVD/CVE alerts</span></a></li>
<li class="toclevel-1 tocsection-48">
<a href="#Physical_security"><span class="tocnumber">12</span> <span class="toctext">Physical security</span></a>
<ul>
<li class="toclevel-2 tocsection-49"><a href="#Locking_down_BIOS"><span class="tocnumber">12.1</span> <span class="toctext">Locking down BIOS</span></a></li>
<li class="toclevel-2 tocsection-50">
<a href="#Bootloaders"><span class="tocnumber">12.2</span> <span class="toctext">Bootloaders</span></a>
<ul>
<li class="toclevel-3 tocsection-51"><a href="#Syslinux"><span class="tocnumber">12.2.1</span> <span class="toctext">Syslinux</span></a></li>
<li class="toclevel-3 tocsection-52"><a href="#GRUB"><span class="tocnumber">12.2.2</span> <span class="toctext">GRUB</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-53"><a href="#Denying_console_login_as_root"><span class="tocnumber">12.3</span> <span class="toctext">Denying console login as root</span></a></li>
<li class="toclevel-2 tocsection-54"><a href="#Automatic_logout"><span class="tocnumber">12.4</span> <span class="toctext">Automatic logout</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-55"><a href="#See_also"><span class="tocnumber">13</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Concepts">Concepts</span></h2>
<ul>
<li> It <i>is</i> possible to tighten the security so much as to make your system unusable. The trick is to secure it without overdoing it.</li>
<li> There are many other things that can be done to heighten the security, but the biggest threat is, and will always be, the user. When you think security, you have to think layers. When one layer is breached, another should stop the attack. But you can never make the system 100% secure unless you unplug the machine from all networks, lock it in a safe and never use it.</li>
<li> Be a little paranoid. It helps. And be suspicious. If anything sounds too good to be true, it probably is!</li>
<li> The <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege" class="extiw" title="wikipedia:Principle of least privilege">principle of least privilege</a>: each part of a system should only be able to access what is required to use it, and nothing more.</li>
</ul>
<h2><span class="mw-headline" id="Passwords">Passwords</span></h2>
<p>Passwords are key to a secure linux system. They secure your <a href="../en/Users_and_groups.html" title="Users and groups">user accounts</a>, <a href="../en/Disk_encryption.html" title="Disk encryption">encrypted filesystems</a>, and <a href="../en/SSH_keys.html" title="SSH keys">SSH</a>/<a href="../en/GnuPG.html" title="GPG" class="mw-redirect">GPG</a> keys. They are the main way a computer chooses to trust the person using it, so a big part of security is just about picking secure passwords and protecting them.
</p>
<h3><span class="mw-headline" id="Choosing_secure_passwords">Choosing secure passwords</span></h3>
<p>When relying on a passphrase, it must be complex enough to not be easily guessed from e.g. personal information, or <a href="https://en.wikipedia.org/wiki/Password_cracking" class="extiw" title="wikipedia:Password cracking">cracked</a> using e.g. brute-force attacks. The tenets of strong passphrases are based on <i>length</i> and <i>randomness</i>. In cryptography the quality of a passphrase is referred to as its <a href="https://en.wikipedia.org/wiki/Entropic_security" class="extiw" title="wikipedia:Entropic security">Wikipedia:Entropic security</a>. 
</p>
<p>Insecure passwords include those containing:
</p>
<ul>
<li> Personally identifiable information (e.g., your dog's name, date of birth, area code, favorite video game)</li>
<li> Simple character substitutions on words (e.g., <code>k1araj0hns0n</code>)</li>
<li> Root "words" or common strings followed or preceded by added numbers, symbols, or characters (e.g., <code>DG091101%</code>)</li>
<li> Common phrases or short phrases of grammatically related words (e.g. <code>all of the lights</code>), and even with character substitution.</li>
</ul>
<p>The right choice for a password is something long (8-20 characters, depending on importance) and seemingly completely random.
A good technique for building secure, seemingly random passwords is to base them on characters from every word in a sentence.
Take for instance “the girl is walking down the rainy street” could be translated to <code>t6!WdtR5</code> or, less simply, <code>t&amp;6!RrlW@dtR,57</code>.
This approach could make it easier to remember a password, but note that the the various letters have very different probabilities of being found at the start of words (<a href="https://en.wikipedia.org/wiki/Letter_frequency#Relative_frequencies_of_the_first_letters_of_a_word_in_the_English_language" class="extiw" title="wikipedia:Letter frequency">Wikipedia:Letter frequency</a>).
</p>
<p>A better approach is to generate pseudo-random passwords with tools like <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=pwgen">pwgen</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=apg">apg</a></span>: for memorizing them, one technique (for ones typed often) is to generate a long password and memorize a minimally secure number of characters, temporarily writing down the full generated string. Over time, increase the number of characters typed - until the password is ingrained in muscle memory and need not be remembered. This technique is more difficult, but can provide confidence that a password will not turn up in wordlists or "intelligent" brute force attacks that combine words and substitute characters.
</p>
<p>It is also very effective to combine these two techniques by saving long, complex random passwords with a <a href="../en/List_of_applications/Security.html#Password_managers" title="List of applications/Security">password manager</a>, which will be in turn accessed with a mnemonic password that will have to be used only for that purpose, especially avoiding to ever transmit it over any kind of network. This method of course limits the use of the stored passwords to the terminals where the database is available for reading (which on the other hand could be seen as an added security feature).
</p>
<p>Also consider the <a rel="nofollow" class="external text" href="http://world.std.com/~reinhold/diceware.html">Diceware Passphrase</a> method, using a sufficient number of words.
</p>
<p>See Bruce Schneier's article <a rel="nofollow" class="external text" href="https://www.schneier.com/blog/archives/2014/03/choosing_secure_1.html">Choosing Secure Passwords</a> or <a rel="nofollow" class="external text" href="http://www.iusmentis.com/security/passphrasefaq/">The passphrase FAQ</a> for some additional background. Also, you can check entropy level of your chosen passphrase <a rel="nofollow" class="external text" href="http://rumkin.com/tools/password/passchk.php">here</a>, or consulting <a href="https://en.wikipedia.org/wiki/Password_strength" class="extiw" title="wikipedia:Password strength">Wikipedia:Password strength</a>.
</p>
<h3><span class="mw-headline" id="Maintaining_passwords">Maintaining passwords</span></h3>
<p>Once you pick a strong password, be sure to keep it safe. Watch out for <a href="https://en.wikipedia.org/wiki/Social_engineering_(security)" class="extiw" title="wikipedia:Social engineering (security)">manipulation</a>, <a href="https://en.wikipedia.org/wiki/Shoulder_surfing_(computer_security)" class="extiw" title="wikipedia:Shoulder surfing (computer security)">shoulder surfing</a>, and avoid reusing passwords so insecure servers cannot leak more information than necessary. <a href="../en/List_of_applications/Security.html#Password_managers" title="List of applications/Security">Password managers</a> can help manage large numbers of complex passwords: if you are copy-pasting the stored passwords from the manager to the applications that need them, make sure to clear the copy buffer every time, and ensure they are not saved in any kind of log (e.g. do not paste them in plain terminal commands, which would store them in files like <code>.bash_history</code>). <a href="https://en.wikipedia.org/wiki/LastPass_Password_Manager" class="extiw" title="wikipedia:LastPass Password Manager">Lastpass</a> is a service that stores encrypted passwords online for synchronization between devices, but requires that you trust both closed-source code and an external corporation. 
</p>
<p>As a rule, do not pick insecure passwords just because secure ones are harder to remember. Passwords are a balancing act. It is better to have an encrypted database of secure passwords, guarded behind a key and one strong master password, than it is to have many similar weak passwords. Writing passwords down is perhaps equally effective<a rel="nofollow" class="external autonumber" href="https://www.schneier.com/blog/archives/2005/06/write_down_your.html">[1]</a>, avoiding potential vulnerabilities in software solutions while requiring physical security.
</p>
<p>Another aspect of the strength of the passphrase is that it must not be easily recoverable from other places.
If you use the same passphrase for disk encryption as you use for your login password (useful e.g. to auto-mount the encrypted partition or folder on login), make sure that <code>/etc/shadow</code> either also ends up on an encrypted partition, or uses a strong hash algorithm (i.e. sha512/bcrypt, not md5) for the stored password hash (see <a href="../en/SHA_password_hashes.html" title="SHA password hashes">SHA password hashes</a> for more info).
</p>
<h3><span class="mw-headline" id="Password_hashes">Password hashes</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Mention <a href="https://en.wikipedia.org/wiki/Key_derivation_function" class="extiw" title="wikipedia:Key derivation function">key derivation functions</a>, in particular PBKDF2, bcrypt and scrypt, how to use them, advantages and disadvantages, especially regarding custom-hardware-based brute-force attacks. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Security#Removal_of_incorrect_warning">Talk:Security#Removal of incorrect warning</a>)</div>
</div>
<p>By default, Arch stores the hashed user passwords in the root-only-readable <code>/etc/shadow</code> file, separated from the other user parameters stored in the world-readable <code>/etc/passwd</code> file, see <a href="../en/Users_and_groups.html#User_database" title="Users and groups">Users and groups#User database</a>. See also <a href="#Restricting_root">#Restricting root</a>.
</p>
<p>Passwords are set with the <b>passwd</b> command, which <a href="https://en.wikipedia.org/wiki/Key_stretching" class="extiw" title="wikipedia:Key stretching">stretches</a> them with the <a href="https://en.wikipedia.org/wiki/Crypt_(C)" class="extiw" title="wikipedia:Crypt (C)">crypt</a> function and then saves them in <code>/etc/shadow</code>. See also <a href="../en/SHA_password_hashes.html" title="SHA password hashes">SHA password hashes</a>. The passwords are also <a href="https://en.wikipedia.org/wiki/Salt_(cryptography)" class="extiw" title="wikipedia:Salt (cryptography)">salted</a> in order to defend them against <a href="https://en.wikipedia.org/wiki/Rainbow_table" class="extiw" title="wikipedia:Rainbow table">rainbow table</a> attacks.
</p>
<p>See also <a rel="nofollow" class="external text" href="http://www.slashroot.in/how-are-passwords-stored-linux-understanding-hashing-shadow-utils">How are passwords stored in Linux (Understanding hashing with shadow utils)</a>.
</p>
<h3><span class="mw-headline" id="Enforcing_strong_passwords_using_pam_cracklib">Enforcing strong passwords using pam_cracklib</span></h3>
<p><i>pam_cracklib</i> provides protection against <a href="https://en.wikipedia.org/wiki/Dictionary_attack" class="extiw" title="wikipedia:Dictionary attack">Dictionary attacks</a> and helps configure a password policy that can be enforced throughout the system.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #FFDDDD; border: thin solid #DDBBBB; overflow: hidden;">
<strong> Warning: </strong>The <i>root</i> account is not affected by this policy.</div>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>You can use the <i>root</i> account to set a password for a user that bypasses the desired/configured policy. This is useful when setting temporary passwords.</div>
<p>If for example you want to enforce this policy:
</p>
<ul>
<li> prompt 2 times for password in case of an error</li>
<li> 10 characters minimum length (minlen option)</li>
<li> at least 6 characters should be different from old password when entering a new one (difok option)</li>
<li> at least 1 digit (dcredit option)</li>
<li> at least 1 uppercase (ucredit option)</li>
<li> at least 1 other character (ocredit option)</li>
<li> at least 1 lowercase (lcredit option)</li>
</ul>
<p>Edit the <code>/etc/pam.d/passwd</code> file to read as:
</p>
<pre>#%PAM-1.0
password required pam_cracklib.so retry=2 minlen=10 difok=6 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1
password required pam_unix.so use_authtok sha512 shadow</pre>
<p>The <code>password required pam_unix.so use_authtok</code> instructs the <i>pam_unix</i> module to not prompt for a password but rather to use the one provided by <i>pam_cracklib</i>.
</p>
<p>You can refer to the pam_cracklib(8) and pam_unix(8) man pages for more information.
</p>
<h2><span class="mw-headline" id="Storage">Storage</span></h2>
<h3><span class="mw-headline" id="Disk_encryption">Disk encryption</span></h3>
<p><a href="../en/Disk_encryption.html" title="Disk encryption">Disk encryption</a>, preferably full disk encryption with a <a href="#Passwords">strong passphrase</a>, is the only way to guard data against physical recovery. This provides complete security when the computer is turned off or the disks in question are unmounted.
</p>
<p>Once the computer is powered on and the drive is mounted, however, its data becomes just as vulnerable as an unencrypted drive. It is therefore best practice to unmount data partitions as soon as they are no longer needed.
</p>
<p>Certain programs, like <a href="../en/Dm-crypt.html" title="Dm-crypt">Dm-crypt</a>, allow the user to encrypt a loop file as a virtual volume. This is a reasonable alternative to full disk encryption when only certain parts of the system need be secure.
</p>
<h3><span class="mw-headline" id="File_systems">File systems</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> You don't mount a partition, but a file system; i.e. this is not related to <a href="../en/Partitioning.html" title="Partitioning">partitioning</a>. In <code>fs.protected_hardlinks</code> etc., the "fs" stands for "file system". (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Security">Talk:Security#</a>)</div>
</div>
<p>The kernel now prevents security issues related to hardlinks and symlinks if the <code>fs.protected_hardlinks</code> and <code>fs.protected_symlinks</code> sysctl switches are enabled, so there is no longer a major security benefit from separating out world-writable directories.
</p>
<p>Partitions containing world-writable directories can still be kept separate as a coarse way of limiting the damage from disk space exhaustion. However, filling a partition like <code>/var</code> or <code>/tmp</code> is enough to take down services. More flexible mechanisms for dealing with this concern exist (like quotas), and some filesystems include related features themselves (btrfs has quotas on subvolumes).
</p>
<h4><span class="mw-headline" id="Mount_options">Mount options</span></h4>
<p>Following the principle of least privilege, filesystems should be mounted with the most restrictive mount options possible (without losing  functionality).
</p>
<p>Relevant mount options are:
</p>
<ul>
<li>
<code>nodev</code>: Do not interpret character or block special devices on the file system.</li>
<li>
<code>nosuid</code>: Do not allow set-user-identifier or set-group-identifier bits to take effect.</li>
<li>
<code>noexec</code>: Do not allow direct execution of any  binaries on the mounted filesystem.</li>
</ul>
<p>Partitions used for data should always be mounted with <code>nodev</code>, <code>nosuid</code>, <code>noexec</code>. Potential usage is presented in the table below.
</p>
<table class="wikitable">
<tr>
<td align="center">
<b>Partition</b>
</td>
<td align="center">
<code>nodev</code>
</td>
<td align="center">
<code>nosuid</code>
</td>
<td align="center">
<code>noexec</code>
</td>
</tr>
<tr>
<td> <code>/var</code>
</td>
<td>yes</td>
<td>yes</td>
<td>yes <sup>[1]</sup>
</td>
</tr>
<tr>
<td> <code>/home</code>
</td>
<td>yes</td>
<td>yes</td>
<td>yes, if you do not code, use wine or steam
</td>
</tr>
<tr>
<td> <code>/dev/shm</code>
</td>
<td>yes</td>
<td>yes</td>
<td>yes
</td>
</tr>
<tr>
<td> <code>/tmp</code>
</td>
<td>yes</td>
<td>yes</td>
<td>maybe, breaks compiling packages and various other things
</td>
</tr>
<tr>
<td> <code>/boot</code>
</td>
<td>yes</td>
<td>yes</td>
<td>yes
</td>
</tr>
</table>
<p><sup>[1]</sup> Note that some packages (building <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=nvidia-dkms">nvidia-dkms</a></span> for example) may require <code>exec</code> on <code>/var</code>.
</p>
<h3><span class="mw-headline" id="File_access_permissions">File access permissions</span></h3>
<p>The default <a href="../en/File_permissions_and_attributes.html" title="File permissions" class="mw-redirect">file permissions</a> allow read access to almost everything and changing the permissions can hide valuable information from an attacker who gains access to a non-root account such as the <code>http</code> or <code>nobody</code> users.
</p>
<p>For example:
</p>
<pre># chmod 700 /boot /etc/{iptables,arptables}
</pre>
<p>The default <a href="../en/Umask.html" title="Umask">Umask</a> can be changed to improve security for newly created files. The <a rel="nofollow" class="external text" href="http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf">NSA RHEL5 Security Guide</a> suggests a umask of <code>077</code> for maximum security, which makes new files not readable by users other than the owner. To change this, see <a href="../en/Umask.html#Set_the_mask_value" title="Umask">Umask#Set the mask value</a>.
</p>
<h2><span class="mw-headline" id="User_setup">User setup</span></h2>
<p>After installation make a normal user for daily use. Do not use the root user for daily use.
</p>
<h3><span class="mw-headline" id="Lockout_user_after_three_failed_login_attempts">Lockout user after three failed login attempts</span></h3>
<p>To further heighten the security it is possible to lockout a user after a specified number of failed login attempts. The user account can either be locked until the root user unlocks it, or automatically be unlocked after a set time.
To lockout a user for ten minutes after three failed login attempts you have to modify <code>/etc/pam.d/system-login</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pam.d/system-login</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">auth required pam_tally.so deny=2 unlock_time=600 onerr=succeed file=/var/log/faillog
#auth required pam_tally.so onerr=succeed file=/var/log/faillog</pre>
<p>If you do not comment the second line every failed login attempt will be counted twice. That is all there is to it. If you feel adventurous, make three failed login attempts. Then you can see for yourself what happens. To unlock a user manually do:
</p>
<pre># pam_tally --user <i>username</i> --reset
</pre>
<p>If you want to permanently lockout a user after 3 failed login attempts remove the <code>unlock_time</code> part of the line. The user can then not login until root unlocks the account.
</p>
<h3><span class="mw-headline" id="Limit_amount_of_processes">Limit amount of processes</span></h3>
<p>On systems with many, or untrusted users, it is important to limit the number of processes each can run at once, therefore preventing <a href="https://en.wikipedia.org/wiki/Fork_bomb" class="extiw" title="wikipedia:Fork bomb">fork bombs</a> and other denial of service attacks. <code>/etc/security/limits.conf</code> determines how many processes each user, or group can have open, and is empty (except for useful comments) by default. adding the following lines to this file will limit all users to 100 active processes, unless they use the <code>prlimit</code> command to explicitly raise their maximum to 200 for that session. These values can be changed according to the appropriate number of processes a user should have running, or the hardware of the box you are administrating. 
</p>
<pre>* soft nproc 100
* hard nproc 200
</pre>
<h2><span class="mw-headline" id="Restricting_root">Restricting root</span></h2>
<p>The root user is, by definition, the most powerful user on a system. Because of this, there are a number of ways to keep the power of the root user while limiting its ability to cause harm, or at least to make root user actions more traceable.
</p>
<h3><span class="mw-headline" id="Use_sudo_instead_of_su">Use sudo instead of su</span></h3>
<p>Using <a href="../en/Sudo.html" title="Sudo">sudo</a> for privileged access is preferable to <a href="../en/Su.html" title="Su">su</a> for <a href="../en/Su.html#Security" title="Su">a number of reasons</a>.
</p>
<ul>
<li> It keeps a log of which normal privilege user has run each privileged command.</li>
<li> The root user password need not be given out to each user who requires root access.</li>
<li> <code>sudo</code> prevents users from accidentally running commands as <i>root</i> that do not need root access, because a full root terminal is not created. This aligns with the <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege" class="extiw" title="wikipedia:Principle of least privilege">principle of least privilege</a>.</li>
<li> Individual programs may be enabled per user, instead of offering complete root access just to run one command. For example, to give the user <i>alice</i> access to a particular program:</li>
</ul>
<pre># visudo
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sudoers</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
alice ALL = NOPASSWD: /path/to/program</pre>
<p>Or, individual commands can be allowed for all users. To mount Samba shares from a server as a regular user:
</p>
<pre>%users ALL=/sbin/mount.cifs,/sbin/umount.cifs
</pre>
<p>This allows all users who are members of the group users to run the commands <code>/sbin/mount.cifs</code> and <code>/sbin/umount.cifs</code> from any machine (ALL).
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDFFDD; border: thin solid #BBDDBB; overflow: hidden;">
<strong> Tip: </strong>
<p>To use <code>nano</code> instead of <code>vi</code> with <code>visudo</code>,
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sudoers</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Defaults editor=/usr/bin/rnano</pre>
<p>Exporting <code># EDITOR=nano visudo</code> is regarded as a severe security risk since everything can be used as an <code>EDITOR</code>.
</p>
</div>
<h4><span class="mw-headline" id="Editing_files_using_sudo">Editing files using sudo</span></h4>
<p>Running a text editor as root can be a security vulnerability as many editors can run arbitrary shell commands or affect files other than the one you intend to edit. To avoid this, use <code>sudoedit filename</code> (equivalently, <code>sudo -e filename</code>) to edit files. This edits a copy of the file using your normal user privileges and then overwrites the original using sudo only after the editor is closed. You can change the editor this uses by setting the <code>SUDO_EDITOR</code> environment variable:
</p>
<pre>export SUDO_EDITOR=vim
</pre>
<p>Alternatively, use an editor like <code>rvim</code> which has restricted capabilities in order to be safe to run as root.
</p>
<h3><span class="mw-headline" id="Restricting_root_login">Restricting root login</span></h3>
<p>Once <a href="../en/Sudo.html" title="Sudo">sudo</a> is properly configured, full root access can be heavily restricted or denied without losing much usability. To disable root, but still allowing to use <a href="../en/Sudo.html" title="Sudo">sudo</a>, you can use <code>passwd -l root</code>.
</p>
<h4><span class="mw-headline" id="Allow_only_certain_users">Allow only certain users</span></h4>
<p>The <a href="../en/PAM.html" title="PAM">PAM</a> <code>pam_wheel.so</code> lets you allow only users in the group <code>wheel</code> to login using <code>su</code>. Edit both <code>/etc/pam.d/su</code> and <code>/etc/pam.d/su-l</code>, then uncomment the line:
</p>
<pre>
# Uncomment the following line to require a user to be in the "wheel" group.
auth		required	pam_wheel.so use_uid
</pre>
<p>This means only users who are already able to run privileged commands may login as root.
</p>
<h4><span class="mw-headline" id="Denying_ssh_login">Denying ssh login</span></h4>
<p>Even if you do not wish to deny root login for local users, it is always good practice to <a href="../en/Secure_Shell.html#Deny" title="Ssh" class="mw-redirect">deny root login via SSH</a>. The purpose of this is to add an additional layer of security before a user can completely compromise your system remotely.
</p>
<h2><span class="mw-headline" id="Mandatory_access_control">Mandatory access control</span></h2>
<p><a href="https://en.wikipedia.org/wiki/Mandatory_Access_Control" class="extiw" title="wikipedia:Mandatory Access Control">Mandatory access control</a> (MAC) is a type of security policy that differs significantly from the <a href="https://en.wikipedia.org/wiki/Discretionary_Access_Control" class="extiw" title="wikipedia:Discretionary Access Control">discretionary access control</a> (DAC) used by default in Arch and most Linux distributions. MAC essentially means that every action a program could perform that affects the system in any way is checked against a security ruleset. This ruleset, in contrast to DAC methods, cannot be modified by users. Using virtually any mandatory access control system will significantly improve the security of your computer, although there are differences in how it can be implemented.
</p>
<h3><span class="mw-headline" id="Pathname_MAC">Pathname MAC</span></h3>
<p>Pathname-based access control is a simple form of access control that offers permissions based on the path of a given file. The downside to this style of access control is that permissions are not carried with files if they are moved about the system. On the positive side, pathname-based MAC can be implemented on a much wider range of filesystems, unlike labels-based alternatives.
</p>
<ul>
<li>
<a href="../en/AppArmor.html" title="AppArmor">AppArmor</a> is a <a href="https://en.wikipedia.org/wiki/Canonical" class="extiw" title="wikipedia:Canonical">Canonical</a>-maintained MAC implementation seen as an "easier" alternative to SELinux.</li>
<li>
<a href="../en/TOMOYO_Linux.html" title="Tomoyo" class="mw-redirect">Tomoyo</a> is another simple, easy-to-use system offering mandatory access control. It is designed to be both simple in usage and in implementation, requiring very few dependencies.</li>
</ul>
<h3><span class="mw-headline" id="Role-based_access_control">Role-based access control</span></h3>
<p>The MAC implementation grsecurity supports is called role-based access control. RBAC associates roles with each user. Each role defines what operations can be performed on certain objects. Given a well-written collection of roles and operations your users will be restricted to perform only those tasks that you tell them they can do. The default "deny-all" ensures you that a user cannot perform an action you have not thought of.
</p>
<ul>
<li>
<a href="../en/Grsecurity.html#RBAC" title="Grsecurity">Grsecurity RBAC</a> has a learning mode like AppArmor for easy configuration</li>
<li>
<a href="../en/Grsecurity.html#RBAC" title="Grsecurity">Grsecurity RBAC</a> does not rely on extra meta-data like SELinux. RBAC is significantly faster then SELinux.</li>
</ul>
<h3><span class="mw-headline" id="Labels_MAC">Labels MAC</span></h3>
<p>Labels-based access control means the extended attributes of a file are used to govern its security permissions. While this system is arguably more flexible in its security offerings than pathname-based MAC, it only works on filesystems that support these extended attributes.
</p>
<ul><li>
<a href="../en/SELinux.html" title="SELinux">SELinux</a>, based on a <a href="https://en.wikipedia.org/wiki/NSA" class="extiw" title="wikipedia:NSA">NSA</a> project to improve Linux security, implements MAC completely separate from system users and roles. It offers an extremely robust multi-level MAC policy implementation that can easily maintain control of a system that grows and changes past its original configuration.</li></ul>
<h3><span class="mw-headline" id="Access_Control_Lists">Access Control Lists</span></h3>
<p><a href="../en/Access_Control_Lists.html" title="Access Control Lists">Access Control Lists</a> (ACLs) are an alternative to attaching rules directly to the filesystem in some way. ACLs implement access control by checking program actions against a list of permitted behavior.
</p>
<ul><li>
<a href="../en/Grsecurity.html" title="Grsecurity">grsecurity</a> implements ACL access control, as well as a complete kernel patchset focused on improving security. Its changes extend to control of memory allocation, improved chroot restrictions, and rules involving specific network behavior.</li></ul>
<h2><span class="mw-headline" id="Kernel_hardening">Kernel hardening</span></h2>
<h3><span class="mw-headline" id="Restricting_access_to_kernel_logs">Restricting access to kernel logs</span></h3>
<p>The kernel logs contain useful information for an attacker trying to exploit kernel vulnerabilities, such as sensitive memory addresses. The <code>kernel.dmesg_restrict</code> flag was to forbid access to the logs without the <code>CAP_SYS_ADMIN</code> capability (which only processes running as root have by default).
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sysctl.d/50-dmesg-restrict.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">kernel.dmesg_restrict = 1</pre>
<h3><span class="mw-headline" id="Restricting_access_to_kernel_pointers_in_the_proc_filesystem">Restricting access to kernel pointers in the proc filesystem</span></h3>
<p>Enabling <code>kernel.kptr_restrict</code> will hide kernel symbol addresses in <code>/proc/kallsyms</code> from regular users without <code>CAP_SYSLOG</code>, making it more difficult for kernel exploits to resolve addresses/symbols dynamically. This will not help that much on a pre-compiled Arch Linux kernel, since a determined attacker could just download the kernel package and get the symbols manually from there, but if you're compiling your own kernel, this can help mitigating local root exploits. This will break some <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=perf">perf</a></span> commands when used by non-root users (but many <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=perf">perf</a></span> features require root access anyway). See <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/34323">FS#34323</a> for more information.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sysctl.d/50-kptr-restrict.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">kernel.kptr_restrict = 1</pre>
<h3><span class="mw-headline" id="Keep_BPF_JIT_compiler_disabled">Keep BPF JIT compiler disabled</span></h3>
<p>The Linux kernel includes the ability to compile BPF/Seccomp rule sets to native code as a performance optimization. The <code>net.core.bpf_jit_enable</code> flag should be left at 0 for a maximum level of security.
</p>
<p>This can be helpful in specific domains, but is not usually useful. A JIT compiler opens up the possibility for an attacker to perform a heap spraying attack, where they fill the kernel's heap with malicious code. This code can then potentially be executed via another exploit, like an incorrect function pointer dereference.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong><a href="../en/Grsecurity.html" title="Grsecurity">grsecurity</a> includes JIT hardening for the BPF JIT compiler, greatly reducing the risk of exploitation.</div>
<h3><span class="mw-headline" id="ptrace_scope">ptrace scope</span></h3>
<p>Arch enables the Yama LSM by default, providing a <code>kernel.yama.ptrace_scope</code> flag. This flag is enabled by default and prevents processes from performing a <code>ptrace</code> call on other processes outside of their scope without <code>CAP_SYS_PTRACE</code>. While many debugging tools require this for some of their functionality, it is a significant improvement in security. Without this feature, there is essentially no separation between processes running as the same user without applying extra layers like namespaces. The ability to attach a debugger to an existing process is a demonstration of this weakness.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>In <a href="../en/Grsecurity.html" title="Grsecurity">grsecurity</a>, this protection is toggled via the <code>kernel.grsecurity.harden_ptrace</code> flag instead.</div>
<h4><span class="mw-headline" id="Examples_of_broken_functionality">Examples of broken functionality</span></h4>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>You can still execute these commands as root (such as allowing them through <a href="../en/Sudo.html" title="Sudo">sudo</a> for certain users, with or without a password), or enable ptrace selectively through <code>setcap cap_sys_ptrace=eip <i>/path/to/program</i></code>.</div>
<ul>
<li> <code>gdb -p $PID</code>
</li>
<li> <code>strace -p $PID</code>
</li>
<li> <code>perf trace -p $PID</code>
</li>
<li> <code>reptyr $PID</code>
</li>
</ul>
<h3><span class="mw-headline" id="hidepid">hidepid</span></h3>
<p>The kernel has the ability to hide other users' processes from unprivileged users by mounting the <code>proc</code> filesystem with <code>hidepid=1</code> or <code>hidepid=2</code>. This can be automated with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=hidepid">hidepid</a></span> package. It will install polkit and systemd-logind exceptions and make sure <code>/proc</code> is mounted with <code>hidepid=2,gid=26</code>.
</p>
<h3><span class="mw-headline" id="grsecurity">grsecurity</span></h3>
<p>The <a href="../en/Grsecurity.html" title="Grsecurity">grsecurity</a> kernel provides many security-related improvements. It hardens both the kernel and userspace against common memory corruption vulnerabilities, along with providing many miscellaneous features and a role-based access control system. It is the only way to secure the kernel itself against exploitation, which is the most important improvement for a system already making good use of user isolation, containers/chroots and sandboxes.
</p>
<h2><span class="mw-headline" id="Sandboxing_applications">Sandboxing applications</span></h2>
<h3><span class="mw-headline" id="Firejail">Firejail</span></h3>
<p><a href="../en/Firejail.html" title="Firejail">Firejail</a> is an easy to use and simple tool for sandboxing applications and servers alike. Firejail is suggested for browsers and internet facing applications, as well as any servers you may be running. Firejail is further enhanced when used with Grsecurity.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDFFDD; border: thin solid #BBDDBB; overflow: hidden;">
<strong> Tip: </strong>If you do not require to sandbox graphical applications, an alternative is <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=playpen">playpen</a></span>.</div>
<h3><span class="mw-headline" id="chroots">chroots</span></h3>
<p>Manual <a href="../en/Change_root.html" title="Chroot" class="mw-redirect">chroot</a> jails can also be constructed.
</p>
<h3><span class="mw-headline" id="Linux_containers">Linux containers</span></h3>
<p><a href="../en/Linux_Containers.html" title="Linux Containers">Linux Containers</a> are another good option when you need more separation than the other options (short of KVM and Virtualbox) provide. LXC's run on top of the existing kernel in a pseudo-chroot with their own virtual hardware.
</p>
<h3><span class="mw-headline" id="Other_virtualization_options">Other virtualization options</span></h3>
<p>Using other, more full virtualization options such as <a href="../en/VirtualBox.html" title="VirtualBox">VirtualBox</a>, <a href="../en/KVM.html" title="KVM">KVM</a>, or <a href="../en/Xen.html" title="Xen">Xen</a> can also improve security in the event you plan on running risky applications or browsing dangerous websites.
</p>
<h2><span class="mw-headline" id="Network_and_firewalls">Network and firewalls</span></h2>
<h3><span class="mw-headline" id="Firewalls">Firewalls</span></h3>
<p>While the stock Arch kernel is capable of using <a href="https://en.wikipedia.org/wiki/Netfilter" class="extiw" title="wikipedia:Netfilter">Netfilter</a>'s <a href="../en/Iptables.html" title="Iptables">iptables</a>, it is not enabled by default. It is highly recommended to set up some form of firewall to protect the services running on the system. Many resources (including ArchWiki) do not state explicitly which services are worth protecting, so enabling a firewall is a good precaution.
</p>
<ul>
<li>See <a href="../en/Iptables.html" title="Iptables">iptables</a> for general info.</li>
<li>See <a href="../en/Simple_stateful_firewall.html" title="Simple stateful firewall">Simple stateful firewall</a> for a guide on setting up an iptables firewall.</li>
<li>See <a href="../en/Firewalls.html" title="Firewalls">Firewalls</a> for other ways of setting up netfilter.</li>
<li>See <a href="../en/Ipset.html" title="Ipset">Ipset</a> for blocking lists of ip addresses, such as those from Bluetack.</li>
</ul>
<h3><span class="mw-headline" id="Kernel_parameters">Kernel parameters</span></h3>
<p>Kernel parameters which affect networking can be set using <a href="../en/Sysctl.html" title="Sysctl">Sysctl</a>. For how to do this, see <a href="../en/Sysctl.html#TCP.2FIP_stack_hardening" title="Sysctl">Sysctl#TCP/IP stack hardening</a>.
</p>
<h3><span class="mw-headline" id="SSH">SSH</span></h3>
<p>Avoid using <a href="../en/Secure_Shell.html" title="Secure Shell">Secure Shell</a> without <a href="../en/Secure_Shell.html#Force_public_key_authentication" title="Secure Shell">requiring SSH keys</a>. This prevents <a href="https://en.wikipedia.org/wiki/Brute-force_attack" class="extiw" title="wikipedia:Brute-force attack">brute-force attacks</a>. Alternatively <a href="../en/Fail2ban.html" title="Fail2ban">Fail2ban</a> or <a href="../en/Sshguard.html" title="Sshguard">Sshguard</a> offer lesser forms of protection by monitoring logs and writing <a href="../en/Iptables.html" title="Iptables">iptables rules</a> but open up the potential for a denial of serving, since an attacker can spoof packets as if they came from the administrator after identifying their address.
</p>
<p>You may want to harden authentication even more by using two-factor authentication. <a href="../en/Google_Authenticator.html" title="Google Authenticator">Google Authenticator</a> provides a two-step authentication procedure using one-time passcodes (OTP).
</p>
<p><a href="../en/Secure_Shell.html#Deny" title="Secure Shell">Denying root login</a> is good practice, both for tracing intrusions and adding an additional layer of security before root access.
</p>
<h3><span class="mw-headline" id="DNS">DNS</span></h3>
<p>See <a href="../en/DNSSEC.html" title="DNSSEC">DNSSEC</a> and <a href="../en/DNSCrypt.html" title="DNSCrypt">DNSCrypt</a>.
</p>
<h3><span class="mw-headline" id="Proxies">Proxies</span></h3>
<p>Proxies are commonly used as an extra layer between applications and the network, sanitizing data from untrusted sources. The attack surface of a small proxy running with lower privileges is significantly smaller than a complex application running with the end user privileges.
</p>
<p>For example the DNS resolver is implemented in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=glibc">glibc</a></span>, that is linked with the application (that may be running as root), so a bug in the DNS resolver might lead to a remote code execution. This can be prevented by installing a DNS caching server, such as <a href="../en/Dnsmasq.html" title="Dnsmasq">Dnsmasq</a>, which acts as a proxy. <a rel="nofollow" class="external autonumber" href="https://googleonlinesecurity.blogspot.it/2016/02/cve-2015-7547-glibc-getaddrinfo-stack.html">[2]</a>
</p>
<h3><span class="mw-headline" id="Managing_SSL_certificates">Managing SSL certificates</span></h3>
<p>See <a href="../en/OpenSSL.html" title="OpenSSL">OpenSSL</a> and <a href="../en/Network_Security_Services.html" title="Network Security Services">Network Security Services</a> (NSS) for managing custom server-side SSL certificates. Notably, the related <a href="../en/b9f6f965120480bf1d159235e57f636c.html" title="Let’s Encrypt">Let’s Encrypt</a> project is also supported. 
</p>
<p>The default internet SSL certificate trustchains are provided by the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=ca-certificates">ca-certificates</a></span> package and its dependencies. Note that Arch relies on trust-sources (e.g. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=ca-certificates-cacert">ca-certificates-cacert</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=ca-certificates-mozilla">ca-certificates-mozilla</a></span>) providing the certificates to be trusted per default by the system. 
</p>
<p>There may be occasions when you want to deviate from the default. For example, you may read some <a rel="nofollow" class="external text" href="http://www.theregister.co.uk/2016/05/27/blue_coat_ca_certs/">news</a> and want to distrust a certificate rather than wait until the trust-source providers do. The Arch infrastructure makes such easy: 
</p>
<ol>
<li> Obtain the respective certificate in .crt format (Example: <a rel="nofollow" class="external text" href="https://crt.sh/?id=19538258">view</a>, <a rel="nofollow" class="external text" href="https://crt.sh/?d=19538258">download</a>; in case of an existing trusted root certificate authority, you may also find it extracted in the system path), </li>
<li> Copy it to <code>/etc/ca-certificates/trust-source/blacklist/</code> and </li>
<li> Run <i>update-ca-trust</i> as root. </li>
</ol>
<p>To check the blacklisting works as intended, you may re-open your preferred browser and do so via its GUI, which should show it as <b>untrusted</b> now.
</p>
<h2><span class="mw-headline" id="Authenticating_packages">Authenticating packages</span></h2>
<p><a rel="nofollow" class="external text" href="http://www.cs.arizona.edu/stork/packagemanagersecurity/attacks-on-package-managers.html#overview">Attacks on package managers</a> are possible without proper use of package signing, and can affect even package managers with <a rel="nofollow" class="external text" href="http://www.cs.arizona.edu/stork/packagemanagersecurity/faq.html">proper signature systems</a>. Arch uses package signing by default and relies on a web of trust from 5 trusted master keys. See <a href="../en/Pacman/Package_signing.html" title="Pacman-key" class="mw-redirect">Pacman-key</a> for details.
</p>
<h2><span class="mw-headline" id="Follow_NVD.2FCVE_alerts">Follow NVD/CVE alerts</span></h2>
<p>Subscribe to the Common Vulnerabilities and Exposure Security Alert updates, made available by National Vulnerability Database, and found on the <a rel="nofollow" class="external text" href="http://nvd.nist.gov/download.cfm">NVD Download webpage</a>. See also <a href="../en/Arch_CVE_Monitoring_Team.html" title="Arch CVE Monitoring Team">Arch CVE Monitoring Team</a> and <a href="../en/CVE.html" title="CVE">CVE</a>.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #FFDDDD; border: thin solid #DDBBBB; overflow: hidden;">
<strong> Warning: </strong>Do not be tempted to perform <a href="../en/System_maintenance.html#Partial_upgrades_are_unsupported" title="Partial upgrades" class="mw-redirect">partial upgrades</a>, as they are not supported by Arch Linux and may cause instability: the whole system should be upgraded when upgrading a component. Also note that infrequent system updates can complicate the update process.</div>
<h2><span class="mw-headline" id="Physical_security">Physical security</span></h2>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>You can ignore this section if you just want to secure your computer against remote threats.</div>
<p>Physical access to a computer is root access given enough time and resources. However, a high <i>practical</i> level of security can be obtained by putting up enough barriers.
</p>
<p>An attacker can gain full control of your computer on the next boot by simply attaching a malicious IEEE 1394 (FireWire), Thunderbolt or PCI Express device as they are given full memory access.<a rel="nofollow" class="external autonumber" href="http://www.breaknenter.org/projects/inception/">[3]</a> There is little you can do from preventing this, or modification of the hardware itself - such as flashing malicious firmware onto a drive. However, the vast majority of attackers will not be this knowledgeable and determined.
</p>
<p><a href="#Disk_encryption">#Disk encryption</a> will prevent access to your data if the computer is stolen, but malicious firmware can be installed to obtain this data upon your next log in by a resourceful attacker.
</p>
<h3><span class="mw-headline" id="Locking_down_BIOS">Locking down BIOS</span></h3>
<p>Adding a password to the BIOS prevents someone from booting into removable media, which is basically the same as having root access to your computer. You should make sure your drive is first in the boot order and disable the other drives from being bootable if you can.
</p>
<h3><span class="mw-headline" id="Bootloaders">Bootloaders</span></h3>
<p>It is highly important to protect your bootloader. There is a magic kernel parameter called <code>init=/bin/sh</code>. This makes any user/login restrictions totally useless.
</p>
<h4><span class="mw-headline" id="Syslinux">Syslinux</span></h4>
<p>Syslinux supports <a href="../en/Syslinux.html#Security" title="Syslinux">password-protecting your bootloader</a>.
It allows you to set either a per-menu-item password or a global bootloader password.
</p>
<h4><span class="mw-headline" id="GRUB">GRUB</span></h4>
<p><a href="../en/GRUB.html" title="GRUB">GRUB</a> supports bootloader passwords as well. See <a href="../en/GRUB/Tips_and_tricks.html#Password_protection_of_GRUB_menu" title="GRUB/Tips and tricks">GRUB/Tips and tricks#Password protection of GRUB menu</a> for details. It also has support for <a href="../en/GRUB.html#Boot_partition" title="GRUB">encrypted boot partitions</a>, which only leaves some parts of the bootloader code unencrypted. GRUB's configuration, <a href="../en/Kernels.html" title="Kernel" class="mw-redirect">kernel</a> and <a href="../en/Mkinitcpio.html" title="Initramfs" class="mw-redirect">initramfs</a> are encrypted.
</p>
<h3><span class="mw-headline" id="Denying_console_login_as_root">Denying console login as root</span></h3>
<p>Changing the configuration to disallow root to login from the console makes it harder for an intruder to gain access to the system. The intruder would have to guess both a username that exists on the system and that user's password. When root is allowed to log in via the console, an intruder only needs to guess a password.
Blocking root login at the console is done by commenting out the tty lines in <code>/etc/securetty</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/securetty</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
#tty1
</pre>
<p>Repeat for any tty you wish to block.
To check the effect of this change, start by commenting out only one line and go to that particular console and try to login as root. You will be greeted by the message <code>Login incorrect</code>. Now that we are sure it works, go back and comment out the rest of the tty lines.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>If you see <code>ttyS0</code> this is for a serial console. Similarly, on Xen virtualized systems <code>hvc0</code> is for the administrator.</div>
<h3><span class="mw-headline" id="Automatic_logout">Automatic logout</span></h3>
<p>If you are using <a href="../en/Bash.html" title="Bash">Bash</a> or <a href="../en/Zsh.html" title="Zsh">Zsh</a>, you can set <code>TMOUT</code> for an automatic logout from shells after a timeout.
</p>
<p>For example, the following will automatically log out from virtual consoles (but not terminal emulators in X11):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/profile.d/shell-timeout.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
TMOUT="$(( 60*10 ))";
[ -z "$DISPLAY" ] &amp;&amp; export TMOUT;
case $( /usr/bin/tty ) in
	/dev/tty[0-9]*) export TMOUT;;
esac
</pre>
<p>If you really want EVERY Bash/Zsh prompt (even within X) to timeout, use:
</p>
<pre>$ export TMOUT="$(( 60*10 ))";
</pre>
<p>Note that this will not work if there is some command running in the shell (eg.: an SSH session or other shell without <code>TMOUT</code> support). But if you are using VC mostly for restarting frozen GDM/Xorg as root, then this is very useful.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li> <a href="../en/DeveloperWiki:Security.html" title="DeveloperWiki:Security">DeveloperWiki:Security</a>
</li>
<li> ArchWiki's Current list of security applications: <a href="../en/List_of_applications/Security.html" title="List of applications/Security">Lists of Applications: Security</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://www.puschitz.com/SecuringLinux.shtml">Securing and Hardening Red Hat Linux Production Systems</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://www.ibm.com/developerworks/linux/tutorials/l-harden-desktop/index.html">Hardening the linux desktop</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://www.ibm.com/developerworks/linux/tutorials/l-harden-server/index.html">Hardening the linux server</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://www.faqs.org/docs/securing/index.html">Securing and Optimizing Linux</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://www.auscert.org.au/5816">UNIX and Linux Security Checklist v3.0</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://wiki.centos.org/HowTos/OS_Protection">CentOS Wiki: OS Protection</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://www.debian.org/doc/manuals/securing-debian-howto/securing-debian-howto.en.pdf">Hardening Debian (pdf)</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://crunchbang.org/forums/viewtopic.php?id=24722">The paranoid #! Security Guide</a>
</li>
<li> <a rel="nofollow" class="external text" href="https://github.com/lfit/itpol/blob/master/linux-workstation-security.md">Linux Foundation's Linux workstation security checklist</a>
</li>
<li> <a rel="nofollow" class="external text" href="https://www.privacytools.io/">privacytools.io</a>
</li>
</ul>

</div>
<div id="catlinks" class="catlinks">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Security.html" title="Category:Security">Security</a></li>
<li><a href="../en/Category:File_systems.html" title="Category:File systems">File systems</a></li>
<li><a href="../en/Category:Networking.html" title="Category:Networking">Networking</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
</ul>
</div>
</div>					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
Extracted from <a href="https://wiki.archlinux.org"> ArchWiki </a> and licensed under <a href="http://www.gnu.org/copyleft/fdl.html"> GDL >= 1.3</a>
		</div>
		</div>
		</body>
</html>
