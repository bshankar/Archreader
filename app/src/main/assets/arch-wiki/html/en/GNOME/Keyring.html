<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8">
<title>GNOME/Keyring - ArchWiki</title>
<link rel="stylesheet" href="../../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style></style>
<meta name="generator" content="MediaWiki 1.26.4">
<meta name="robots" content="noindex,follow">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-GNOME_Keyring skin-archlinux action-view">

		<div id="globalWrapper" style="width: 100%">
		<div id="column-content">
			<div id="content" class="mw-body" role="main" style="margin: 2em; margin-bottom: 0">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">GNOME/Keyring</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="contentSub"><span class="subpages">&lt; <a href="../../en/GNOME.html" title="GNOME">GNOME</a></span></div>
										<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<p><a rel="nofollow" class="external text" href="https://wiki.gnome.org/Projects/GnomeKeyring">GNOME Keyring</a> is "a collection of components in GNOME that store secrets, passwords, keys, certificates and make them available to applications."
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>There are some <a href="#Known_issues">#Known issues</a>.</div>
<div id="toc" class="toc">
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Installation"><span class="tocnumber">1</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Manage_using_GUI"><span class="tocnumber">2</span> <span class="toctext">Manage using GUI</span></a></li>
<li class="toclevel-1 tocsection-3">
<a href="#Using_the_keyring_outside_GNOME"><span class="tocnumber">3</span> <span class="toctext">Using the keyring outside GNOME</span></a>
<ul>
<li class="toclevel-2 tocsection-4">
<a href="#Without_a_display_manager"><span class="tocnumber">3.1</span> <span class="toctext">Without a display manager</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Automatic_login"><span class="tocnumber">3.1.1</span> <span class="toctext">Automatic login</span></a></li>
<li class="toclevel-3 tocsection-6">
<a href="#Console_login"><span class="tocnumber">3.1.2</span> <span class="toctext">Console login</span></a>
<ul>
<li class="toclevel-4 tocsection-7"><a href="#PAM_method"><span class="tocnumber">3.1.2.1</span> <span class="toctext">PAM method</span></a></li>
<li class="toclevel-4 tocsection-8"><a href="#xinitrc_method"><span class="tocnumber">3.1.2.2</span> <span class="toctext">xinitrc method</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#With_a_display_manager"><span class="tocnumber">3.2</span> <span class="toctext">With a display manager</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10">
<a href="#SSH_keys"><span class="tocnumber">4</span> <span class="toctext">SSH keys</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Start_SSH_and_Secrets_components_of_keyring_daemon"><span class="tocnumber">4.1</span> <span class="toctext">Start SSH and Secrets components of keyring daemon</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Disable_keyring_daemon_components"><span class="tocnumber">4.2</span> <span class="toctext">Disable keyring daemon components</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13">
<a href="#Tips_and_tricks"><span class="tocnumber">5</span> <span class="toctext">Tips and tricks</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Integration_with_applications"><span class="tocnumber">5.1</span> <span class="toctext">Integration with applications</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Flushing_passphrases"><span class="tocnumber">5.2</span> <span class="toctext">Flushing passphrases</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#GNOME_Keyring_and_Git"><span class="tocnumber">5.3</span> <span class="toctext">GNOME Keyring and Git</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17">
<a href="#Troubleshooting"><span class="tocnumber">6</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#Passwords_are_not_remembered"><span class="tocnumber">6.1</span> <span class="toctext">Passwords are not remembered</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19">
<a href="#Known_issues"><span class="tocnumber">7</span> <span class="toctext">Known issues</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#Cannot_handle_ECDSA_and_Ed25519_keys"><span class="tocnumber">7.1</span> <span class="toctext">Cannot handle ECDSA and Ed25519 keys</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>When using GNOME, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=gnome-keyring">gnome-keyring</a></span> is installed automatically as a part of the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/groups/x86_64/gnome/">gnome</a></span> group. Otherwise <a href="../../en/Help:Reading.html#Installation_of_packages" title="Install" class="mw-redirect">install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=gnome-keyring">gnome-keyring</a></span> package.
</p>
<p>Extra utilities related to GNOME keyring include:
</p>
<ul><li> <b>secret-tool</b> — Access the GNOME keyring (and any other service implementing the <a rel="nofollow" class="external text" href="http://standards.freedesktop.org/secret-service/">DBus Secret Service API</a>) from the command line.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://wiki.gnome.org/Projects/Libsecret">https://wiki.gnome.org/Projects/Libsecret</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=libsecret">libsecret</a></span>
</dd></dl>
<ul><li> <b>gnome-keyring-query</b> — Provides a simple command-line tool for querying passwords from the password store of the GNOME Keyring.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="http://www.gentoo-wiki.info/HOWTO_Use_gnome-keyring_to_store_SSH_passphrases">http://www.gentoo-wiki.info/HOWTO_Use_gnome-keyring_to_store_SSH_passphrases</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gnome-keyring-query/">gnome-keyring-query</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li> <b>gkeyring</b> — Query passwords from the command line, the <a href="../../en/Git.html" title="Git">Git</a> version can list all passwords without needing to know name or id of the item</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/kparal/gkeyring">https://github.com/kparal/gkeyring</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gkeyring/">gkeyring</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gkeyring-git/">gkeyring-git</a></span><sup><small>AUR</small></sup>
</dd></dl>
<h2><span class="mw-headline" id="Manage_using_GUI">Manage using GUI</span></h2>
<p>You can manage the contents of GNOME Keyring using Seahorse. <a href="../../en/Help:Reading.html#Installation_of_packages" title="Install" class="mw-redirect">Install</a> it with the package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=seahorse">seahorse</a></span>.
</p>
<p>It is possible to leave the GNOME keyring password blank or change it. In seahorse, in the "View" drop-down menu, select "By Keyring". On the Passwords tab, right click on "Passwords: login" and pick "Change password." Enter the old password and leave empty the new password. You will be warned about using unencrypted storage; continue by pushing "Use Unsafe Storage."
</p>
<h2><span class="mw-headline" id="Using_the_keyring_outside_GNOME">Using the keyring outside GNOME</span></h2>
<h3><span class="mw-headline" id="Without_a_display_manager">Without a display manager</span></h3>
<h4><span class="mw-headline" id="Automatic_login">Automatic login</span></h4>
<p>If you are using automatic login, then you can disable the keyring manager by setting a blank password on the login keyring.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong> The passwords are stored unencrypted in this case.</div>
<h4><span class="mw-headline" id="Console_login">Console login</span></h4>
<p>When using console-based login, the keyring daemon can be started by either <a href="../../en/PAM.html" title="PAM">PAM</a> or <a href="../../en/Xinit.html" title="Xinitrc" class="mw-redirect">xinitrc</a>. PAM can also unlock the keyring automatically at login.
</p>
<h5><span class="mw-headline" id="PAM_method">PAM method</span></h5>
<p>Start the gnome-keyring-daemon from <code>/etc/pam.d/login</code>:
</p>
<p>Add <code>auth optional pam_gnome_keyring.so</code> at the end of the <code>auth</code> section and <code>session optional pam_gnome_keyring.so auto_start</code> at the end of the <code>session</code> section.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pam.d/login</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
#%PAM-1.0
 
auth       required     pam_securetty.so
auth       requisite    pam_nologin.so
auth       include      system-local-login
<b>auth       optional     pam_gnome_keyring.so</b>
account    include      system-local-login
session    include      system-local-login
<b>session    optional     pam_gnome_keyring.so        auto_start</b></pre>
<p>Next, add <code>password optional pam_gnome_keyring.so</code> to the end of <code>/etc/pam.d/passwd</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pam.d/passwd</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#%PAM-1.0

#password	required	pam_cracklib.so difok=2 minlen=8 dcredit=2 ocredit=2 retry=3
#password	required	pam_unix.so sha512 shadow use_authtok
password	required	pam_unix.so sha512 shadow nullok
<b>password	optional	pam_gnome_keyring.so</b></pre>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>
<ul>
<li> To use automatic unlocking, the same password for the user account and the keyring have to be set.</li>
<li> You will still need the code in <code>~/.xinitrc</code> below in order to export the environment variables required.</li>
</ul>
</div>
<h5><span class="mw-headline" id="xinitrc_method">xinitrc method</span></h5>
<p>Start the gnome-keyring-daemon from <a href="../../en/Xinit.html" title="Xinitrc" class="mw-redirect">xinitrc</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.xinitrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
eval $(/usr/bin/gnome-keyring-daemon --start --components=pkcs11,secrets,ssh)
export SSH_AUTH_SOCK
</pre>
<p>See <a href="../../en/Xfce.html#SSH_agents" title="Xfce">Xfce#SSH agents</a> for use in Xfce.
</p>
<h3><span class="mw-headline" id="With_a_display_manager">With a display manager</span></h3>
<p>When using a display manager, the keyring works out of the box for most cases. The following display managers automatically unlock the keyring once you log in:
</p>
<ul>
<li> <a href="../../en/GDM.html" title="GDM">GDM</a>
</li>
<li> <a href="../../en/SLiM.html" title="SLiM">SLiM</a>
</li>
<li> <a href="../../en/LightDM.html" title="LightDM">LightDM</a>
</li>
<li> <a href="../../en/LXDM.html" title="LXDM">LXDM</a>
</li>
</ul>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong> You may need to install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=libgnome-keyring">libgnome-keyring</a></span> </div>
<p>For KDM, see <a href="../../en/KDM.html#KDM_and_Gnome-keyring" title="KDM">KDM#KDM and Gnome-keyring</a>.
</p>
<p>For <a href="../../en/SDDM.html" title="SDDM">SDDM</a>, follow the KDM guidelines, but modify <code>/etc/pam.d/sddm</code> instead of <code>/etc/pam.d/kde</code>.
</p>
<p>To enable the keyring for applications run through the terminal, such as SSH, add the following to your <code>~/.bash_profile</code>, <code>~/.zshenv</code>, or similar:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.zshenv</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
if [ -n "$DESKTOP_SESSION" ];then
    eval $(gnome-keyring-daemon --start)
    export SSH_AUTH_SOCK
fi</pre>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>The GNOME Keyring Daemon no longer exposes <code>GNOME_KEYRING_PID</code>. See <a rel="nofollow" class="external text" href="https://mail.gnome.org/archives/commits-list/2014-March/msg03864.html">commit</a>.</div>
<h2><span class="mw-headline" id="SSH_keys">SSH keys</span></h2>
<p>To add your SSH key:
</p>
<pre>$ ssh-add ~/.ssh/id_dsa
Enter passphrase for /home/mith/.ssh/id_dsa:
</pre>
<p>To list automatically loaded keys:
</p>
<pre>$ ssh-add -L
</pre>
<p>To disable all keys;
</p>
<pre>$ ssh-add -D
</pre>
<p>Now when you connect to a server, the key will be found and a dialog will popup asking you for the passphrase. It has an option to automatically unlock the key when you log in. If you check this, you will not need to enter your passphrase again!
</p>
<p>Alternatively, to permanently save the a passphrase in the keyring, use seahorse-ssh-askpass from package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=seahorse">seahorse</a></span>:
</p>
<pre>/usr/lib/seahorse/seahorse-ssh-askpass my_key
</pre>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>You have to have a have the corresponding <code>.pub</code> file in the same directory as the private key (<code>~/.ssh/id_dsa.pub</code> in the example). Also, make sure that the public key is the file name of the private key plus <code>.pub</code> (for example, <code>my_key.pub</code>).</div>
<h3><span class="mw-headline" id="Start_SSH_and_Secrets_components_of_keyring_daemon">Start SSH and Secrets components of keyring daemon</span></h3>
<p>If you are starting Gnome Keyring with a display manager or the Pam method described above and you are NOT using Gnome, Unity or Mate as your desktop you may find that the SSH and Secrets components are not being started automatically.
You can fix this by copying the desktop files gnome-keyring-ssh.desktop and gnome-keyring-secrets.desktop from /etc/xdg/autostart/ to ~/.config/autostart/ and deleting the OnlyShowIn line.
</p>
<pre>$ cp /etc/xdg/autostart/{gnome-keyring-secrets.desktop,gnome-keyring-ssh.desktop} ~/.config/autostart/
$ sed -i '/^OnlyShowIn.*$/d' ~/.config/autostart/gnome-keyring-secrets.desktop
$ sed -i '/^OnlyShowIn.*$/d' ~/.config/autostart/gnome-keyring-ssh.desktop
</pre>
<h3><span class="mw-headline" id="Disable_keyring_daemon_components">Disable keyring daemon components</span></h3>
<p>If you wish to run an alternative SSH agent (e.g. <a href="../../en/SSH_keys.html#ssh-agent" title="SSH keys">ssh-agent</a> or <a href="../../en/GnuPG.html#gpg-agent" title="GnuPG">gpg-agent</a>, you need to disable the <code>ssh</code> component of GNOME Keyring.
To do so in an account-local way:
</p>
<pre>#!/bin/sh

mkdir ~/.config/autostart
cp /etc/xdg/autostart/gnome-keyring-ssh.desktop ~/.config/autostart/ &amp;&amp;
printf '%s\n' 'Hidden=true' &gt;&gt; ~/.config/autostart/gnome-keyring-ssh.desktop 
</pre>
<p>Then log out.
</p>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3><span class="mw-headline" id="Integration_with_applications">Integration with applications</span></h3>
<ul><li> <a href="../../en/Firefox.html#GNOME_Keyring_integration" title="Firefox">Firefox#GNOME Keyring integration</a>
</li></ul>
<h3><span class="mw-headline" id="Flushing_passphrases">Flushing passphrases</span></h3>
<pre>gnome-keyring-daemon -r -d
</pre>
<p>This command starts gnome-keyring-daemon, shutting down previously running instances.
</p>
<h3><span class="mw-headline" id="GNOME_Keyring_and_Git">GNOME Keyring and Git</span></h3>
<p>The GNOME keyring is useful in conjuction with <a href="../../en/Git.html" title="Git">Git</a> when you are pushing over HTTPS.
</p>
<p>First install the package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=libgnome-keyring">libgnome-keyring</a></span> from the <a href="../../en/Official_repositories.html" title="Official repositories">official repositories</a>.
</p>
<p>Next compile the helper:
</p>
<pre>$ cd /usr/share/git/credential/gnome-keyring
# make
</pre>
<p>Set Git up to use the helper:
</p>
<pre>$ git config --global credential.helper /usr/lib/git-core/git-credential-gnome-keyring
</pre>
<p>Next time you do a <i>git push</i>, you are asked to unlock your keyring, if not unlocked already.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Passwords_are_not_remembered">Passwords are not remembered</span></h3>
<p>If you get a password prompt every time you login, and you find that passwords are not saved, you might need to create/set a default keyring.
</p>
<p>Ensure that the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=seahorse">seahorse</a></span> package is installed, open it ("Passwords and Keys" in system settings) and select <i>View</i> &gt; <i>By Keyring</i> 
If there is no keyring in the left column (it will be marked with a lock icon), go to <i>File</i> &gt; <i>New</i> &gt; <i>Password Keyring</i> and give it a name. You will be asked to enter a password. If you do not give the keyring a password it will be unlocked automatically, even when using autologin, but passwords will not be stored securely. Finally, right-click on the keyring you just created and select "Set as default".
</p>
<h2><span class="mw-headline" id="Known_issues">Known issues</span></h2>
<h3><span class="mw-headline" id="Cannot_handle_ECDSA_and_Ed25519_keys">Cannot handle ECDSA and Ed25519 keys</span></h3>
<p>As of March 20, 2016, GNOME Keyring does not handle ECDSA<a rel="nofollow" class="external autonumber" href="https://bugzilla.gnome.org/show_bug.cgi?id=641082">[1]</a> and Ed25519<a rel="nofollow" class="external autonumber" href="https://bugzilla.gnome.org/show_bug.cgi?id=723274">[2]</a> keys. You can turn to other <a href="../../en/SSH_keys.html#SSH_agents" title="SSH keys">SSH agents</a> if you need support for those.
</p>
</div>
<div id="catlinks" class="catlinks"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../../en/Category:GNOME.html" title="Category:GNOME">GNOME</a></li></ul>
</div></div>					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<ul id="f-list" style="margin: 0 2em">
									<li>
Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=GNOME/Keyring&amp;oldid=453396">https://wiki.archlinux.org/index.php?title=GNOME/Keyring&amp;oldid=453396</a>"</li>
					<li id="lastmod"> This page was last modified on 9 October 2016, at 03:35.</li>
									<li id="copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
									<br><li id="privacy"><a href="../../en/ArchWiki:General_disclaimer.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="../../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
									<li id="disclaimer"><a href="../../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		</body>
</html>
