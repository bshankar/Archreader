<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8">
<title>GNOME package guidelines - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style></style>
<meta name="generator" content="MediaWiki 1.26.4">
<meta name="robots" content="noindex,follow">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-GNOME_package_guidelines skin-archlinux action-view">

		<div id="globalWrapper" style="width: 100%">
		<div id="column-content">
			<div id="content" class="mw-body" role="main" style="margin: 0.5em; margin-bottom:0; margin-top:0">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">GNOME package guidelines</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="contentSub"></div>
										<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="toc" style="display:block; text-align: center; margin-bottom: 1em;">
<b><a href="../en/Creating_packages.html" title="Creating packages">Package creation guidelines</a></b>
<hr>
<p><a href="../en/CLR_package_guidelines.html" title="CLR package guidelines">CLR</a> – <a href="../en/Cross-compiling_tools_package_guidelines.html" title="Cross-compiling tools package guidelines">Cross</a> – <a href="../en/Eclipse_plugin_package_guidelines.html" title="Eclipse plugin package guidelines">Eclipse</a> – <a href="../en/Free_Pascal_package_guidelines.html" title="Free Pascal package guidelines">Free Pascal</a> – <strong class="selflink">GNOME</strong> – <a href="../en/Go_package_guidelines.html" title="Go package guidelines">Go</a> – <a href="../en/Haskell_package_guidelines.html" title="Haskell package guidelines">Haskell</a> – <a href="../en/Java_package_guidelines.html" title="Java package guidelines">Java</a> – <a href="../en/KDE_package_guidelines.html" title="KDE package guidelines">KDE</a> – <a href="../en/Kernel_module_package_guidelines.html" title="Kernel module package guidelines">Kernel</a> – <a href="../en/Lisp_package_guidelines.html" title="Lisp package guidelines">Lisp</a> – <a href="../en/MinGW_package_guidelines.html" title="MinGW package guidelines">MinGW</a> – <a href="../en/Node.js_package_guidelines.html" title="Node.js package guidelines">Node.js</a> – <a href="../en/Nonfree_applications_package_guidelines.html" title="Nonfree applications package guidelines">Nonfree</a> – <a href="../en/OCaml_package_guidelines.html" title="OCaml package guidelines">OCaml</a> – <a href="../en/Perl_package_guidelines.html" title="Perl package guidelines">Perl</a> – <a href="../en/PHP_package_guidelines.html" title="PHP package guidelines">PHP</a> – <a href="../en/Python_package_guidelines.html" title="Python package guidelines">Python</a> – <a href="../en/Ruby_Gem_package_guidelines.html" title="Ruby Gem package guidelines">Ruby</a> – <a href="../en/VCS_package_guidelines.html" title="VCS package guidelines">VCS</a> – <a href="../en/Web_application_package_guidelines.html" title="Web application package guidelines">Web</a> – <a href="../en/Wine_package_guidelines.html" title="Wine package guidelines">Wine</a>
</p>
</div>
<p>The <a href="../en/GNOME.html" title="GNOME">GNOME</a> packages on Arch Linux follow a certain schema.
</p>
<div id="toc" class="toc">
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#GNOME_profile_initialization"><span class="tocnumber">1</span> <span class="toctext">GNOME profile initialization</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#GConf_schemas"><span class="tocnumber">2</span> <span class="toctext">GConf schemas</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#GSettings_schemas"><span class="tocnumber">3</span> <span class="toctext">GSettings schemas</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Scrollkeeper_documentation"><span class="tocnumber">4</span> <span class="toctext">Scrollkeeper documentation</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#.desktop_files"><span class="tocnumber">5</span> <span class="toctext">.desktop files</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#GTK_icon_cache"><span class="tocnumber">6</span> <span class="toctext">GTK icon cache</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#.install_files"><span class="tocnumber">7</span> <span class="toctext">.install files</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Example"><span class="tocnumber">8</span> <span class="toctext">Example</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="GNOME_profile_initialization">GNOME profile initialization</span></h2>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-cut.png" class="image"><img alt="Tango-edit-cut.png" src="../File:Tango-edit-cut.png" width="48" height="48"></a><b>This section is being considered for removal.</b><a href="../File:Tango-edit-cut.png" class="image"><img alt="Tango-edit-cut.png" src="../File:Tango-edit-cut.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> This seems like it doesn't need to be mentioned at all anymore. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:GNOME_package_guidelines">Talk:GNOME package guidelines#</a>)</div>
</div>
<p>There is no GNOME profile initialization anymore. The old line below should be stripped from any <a href="../en/PKGBUILD.html" title="PKGBUILD">PKGBUILD</a>:
</p>
<pre>[ -z "$GNOMEDIR" ] &amp;&amp; . /etc/profile.d/gnome.sh</pre>
<h2><span class="mw-headline" id="GConf_schemas">GConf schemas</span></h2>
<p>Many GNOME packages install <a href="https://en.wikipedia.org/wiki/GConf#Schemas" class="extiw" title="wikipedia:GConf">GConf schemas</a>. These schemas get installed in the system GConf database, which has to be avoided.
Some packages provide a <code>--disable-schemas-install</code> switch for <b>./configure</b>, which hardly ever works. Therefore, gconftool-2 has a variable called <code>GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL</code>, whenever this is set, gconftool-2 will not update any databases.
</p>
<p>When creating packages that install schema files, use
</p>
<pre>make GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1 DESTDIR=${pkgdir} install</pre>
<p>for the package installation step in the PKGBUILD.
</p>
<p>GConf schemas need to be installed and removed in the <code>.install</code> file using <code>pre_remove</code>, <code>pre_upgrade</code> and <code>post_upgrade</code> and <code>post_install</code>. Use <b>gconf-merge-schemas</b> to merge several schemas into one package specific file, install or uninstall them with <code>usr/sbin/gconfpkg --<i>(un)</i>install $pkgname</code>
The usage of <b>gconfpkg</b> requres a dependency on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=gconf">gconf</a></span>&gt;=2.18.0.1-4 (or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=gconfmm">gconfmm</a></span>&gt;=2.20.0).
</p>
<h2><span class="mw-headline" id="GSettings_schemas">GSettings schemas</span></h2>
<p>The GConf schemas will be replaced by GSettings schemas in the near future, but some applications (e.g. Empathy) already using it. GSettings uses dconf as backend, so all packages that contain GSettings schemas require dconf as dependency. When a new GSettings schema installed on the system, the GSettings database should be recompiled, but not when packaging.
To avoid recompiling GSettings database on packaging, use the <code>--disable-schemas-compile</code> switch for <b>./configure</b>. To recompile it on install, add the following line to the .install file using post_install, post_upgrade and post_remove:
</p>
<pre>glib-compile-schemas usr/share/glib-2.0/schemas
</pre>
<h2><span class="mw-headline" id="Scrollkeeper_documentation">Scrollkeeper documentation</span></h2>
<p>Starting from GNOME 2.20 there is no need to handle scrollkeeper anymore, as rarian reads OMF files directly. Scrollkeeper-update is a dummy these days. The only required thing now is to makedepend on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=gnome-doc-utils">gnome-doc-utils</a></span>&gt;=0.11.2.
</p>
<h2><span class="mw-headline" id=".desktop_files">.desktop files</span></h2>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Transactional hooks in Pacman-5.0 make some of these .install requirements obsolete (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:GNOME_package_guidelines">Talk:GNOME package guidelines#</a>)</div>
</div>
<p>Many packages install Freedesktop.org compatible <code>.desktop</code> files and register MimeType entries in them. Running <code>update-desktop-database -q</code> in <code>post_install</code> and <code>post_remove</code> is recommended (package should depend on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=desktop-file-utils">desktop-file-utils</a></span> in this case).
</p>
<h2><span class="mw-headline" id="GTK_icon_cache">GTK icon cache</span></h2>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Transactional hooks in Pacman-5.0 make some of these .install requirements obsolete (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:GNOME_package_guidelines">Talk:GNOME package guidelines#</a>)</div>
</div>
<p>Quite some packages install icons in the hicolor icon theme. These packages should depend on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=gtk-update-icon-cache">gtk-update-icon-cache</a></span> and should have <code>gtk-update-icon-cache -q -t -f usr/share/icons/hicolor</code> (WITHOUT leading slash) in the <code>post_install</code>, <code>post_upgrade</code> and <code>post_remove</code> function.
</p>
<h2><span class="mw-headline" id=".install_files">.install files</span></h2>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> gedit no longer has a .install file (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:GNOME_package_guidelines">Talk:GNOME package guidelines#</a>)</div>
</div>
<p>For many GNOME packages, all .install files look almost exactly the same. The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=gedit">gedit</a></span> package contains a very generic install file:
<a rel="nofollow" class="external free" href="https://projects.archlinux.org/svntogit/packages.git/tree/gedit/repos/extra-x86_64/gedit.install">https://projects.archlinux.org/svntogit/packages.git/tree/gedit/repos/extra-x86_64/gedit.install</a>
</p>
<p>Basically, the only thing that has to be changed is the <code>pkgname</code> variable on top of the <code>.install</code> file. As long as pacman does not supply us with the <code>pkgname</code> variable, we need to supply it in the <code>.install</code> file.
When packages do not have gconf schemas, hicolor icon files, or <code>.desktop</code> files, remove the parts that handle those subjects.
</p>
<h2><span class="mw-headline" id="Example">Example</span></h2>
<p>For an example of above rules, take a look at the gedit PKGBUILD and the <code>.install</code> file supplied above:
<a rel="nofollow" class="external free" href="https://projects.archlinux.org/svntogit/packages.git/tree/gedit/repos/extra-x86_64/">https://projects.archlinux.org/svntogit/packages.git/tree/gedit/repos/extra-x86_64/</a>
</p>
</div>
<div id="catlinks" class="catlinks">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Package_development.html" title="Category:Package development">Package development</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Sections_flagged_with_Template:Remove.html" title="Category:Sections flagged with Template:Remove">Sections flagged with Template:Remove</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
</ul>
</div>
</div>					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
Extracted from <a href="https://wiki.archlinux.org"> ArchWiki </a> and licensed under <a href="http://www.gnu.org/copyleft/fdl.html"> GDL >= 1.3</a>
		</div>
		</div>
		</body>
</html>
