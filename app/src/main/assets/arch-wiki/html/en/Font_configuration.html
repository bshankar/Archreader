<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8">
<title>Font configuration - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style></style>
<meta name="generator" content="MediaWiki 1.26.4">
<meta name="robots" content="noindex,follow">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Font_configuration skin-archlinux action-view">

		<div id="globalWrapper" style="width: 100%">
		<div id="column-content">
			<div id="content" class="mw-body" role="main" style="margin: 0.5em; margin-bottom:0; margin-top:0">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Font configuration</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="contentSub"></div>
										<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div style="width:45%; margin: 0 0 0.5em 0.5em;">
<p style="background:#333; color:white; padding:0.2em; border-bottom:5px #08c solid; margin:0; text-align:center; font-weight:bold;">Related articles</p>
<ul style="list-style-type:none; margin:0; padding:0.3em;">
<li style="padding:0.4em 0; line-height:1;"><a href="../en/Fonts.html" title="Fonts">Fonts</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/Font_configuration/Examples.html" title="Font configuration/Examples">Font configuration/Examples</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/Infinality.html" title="Infinality">Infinality</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/Java_Runtime_Environment_fonts.html" title="Java Runtime Environment Fonts" class="mw-redirect">Java Runtime Environment Fonts</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/Metric-compatible_fonts.html" title="Metric-compatible fonts">Metric-compatible fonts</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/Microsoft_fonts.html" title="MS Fonts" class="mw-redirect">MS Fonts</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/X_Logical_Font_Description.html" title="X Logical Font Description">X Logical Font Description</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="http://www.freedesktop.org/wiki/Software/fontconfig/">Fontconfig</a> is a library designed to provide a list of available <a href="../en/Fonts.html" title="Fonts">fonts</a> to applications, and also for configuration for how fonts get rendered: see <a href="https://en.wikipedia.org/wiki/Fontconfig" class="extiw" title="wikipedia:Fontconfig">Wikipedia:Fontconfig</a>. The FreeType library <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=freetype2">freetype2</a></span> renders the fonts, based on this configuration.
</p>
<p>Though Fontconfig is the standard in modern Linux, some applications rely on the original method of font selection and display, the <a href="../en/X_Logical_Font_Description.html" title="X Logical Font Description">X Logical Font Description</a>.
</p>
<p>The font rendering packages on Arch Linux includes support for <i>freetype2</i> with the bytecode interpreter (BCI) enabled. For better font rendering, especially with an LCD monitor, see <a href="#Fontconfig_configuration">#Fontconfig configuration</a> and <a href="../en/Font_configuration/Examples.html" title="Font configuration/Examples">Font configuration/Examples</a>.
</p>
<div id="toc" class="toc">
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Font_paths"><span class="tocnumber">1</span> <span class="toctext">Font paths</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Fontconfig_configuration"><span class="tocnumber">2</span> <span class="toctext">Fontconfig configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Presets"><span class="tocnumber">2.1</span> <span class="toctext">Presets</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Anti-aliasing"><span class="tocnumber">2.2</span> <span class="toctext">Anti-aliasing</span></a></li>
<li class="toclevel-2 tocsection-5">
<a href="#Hinting"><span class="tocnumber">2.3</span> <span class="toctext">Hinting</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#Byte-Code_Interpreter_.28BCI.29"><span class="tocnumber">2.3.1</span> <span class="toctext">Byte-Code Interpreter (BCI)</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Autohinter"><span class="tocnumber">2.3.2</span> <span class="toctext">Autohinter</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Hintstyle"><span class="tocnumber">2.3.3</span> <span class="toctext">Hintstyle</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9">
<a href="#Subpixel_rendering"><span class="tocnumber">2.4</span> <span class="toctext">Subpixel rendering</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#LCD_filter"><span class="tocnumber">2.4.1</span> <span class="toctext">LCD filter</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Advanced_LCD_filter_specification"><span class="tocnumber">2.4.2</span> <span class="toctext">Advanced LCD filter specification</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="#Disable_auto-hinter_for_bold_fonts"><span class="tocnumber">2.5</span> <span class="toctext">Disable auto-hinter for bold fonts</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Replace_or_set_default_fonts"><span class="tocnumber">2.6</span> <span class="toctext">Replace or set default fonts</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Whitelisting_and_blacklisting_fonts"><span class="tocnumber">2.7</span> <span class="toctext">Whitelisting and blacklisting fonts</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Disable_bitmap_fonts"><span class="tocnumber">2.8</span> <span class="toctext">Disable bitmap fonts</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Disable_scaling_of_bitmap_fonts"><span class="tocnumber">2.9</span> <span class="toctext">Disable scaling of bitmap fonts</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Create_bold_and_italic_styles_for_incomplete_fonts"><span class="tocnumber">2.10</span> <span class="toctext">Create bold and italic styles for incomplete fonts</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Change_rule_overriding"><span class="tocnumber">2.11</span> <span class="toctext">Change rule overriding</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Query_the_current_settings"><span class="tocnumber">2.12</span> <span class="toctext">Query the current settings</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-20"><a href="#Applications_without_fontconfig_support"><span class="tocnumber">3</span> <span class="toctext">Applications without fontconfig support</span></a></li>
<li class="toclevel-1 tocsection-21">
<a href="#Troubleshooting"><span class="tocnumber">4</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-22"><a href="#Distorted_fonts"><span class="tocnumber">4.1</span> <span class="toctext">Distorted fonts</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Calibri.2C_Cambria.2C_Monaco.2C_etc._not_rendering_properly"><span class="tocnumber">4.2</span> <span class="toctext">Calibri, Cambria, Monaco, etc. not rendering properly</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Applications_overriding_hinting"><span class="tocnumber">4.3</span> <span class="toctext">Applications overriding hinting</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Applications_not_picking_up_hinting_from_DE.27s_settings"><span class="tocnumber">4.4</span> <span class="toctext">Applications not picking up hinting from DE's settings</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Incorrect_hinting_in_GTK_applications_on_non-Gnome_systems"><span class="tocnumber">4.5</span> <span class="toctext">Incorrect hinting in GTK applications on non-Gnome systems</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Font_problem_in_Generated_PDFs"><span class="tocnumber">4.6</span> <span class="toctext">Font problem in Generated PDFs</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-28"><a href="#See_also"><span class="tocnumber">5</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Font_paths">Font paths</span></h2>
<p>For fonts to be known to applications, they must be cataloged for easy and quick access.
</p>
<p>The font paths initially known to Fontconfig are: <code>/usr/share/fonts/</code>, <code>~/.local/share/fonts</code> (and <code>~/.fonts/</code>, now deprecated). Fontconfig will scan these directories recursively. For ease of organization and installation, it is recommended to use these font paths when <a href="../en/Fonts.html#Installation" title="Adding fonts" class="mw-redirect">adding fonts</a>.
</p>
<p>To see a list of known Fontconfig fonts:
</p>
<pre>$ fc-listÂ : file
</pre>
<p>See <code>man fc-list</code> for more output formats.
</p>
<p>Check for Xorg's known font paths by reviewing its log:
</p>
<pre>$ grep /fonts ~/.local/share/xorg/Xorg.0.log
</pre>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDFFDD; border: thin solid #BBDDBB; overflow: hidden;">
<strong> Tip: </strong>
<ul>
<li> You can also check the list of <a href="../en/Xorg.html" title="Xorg">Xorg</a>'s known font paths using the command <code>xset q</code>.</li>
<li> Use <code>/var/log/Xorg.0.log</code> if Xorg is run with root privileges.</li>
</ul>
</div>
<p>Keep in mind that Xorg does not search recursively through the <code>/usr/share/fonts/</code> directory like Fontconfig does.  To add a path, the full path must be used:
</p>
<pre>Section "Files"
    FontPath     "/usr/share/fonts/local/"
EndSection
</pre>
<p>If you want font paths to be set on a per-user basis, you can add and remove font paths from the default by adding the following line(s) to <code>~/.xinitrc</code>:
</p>
<pre>xset +fp /usr/share/fonts/local/           # Prepend a custom font path to Xorg's list of known font paths
xset -fp /usr/share/fonts/sucky_fonts/     # Remove the specified font path from Xorg's list of known font paths
</pre>
<p>To see a list of known Xorg fonts use <code>xlsfonts</code>, from the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=xorg-xlsfonts">xorg-xlsfonts</a></span> package.
</p>
<h2><span class="mw-headline" id="Fontconfig_configuration">Fontconfig configuration</span></h2>
<p>Fontconfig is documented in the <a rel="nofollow" class="external text" href="http://www.freedesktop.org/software/fontconfig/fontconfig-user.html">fonts-conf</a> man page.
</p>
<p>Configuration can be done per-user through <code>$XDG_CONFIG_HOME/fontconfig/fonts.conf</code>, and globally with <code>/etc/fonts/local.conf</code>.  The settings in the per-user configuration have precedence over the global configuration.  Both these files use the same syntax.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>Configuration files and directories: <code>~/.fonts.conf/</code>, <code>~/.fonts.conf.d/</code> and <code>~/.fontconfig/*.cache-*</code> are deprecated since <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=fontconfig">fontconfig</a></span> 2.10.1 (<a rel="nofollow" class="external text" href="http://cgit.freedesktop.org/fontconfig/commit/?id=8c255fb185d5651b57380b0a9443001e8051b29d">upstream commit</a>) and will not be read by default in the future versions of the package. New paths are <code>$XDG_CONFIG_HOME/fontconfig/fonts.conf</code>, <code>$XDG_CONFIG_HOME/fontconfig/conf.d/NN-name.conf</code> and <code>$XDG_CACHE_HOME/fontconfig/*.cache-*</code> respectively. If using the second location, make sure the naming is valid (where <code>NN</code> is a two digit number like <code>00</code>, <code>10</code>, or <code>99</code>).</div>
<p>Fontconfig gathers all its configurations in a central file (<code>/etc/fonts/fonts.conf</code>).  This file is replaced during fontconfig updates and should not be edited.  Fontconfig-aware applications source this file to know available fonts and how they get rendered.  This file is a conglomeration of rules from the global configuration (<code>/etc/fonts/local.conf</code>), the configured presets in <code>/etc/fonts/conf.d/</code>, and the user configuration file (<code>$XDG_CONFIG_HOME/fontconfig/fonts.conf</code>). <code>fc-cache</code> can be used to rebuild fontconfig's configuration, although changes will only be visible in newly launched applications.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>For some desktop environments (such as <a href="../en/GNOME.html" title="GNOME">GNOME</a> and <a href="../en/KDE.html" title="KDE">KDE</a>) using the <i>Font Control Panel</i> will automatically create or overwrite the user font configuration file.  For these desktop environments, it is best to match your already defined font configurations to get the expected behavior.</div>
<p>Fontconfig configuration files use <a href="https://en.wikipedia.org/wiki/XML" class="extiw" title="wikipedia:XML">XML</a> format and need these headers:
</p>
<pre>
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE fontconfig SYSTEM "fonts.dtd"&gt;
&lt;fontconfig&gt;

  &lt;!-- settings go here --&gt;

&lt;/fontconfig&gt;
</pre>
<p>The configuration examples in this article omit these tags.
</p>
<h3><span class="mw-headline" id="Presets">Presets</span></h3>
<p>There are presets installed in the directory <code>/etc/fonts/conf.avail</code>.  They can be enabled by creating <a href="https://en.wikipedia.org/wiki/Symbolic_link" class="extiw" title="wikipedia:Symbolic link">symbolic links</a> to them, both per-user and globally, as described in <code>/etc/fonts/conf.d/README</code>.  These presets will override matching settings in their respective configuration files.
</p>
<p>For example, to enable sub-pixel RGB rendering globally:
</p>
<pre># cd /etc/fonts/conf.d
# ln -s ../conf.avail/10-sub-pixel-rgb.conf
</pre>
<p>To do the same but instead for a per-user configuration:
</p>
<pre>$ mkdir $XDG_CONFIG_HOME/fontconfig/conf.d
$ ln -s /etc/fonts/conf.avail/10-sub-pixel-rgb.conf $XDG_CONFIG_HOME/fontconfig/conf.d
</pre>
<h3><span class="mw-headline" id="Anti-aliasing">Anti-aliasing</span></h3>
<p><a href="https://en.wikipedia.org/wiki/Font_rasterization" class="extiw" title="wikipedia:Font rasterization">Font rasterization</a> converts vector font data to bitmap data so that it can be displayed. The result can appear jagged due to <a href="https://en.wikipedia.org/wiki/Aliasing" class="extiw" title="wikipedia:Aliasing">aliasing</a>. Technique known as <a href="https://en.wikipedia.org/wiki/Anti-aliasing" class="extiw" title="wikipedia:Anti-aliasing">anti-aliasing</a> can be used to increase the apparent resolution of font edges. Anti-aliasing is <b>enabled</b> by default. To disable it:
</p>
<pre>
  &lt;match target="font"&gt;
    &lt;edit name="antialias" mode="assign"&gt;
      &lt;bool&gt;false&lt;/bool&gt;
    &lt;/edit&gt;
  &lt;/match&gt;
</pre>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>Some applications, like <a href="../en/GNOME.html" title="GNOME">GNOME</a> may <a href="#Troubleshooting">override default anti-aliasing settings</a>.</div>
<h3><span class="mw-headline" id="Hinting">Hinting</span></h3>
<p><a href="https://en.wikipedia.org/wiki/Font_hinting" class="extiw" title="wikipedia:Font hinting">Font hinting</a> (also known as instructing) is the use of mathematical instructions to adjust the display of an outline font so that it lines up with a rasterized grid, (i.e. the pixel grid of the display).  Its intended effect is to make fonts appear more crisp so that they are more readable. Fonts will line up correctly without hinting when displays have around 300 <a href="https://en.wikipedia.org/wiki/Dots_per_inch" class="extiw" title="wikipedia:Dots per inch">DPI</a>.
</p>
<h4><span class="mw-headline" id="Byte-Code_Interpreter_.28BCI.29">Byte-Code Interpreter (BCI)</span></h4>
<p>Using BCI hinting, instructions in TrueType fonts are rendered according to FreeTypes's interpreter. BCI hinting works well with fonts with good hinting instructions. Hinting is <b>enabled</b> by default. To disable it:
</p>
<pre>
  &lt;match target="font"&gt;
    &lt;edit name="hinting" mode="assign"&gt;
      &lt;bool&gt;false&lt;/bool&gt;
    &lt;/edit&gt;
  &lt;/match&gt;
</pre>
<h4><span class="mw-headline" id="Autohinter">Autohinter</span></h4>
<p>The autohinter attempts to do automatic hinting and disregards any existing hinting information. Originally it was the default because TrueType2 fonts were patent-protected but now that these patents have expired there is very little reason to use it. It does work better with fonts that have broken or no hinting information but it will be strongly sub-optimal for fonts with good hinting information. Generally common fonts are of the later kind so autohinter will not be useful. Autohinter is <b>disabled</b> by default. To enable it:
</p>
<pre>
  &lt;match target="font"&gt;
    &lt;edit name="autohint" mode="assign"&gt;
      &lt;bool&gt;true&lt;/bool&gt;
    &lt;/edit&gt;
  &lt;/match&gt;
</pre>
<h4><span class="mw-headline" id="Hintstyle">Hintstyle</span></h4>
<p>Hintstyle is the amount of font reshaping done to line up to the grid.  Hinting values are: <code>hintnone</code>, <code>hintslight</code>, <code>hintmedium</code>, and <code>hintfull</code>.  <code>hintslight</code> will make the font more fuzzy to line up to the grid but will be better in retaining font shape, while <code>hintfull</code> will be a crisp font that aligns well to the pixel grid but will lose a greater amount of font shape. <b><code>hintslight</code></b> is the default setting. To change it:
</p>
<pre>
  &lt;match target="font"&gt;
    &lt;edit name="hintstyle" mode="assign"&gt;
      &lt;const&gt;hintnone&lt;/const&gt;
    &lt;/edit&gt;
  &lt;/match&gt;
</pre>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>Some applications, like <a href="../en/GNOME.html" title="GNOME">GNOME</a> may <a href="#Troubleshooting">override default hinting settings.</a>
</div>
<h3><span class="mw-headline" id="Subpixel_rendering">Subpixel rendering</span></h3>
<p>Most monitors manufactured today use the Red, Green, Blue (RGB) specification. Fontconfig will need to know your monitor type to be able to display your fonts correctly.  Monitors are either: <b>RGB</b> (most common), <b>BGR</b>, <b>V-RGB</b> (vertical), or <b>V-BGR</b>.  A monitor test can be found <a rel="nofollow" class="external text" href="http://www.lagom.nl/lcd-test/subpixel.php">here</a>.
</p>
<p>To enable subpixel rendering:
</p>
<pre>
  &lt;match target="font"&gt;
    &lt;edit name="rgba" mode="assign"&gt;
      &lt;const&gt;rgb&lt;/const&gt;
    &lt;/edit&gt;
  &lt;/match&gt;
</pre>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>Subpixel rendering effectively triples the horizontal (or vertical) resolution for fonts by making use of subpixels. The default autohinter and subpixel rendering are not designed to work together, hence you will want to enable the subpixel autohinter. The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=freetype2">freetype2</a></span> package is compiled with a <a rel="nofollow" class="external text" href="https://git.archlinux.org/svntogit/packages.git/tree/trunk/0003-Make-subpixel-hinting-mode-configurable.patch?h=packages/freetype2">patch</a>. Prior to <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=freetype2">freetype2</a></span> 2.7, the subpixel hinting mode configurable by the <code>FT2_SUBPIXEL_HINTING</code> <a href="../en/Environment_variables.html" title="Environment variable" class="mw-redirect">environment variable</a>. Possible values are 0 (disabled), 1 (Infinality) and 2 (minimal). From <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=freetype2">freetype2</a></span> 2.7, subpixel hinting uses upstream's configuration method, which has a different syntax. Subpixel hinting mode configured in the file /etc/profile.d/freetype2.sh which includes a brief documentation. Possible values are truetype:interpreter-version=35 (classic mode/2.6 default), truetype:interpreter-version=38 (Infinality mode), truetype:interpreter-version=40 (minimal mode/2.7 default).</div>
<h4><span class="mw-headline" id="LCD_filter">LCD filter</span></h4>
<p>When using subpixel rendering, you should enable the LCD filter, which is designed to reduce colour fringing.  This is described under <a rel="nofollow" class="external text" href="http://www.freetype.org/freetype2/docs/reference/ft2-lcd_filtering.html">LCD filtering</a> in the FreeType 2 API reference.  Different options are described under <a rel="nofollow" class="external text" href="http://www.freetype.org/freetype2/docs/reference/ft2-lcd_filtering.html#FT_LcdFilter">FT_LcdFilter</a>, and are illustrated by this <a rel="nofollow" class="external text" href="http://www.spasche.net/files/lcdfiltering/">LCD filter test</a> page.
</p>
<p>The <code>lcddefault</code> filter will work for most users. Other filters are available that can be used in special situations: <code>lcdlight</code>; a lighter filter ideal for fonts that look too bold or fuzzy, <code>lcdlegacy</code>, the original Cairo filter; and <code>lcdnone</code> to disable it entirely.
</p>
<pre>
  &lt;match target="font"&gt;
    &lt;edit name="lcdfilter" mode="assign"&gt;
      &lt;const&gt;lcddefault&lt;/const&gt;
    &lt;/edit&gt;
  &lt;/match&gt;
</pre>
<h4><span class="mw-headline" id="Advanced_LCD_filter_specification">Advanced LCD filter specification</span></h4>
<p>If the available, built-in LCD filters are not satisfactory, it is possible to tweak the font rendering very specifically by building a custom freetype2 package and modifying the hardcoded filters. The <a href="../en/Arch_Build_System.html" title="Arch Build System">Arch Build System</a> can be used to build and install packages from source.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDFFDD; border: thin solid #BBDDBB; overflow: hidden;">
<strong> Tip: </strong>With the <a href="../en/Infinality.html" title="Infinality">Infinality</a> packages, the LCD filter can be modified without rebuilds.</div>
<p>First, refresh the freetype2 PKGBUILD as root:
</p>
<pre># abs extra/freetype2
</pre>
<p>This example uses <code>/var/abs/build</code> as the build directory, substitute it according to your personal ABS setup. Download and extract the freetype2 package as a regular user:
</p>
<pre>$ cd /var/abs/build
$ cp -r ../extra/freetype2 .
$ cd freetype2
$ makepkg -o
</pre>
<p>Edit the file <code>src/freetype-VERSION/src/base/ftlcdfil.c</code> and look up the definition of the constant <code>default_filter[5]</code>:
</p>
<pre>static const FT_Byte  default_filter[5] =
    { 0x10, 0x40, 0x70, 0x40, 0x10 };
</pre>
<p>This constant defines a low-pass filter applied to the rendered glyph. Modify it as needed. Save the file, build and install the custom package:
</p>
<pre>$ makepkg -e
# pacman -Rd freetype2
# pacman -U freetype2-VERSION-ARCH.pkg.tar.xz
</pre>
<p>Reboot or restart X. The lcddefault filter should now render fonts differently.
</p>
<h3><span class="mw-headline" id="Disable_auto-hinter_for_bold_fonts">Disable auto-hinter for bold fonts</span></h3>
<p>The auto-hinter uses sophisticated methods for font rendering, but often makes bold fonts too wide. Fortunately, a solution can be turning off the autohinter for bold fonts while leaving it on for the rest:
</p>
<pre>...
&lt;match target="font"&gt;
    &lt;test name="weight" compare="more"&gt;
        &lt;const&gt;medium&lt;/const&gt;
    &lt;/test&gt;
    &lt;edit name="autohint" mode="assign"&gt;
        &lt;bool&gt;false&lt;/bool&gt;
    &lt;/edit&gt;
&lt;/match&gt;
...
</pre>
<h3><span class="mw-headline" id="Replace_or_set_default_fonts">Replace or set default fonts</span></h3>
<p>The most reliable way to do this is to add an XML fragment similar to the one below. <i>Using the "binding" attribute will give you better results</i>, for example, in Firefox where you may not want to change properties of font being replaced. This will cause Ubuntu to be used in place of Georgia:
</p>
<pre>
...
 &lt;match target="pattern"&gt;
   &lt;test qual="any" name="family"&gt;&lt;string&gt;georgia&lt;/string&gt;&lt;/test&gt;
   &lt;edit name="family" mode="assign" binding="same"&gt;&lt;string&gt;Ubuntu&lt;/string&gt;&lt;/edit&gt;
 &lt;/match&gt;
...
</pre>
<p>An alternate approach is to set the "preferred" font, but <i>this only works if the original font is not on the system</i>, in which case the one specified will be substituted:
</p>
<pre>
...
&lt;!-- Replace Helvetica with Bitstream Vera Sans Mono --&gt;
&lt;!-- Note, an alias for Helvetica should already exist in default conf files --&gt;
&lt;alias&gt;
    &lt;family&gt;Helvetica&lt;/family&gt;
    &lt;prefer&gt;&lt;family&gt;Bitstream Vera Sans Mono&lt;/family&gt;&lt;/prefer&gt;
    &lt;default&gt;&lt;family&gt;fixed&lt;/family&gt;&lt;/default&gt;
&lt;/alias&gt;
...
</pre>
<h3><span class="mw-headline" id="Whitelisting_and_blacklisting_fonts">Whitelisting and blacklisting fonts</span></h3>
<p>The element <code>&lt;selectfont&gt;</code> is used in conjunction with the <code>&lt;acceptfont&gt;</code> and <code>&lt;rejectfont&gt;</code> elements to selectively whitelist or blacklist fonts from the resolve list and match requests. The simplest and most typical use case it to reject one font that is needed to be installed, however is getting matched for a generic font query that is causing problems within application user interfaces.
</p>
<p>First obtain the Family name as listed in the font itself:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ fc-scan .fonts/lklug.ttf --format='%{family}\n'</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">LKLUG</pre>
<p>Then use that Family name in a <code>&lt;rejectfont&gt;</code> stanza:
</p>
<pre>
&lt;selectfont&gt;
    &lt;rejectfont&gt;
        &lt;pattern&gt;
            &lt;patelt name="family" &gt;
                &lt;string&gt;LKLUG&lt;/string&gt;
            &lt;/patelt&gt;
        &lt;/pattern&gt;
    &lt;/rejectfont&gt;
&lt;/selectfont&gt;
</pre>
<p>Typically when both elements are combined, <code>&lt;rejectfont&gt;</code> is first used on a more general matching glob to reject a large group (such as a whole directory), then <code>&lt;acceptfont&gt;</code> is used after it to whitelist individual fonts out of the larger blacklisted group.
</p>
<pre>
&lt;selectfont&gt;
    &lt;rejectfont&gt;
        &lt;glob&gt;/usr/share/fonts/OTF/*&lt;/glob&gt;
    &lt;/rejectfont&gt;
    &lt;acceptfont&gt;
        &lt;pattern&gt;
            &lt;patelt name="family" &gt;
                &lt;string&gt;Monaco&lt;/string&gt;
            &lt;/patelt&gt;
        &lt;/pattern&gt;
    &lt;/acceptfont&gt;
&lt;/selectfont&gt;
</pre>
<h3><span class="mw-headline" id="Disable_bitmap_fonts">Disable bitmap fonts</span></h3>
<p>Bitmap fonts are sometimes used as fallbacks for missing fonts, which may cause text to be rendered pixelated or too large. Use the <code>70-no-bitmaps.conf</code> <a href="#Presets">preset</a> to disable this behavior. 
</p>
<div id="EmbeddedBitmap">To disable embedded bitmap for all fonts:<div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/fontconfig/conf.d/20-no-embedded.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE fontconfig SYSTEM "fonts.dtd"&gt;
&lt;fontconfig&gt;
  &lt;match target="font"&gt;
    &lt;edit name="embeddedbitmap" mode="assign"&gt;
      &lt;bool&gt;false&lt;/bool&gt;
    &lt;/edit&gt;
  &lt;/match&gt;
&lt;/fontconfig&gt;
</pre>
<p>To disable embedded bitmap fonts for a specific font:
</p>
<pre>&lt;match target="font"&gt;
  &lt;test qual="any" name="family"&gt;
    &lt;string&gt;Monaco&lt;/string&gt;
  &lt;/test&gt;
  &lt;edit name="embeddedbitmap"&gt;&lt;bool&gt;false&lt;/bool&gt;&lt;/edit&gt;
&lt;/match&gt;
</pre>
<h3><span class="mw-headline" id="Disable_scaling_of_bitmap_fonts">Disable scaling of bitmap fonts</span></h3>
<p>To disable scaling of bitmap fonts (which often makes them blurry), remove <code>/etc/fonts/conf.d/10-scale-bitmap-fonts.conf</code>.
</p>
<h3><span class="mw-headline" id="Create_bold_and_italic_styles_for_incomplete_fonts">Create bold and italic styles for incomplete fonts</span></h3>
<p>FreeType has the ability to automatically create <i>italic</i> and <b>bold</b> styles for fonts that do not have them, but only if explicitly required by the application. Given programs rarely send these requests, this section covers manually forcing generation of missing styles.
</p>
<p>Start by editing <code>/usr/share/fonts/fonts.cache-1</code> as explained below. Store a copy of the modifications on another file, because a font update with <code>fc-cache</code> will overwrite <code>/usr/share/fonts/fonts.cache-1</code>.
</p>
<p>Assuming the Dupree font is installed:
</p>
<pre>"dupree.ttf" 0 "Dupree:style=Regular:slant=0:weight=80:width=100:foundry=unknown:index=0:outline=True:<i>etc...</i>
</pre>
<p>Duplicate the line, change <code>style=Regular</code> to <code>style=Bold</code> or any other style. Also change <code>slant=0</code> to <code>slant=100</code> for italic, <code>weight=80</code> to <code>weight=200</code> for bold, or combine them for <i><b>bold italic</b></i>:
</p>
<pre>"dupree.ttf" 0 "Dupree:style=Bold Italic:slant=100:weight=200:width=100:foundry=unknown:index=0:outline=True:<i>etc...</i>
</pre>
<p>Now add necessary modifications to <code>$XDG_CONFIG_HOME/fontconfig/fonts.conf</code>:
</p>
<pre>
...
&lt;match target="font"&gt;
    &lt;test name="family" qual="any"&gt;
        &lt;string&gt;Dupree&lt;/string&gt;
         &lt;!-- other fonts here .... --&gt;
     &lt;/test&gt;
     &lt;test name="weight" compare="more_eq"&gt;&lt;int&gt;140&lt;/int&gt;&lt;/test&gt;
     &lt;edit name="embolden" mode="assign"&gt;&lt;bool&gt;true&lt;/bool&gt;&lt;/edit&gt;
&lt;/match&gt;

&lt;match target="font"&gt;
    &lt;test name="family" qual="any"&gt;
        &lt;string&gt;Dupree&lt;/string&gt;
        &lt;!-- other fonts here .... --&gt;
    &lt;/test&gt;
    &lt;test name="slant" compare="more_eq"&gt;&lt;int&gt;80&lt;/int&gt;&lt;/test&gt;
    &lt;edit name="matrix" mode="assign"&gt;
        &lt;times&gt;
            &lt;name&gt;matrix&lt;/name&gt;
                &lt;matrix&gt;
                    &lt;double&gt;1&lt;/double&gt;&lt;double&gt;0.2&lt;/double&gt;
                    &lt;double&gt;0&lt;/double&gt;&lt;double&gt;1&lt;/double&gt;
                &lt;/matrix&gt;
        &lt;/times&gt;
    &lt;/edit&gt;
&lt;/match&gt;
...
</pre>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDFFDD; border: thin solid #BBDDBB; overflow: hidden;">
<strong> Tip: </strong> Use the value 'embolden' for existing bold fonts in order to make them even bolder.</div>
<h3><span class="mw-headline" id="Change_rule_overriding">Change rule overriding</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> <code>/etc/fonts/conf.d/50-user.conf</code> will be created again when <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=fontconfig">fontconfig</a></span> is updated (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Font_configuration">Talk:Font configuration#</a>)</div>
</div>
<p>Fontconfig processes files in <code>/etc/fonts/conf.d</code> in numerical order. This enables rules or files to override one another, but often confuses users about what file gets parsed last.
</p>
<p>To guarantee that personal settings take precedence over any other rules, change their ordering:
</p>
<pre># cd /etc/fonts/conf.d
# mv 50-user.conf 99-user.conf
</pre>
<p>This change seems however to be unnecessary for the most of the cases, because a user is given enough control by default to set up own font preferences, hinting and antialiasing properties, alias new fonts to generic font families, etc.
</p>
<h3><span class="mw-headline" id="Query_the_current_settings">Query the current settings</span></h3>
<p>To find out what settings are in effect, use <code>fc-match --verbose</code>. eg.
</p>
<pre>$ fc-match --verbose Sans
family: "DejaVu Sans"(s)
hintstyle: 3(i)(s)
hinting: True(s)
...
</pre>
<p>Look up the meaning of the numbers at <a rel="nofollow" class="external free" href="http://www.freedesktop.org/software/fontconfig/fontconfig-user.html">http://www.freedesktop.org/software/fontconfig/fontconfig-user.html</a>. Eg. 'hintstyle: 3' means 'hintfull'
</p>
<h2><span class="mw-headline" id="Applications_without_fontconfig_support">Applications without fontconfig support</span></h2>
<p>Some applications like <a href="../en/Rxvt-unicode.html" title="URxvt" class="mw-redirect">URxvt</a> will ignore fontconfig settings. You can work around this by using <code>~/.Xresources</code>, but it is as flexible as fontconfig. Example (see <a href="#Fontconfig_configuration">#Fontconfig configuration</a> for explanations of the options):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.Xresources</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
Xft.autohint: 0
Xft.lcdfilter: lcddefault
Xft.hintstyle: hintslight
Xft.hinting: 1
Xft.antialias: 1
Xft.rgba: rgb
</pre>
<p>Make sure the settings are loaded properly when X starts with <code>xrdb -q</code> (see <a href="../en/X_resources.html" title="Xresources" class="mw-redirect">Xresources</a> for more information).
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Distorted_fonts">Distorted fonts</span></h3>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>96 DPI is not a standard. You should use your monitor's actual DPI to get proper font rendering, especially when using subpixel rendering.</div>
<p>If fonts are still unexpectedly large or small, poorly proportioned or simply rendering poorly, fontconfig may be using the incorrect DPI.
</p>
<p>Fontconfig should be able to detect DPI parameters as discovered by the Xorg server. You can check the automatically discovered DPI with <code>xdpyinfo</code> (provided by the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=xorg-xdpyinfo">xorg-xdpyinfo</a></span> package):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ xdpyinfo | grep dots</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
  resolution:    102x102 dots per inch
</pre>
<p>If the DPI is detected incorrectly (usually due to an incorrect monitor <a href="https://en.wikipedia.org/wiki/Extended_Display_Identification_Data" class="extiw" title="wikipedia:Extended Display Identification Data">EDID</a>), you can specify it manually in the Xorg configuration, see <a href="../en/Xorg.html#Display_size_and_DPI" title="Xorg">Xorg#Display size and DPI</a>. This is the recommended solution, but it may not work with buggy drivers.
</p>
<p>Fontconfig will default to the Xft.dpi variable if it is set. Xft.dpi is usually set by desktop environments (usually to Xorg's DPI setting) or manually in <code>~/.Xdefaults</code> or <code>~/.Xresources</code>. Use xrdb to query for the value:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ xrdb -query | grep dpi</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
Xft.dpi:	102
</pre>
<p>Those still having problems can fall back to manually setting the DPI used by fontconfig:
</p>
<pre>...
&lt;match target="pattern"&gt;
   &lt;edit name="dpi" mode="assign"&gt;&lt;double&gt;102&lt;/double&gt;&lt;/edit&gt;
&lt;/match&gt;
...
</pre>
<h3><span class="mw-headline" id="Calibri.2C_Cambria.2C_Monaco.2C_etc._not_rendering_properly">Calibri, Cambria, Monaco, etc. not rendering properly</span></h3>
<p>Some scalable fonts have embedded bitmap versions which are rendered instead, mainly at smaller sizes. Using <a href="../en/Metric-compatible_fonts.html" title="Metric-compatible fonts">Metric-compatible fonts</a> as replacements can improve the rendering in these cases. 
</p>
<p>You can also force using scalable fonts at all sizes by <a href="#Disable_bitmap_fonts">disabling embedded bitmap</a>, sacrificing some rendering quality.
</p>
<h3><span class="mw-headline" id="Applications_overriding_hinting">Applications overriding hinting</span></h3>
<p>Some applications or desktop environments may override default fontconfig hinting and anti-aliasing settings. This may happen with <a href="../en/GNOME.html" title="GNOME">GNOME</a> 3, for example while you are using Qt applications like <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=vlc">vlc</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=smplayer">smplayer</a></span>. Use the specific configuration program for the application in such cases. For GNOME, try <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=gnome-tweak-tool">gnome-tweak-tool</a></span>.
</p>
<h3><span class="mw-headline" id="Applications_not_picking_up_hinting_from_DE.27s_settings">Applications not picking up hinting from DE's settings</span></h3>
<p>For instance, under GNOME it sometimes happens that Firefox applies full hinting even when it's set to "none" in GNOME's settings, which results in sharp and widened fonts. In this case you would have to add hinting settings to your <code>fonts.conf</code> file:
</p>
<pre>&lt;?xml version='1.0'?&gt;
&lt;!DOCTYPE fontconfig SYSTEM 'fonts.dtd'&gt;	
&lt;fontconfig&gt;
 &lt;match target="font"&gt;
  &lt;edit mode="assign" name="hinting"&gt;
   &lt;bool&gt;false&lt;/bool&gt;
  &lt;/edit&gt;
 &lt;/match&gt;
&lt;/fontconfig&gt;
</pre>
<p>In this example, hinting is set to "grayscale".
</p>
<h3><span class="mw-headline" id="Incorrect_hinting_in_GTK_applications_on_non-Gnome_systems">Incorrect hinting in GTK applications on non-Gnome systems</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Mentions GTK relies on fontconfig, then claims that "some" fonts get the hinting "wrong", and ends up refering to Xft (but see e.g <a rel="nofollow" class="external autonumber" href="http://doc.opensuse.org/documentation/html/openSUSE_113/opensuse-reference/cha.fontconfig.html#sec.fontconfig.xft">[1]</a>). IOW, unsupported claims and unclear relations (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Font_configuration">Talk:Font configuration#</a>)</div>
</div>
<a href="../en/GNOME.html" title="GNOME">GNOME</a> uses the XSETTINGS system to configure font rendering. Without gnome-settings-daemon, GTK applications rely on fontconfig, but some fonts get the hinting wrong causing them to look too bold or too light. 
<p>A simple solution is using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/xsettingsd-git/">xsettingsd-git</a></span><sup><small>AUR</small></sup> as a replacement for gnome-settings-daemon to provide the configuration, for example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.xsettingsd</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
Xft/Hinting 1
Xft/RGBA "rgb"
Xft/HintStyle "hintslight"
Xft/Antialias 1
</pre>
<p>Alternatively you could just write the font configuration as <code>Xft.*</code> directives in <code>~/.Xresources</code> without using a settings daemon.
</p>
<h3><span class="mw-headline" id="Font_problem_in_Generated_PDFs">Font problem in Generated PDFs</span></h3>
<p>If the following command
</p>
<pre>fc-match helvetica
</pre>
<p>produces
</p>
<pre>helvR12-ISO8859-1.pcf.gz: "Helvetica" "Regular"
</pre>
<p>then the bitmap font provided by <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=xorg-fonts-75dpi">xorg-fonts-75dpi</a></span> is likely to be embedded into PDFs generated by "Print to File" or "Export" in various applications. The bitmap font was probably installed as a consequence of installing the whole <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/groups/x86_64/xorg/">xorg</a></span> group (which is usually NOT recommended). To solve the pixelized font problem, you can uninstall the package. Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=gsfonts">gsfonts</a></span> (Type 1) or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=tex-gyre-fonts">tex-gyre-fonts</a></span> (OpenType) for corresponding free subsitute of Helvetica (and other PostScript/PDF base fonts).
</p>
<p>You may also experience similar problem when you open a PDF which requires Helvetica but does not have it embedded for viewing.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li> <a rel="nofollow" class="external text" href="http://www.freedesktop.org/software/fontconfig/fontconfig-user.html">Fontconfig Users' Guide</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://www.x.org/X11R6.8.2/doc/fonts.html">Fonts in X11R6.8.2</a> - Official Xorg font information</li>
<li> <a rel="nofollow" class="external text" href="http://freetype.sourceforge.net/freetype2/">FreeType 2 overview</a>
</li>
<li> <a rel="nofollow" class="external text" href="https://forums.gentoo.org/viewtopic-t-723341.html">Gentoo font-rendering thread</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://www.freetype.org/freetype2/docs/text-rendering-general.html">On slight hinting</a>
</li>
</ul>
</div>
</div>

</div>
<div id="catlinks" class="catlinks">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Fonts.html" title="Category:Fonts">Fonts</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li></ul>
</div>
</div>					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
Extracted from <a href="https://wiki.archlinux.org"> ArchWiki </a> and licensed under <a href="http://www.gnu.org/copyleft/fdl.html"> GDL >= 1.3</a>
		</div>
		</div>
		</body>
</html>
