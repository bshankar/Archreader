<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8">
<title>Small Business Server (Italiano)/Mail Server - ArchWiki</title>
<link rel="stylesheet" href="../../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style></style>
<meta name="generator" content="MediaWiki 1.26.4">
<meta name="robots" content="noindex,follow">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Small_Business_Server_Italiano_Mail_Server skin-archlinux action-view">

		<div id="globalWrapper" style="width: 100%">
		<div id="column-content">
			<div id="content" class="mw-body" role="main" style="margin: 2em; margin-bottom: 0">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Small Business Server (Italiano)/Mail Server</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="contentSub"><span class="subpages">&lt; <a href="../../it/Small_Business_Server.html" title="Small Business Server (Italiano)">Small Business Server (Italiano)</a></span></div>
										<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<p>Ad un <i>SBS</i> che si rispetti non può certo mancare un servizio di posta elettronica, anche considerando il fatto che ancor oggi è il servizio internet più usato. E noi da bravi andiamo a configurarne uno semplice ma abbastanza completo. Questa parte è abbastanza articolata, facciamo una piccola premessa ed installiamo il software necessario.
</p>
<div id="toc" class="toc">
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Premessa"><span class="tocnumber">1</span> <span class="toctext">Premessa</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Un_lavoro_di_squadra"><span class="tocnumber">1.1</span> <span class="toctext">Un lavoro di squadra</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3">
<a href="#Installazione"><span class="tocnumber">2</span> <span class="toctext">Installazione</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Postfix"><span class="tocnumber">2.1</span> <span class="toctext">Postfix</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Postgrey"><span class="tocnumber">2.2</span> <span class="toctext">Postgrey</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Clamav"><span class="tocnumber">2.3</span> <span class="toctext">Clamav</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Spamassassin"><span class="tocnumber">2.4</span> <span class="toctext">Spamassassin</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Amavis-new"><span class="tocnumber">2.5</span> <span class="toctext">Amavis-new</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Dovecot"><span class="tocnumber">2.6</span> <span class="toctext">Dovecot</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Il_giochino_delle_parti"><span class="tocnumber">3</span> <span class="toctext">Il giochino delle parti</span></a></li>
<li class="toclevel-1 tocsection-11">
<a href="#Configurazione_base"><span class="tocnumber">4</span> <span class="toctext">Configurazione base</span></a>
<ul>
<li class="toclevel-2 tocsection-12">
<a href="#Postfix_2"><span class="tocnumber">4.1</span> <span class="toctext">Postfix</span></a>
<ul>
<li class="toclevel-3 tocsection-13">
<a href="#Parametri_di_configurazione"><span class="tocnumber">4.1.1</span> <span class="toctext">Parametri di configurazione</span></a>
<ul>
<li class="toclevel-4 tocsection-14"><a href="#myhostname_e_mydomain"><span class="tocnumber">4.1.1.1</span> <span class="toctext">myhostname e mydomain</span></a></li>
<li class="toclevel-4 tocsection-15"><a href="#myorigin"><span class="tocnumber">4.1.1.2</span> <span class="toctext">myorigin</span></a></li>
<li class="toclevel-4 tocsection-16"><a href="#mydestination"><span class="tocnumber">4.1.1.3</span> <span class="toctext">mydestination</span></a></li>
<li class="toclevel-4 tocsection-17"><a href="#mynetworks"><span class="tocnumber">4.1.1.4</span> <span class="toctext">mynetworks</span></a></li>
<li class="toclevel-4 tocsection-18"><a href="#masquerade_domains"><span class="tocnumber">4.1.1.5</span> <span class="toctext">masquerade_domains</span></a></li>
<li class="toclevel-4 tocsection-19"><a href="#alias_maps_e_alias_database"><span class="tocnumber">4.1.1.6</span> <span class="toctext">alias_maps e alias_database</span></a></li>
<li class="toclevel-4 tocsection-20"><a href="#mailbox_size_limit"><span class="tocnumber">4.1.1.7</span> <span class="toctext">mailbox_size_limit</span></a></li>
<li class="toclevel-4 tocsection-21"><a href="#home_mailbox"><span class="tocnumber">4.1.1.8</span> <span class="toctext">home_mailbox</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-22"><a href="#Testare_Postfix"><span class="tocnumber">4.1.2</span> <span class="toctext">Testare Postfix</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#Aliases"><span class="tocnumber">4.1.3</span> <span class="toctext">Aliases</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#Avvio_del_servizio"><span class="tocnumber">4.1.4</span> <span class="toctext">Avvio del servizio</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-25">
<a href="#Dovecot_2"><span class="tocnumber">4.2</span> <span class="toctext">Dovecot</span></a>
<ul>
<li class="toclevel-3 tocsection-26"><a href="#Configurazione"><span class="tocnumber">4.2.1</span> <span class="toctext">Configurazione</span></a></li>
<li class="toclevel-3 tocsection-27"><a href="#Autenticazione"><span class="tocnumber">4.2.2</span> <span class="toctext">Autenticazione</span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#Avvio_del_servizio_2"><span class="tocnumber">4.2.3</span> <span class="toctext">Avvio del servizio</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-29">
<a href="#Shorewall"><span class="tocnumber">4.3</span> <span class="toctext">Shorewall</span></a>
<ul>
<li class="toclevel-3 tocsection-30"><a href="#Configurazione_2"><span class="tocnumber">4.3.1</span> <span class="toctext">Configurazione</span></a></li>
<li class="toclevel-3 tocsection-31"><a href="#La_regola_pi.C3.B9_importante"><span class="tocnumber">4.3.2</span> <span class="toctext">La regola più importante</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-32"><a href="#Tutto_qua_.3F"><span class="tocnumber">4.4</span> <span class="toctext">Tutto qua ?</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-33">
<a href="#Filtraggio_della_posta"><span class="tocnumber">5</span> <span class="toctext">Filtraggio della posta</span></a>
<ul>
<li class="toclevel-2 tocsection-34">
<a href="#Postfix_3"><span class="tocnumber">5.1</span> <span class="toctext">Postfix</span></a>
<ul>
<li class="toclevel-3 tocsection-35"><a href="#Restrizioni_nei_comandi_HELO_o_EHLO"><span class="tocnumber">5.1.1</span> <span class="toctext">Restrizioni nei comandi HELO o EHLO</span></a></li>
<li class="toclevel-3 tocsection-36"><a href="#Restrizioni_a_cui_sono_soggetti_i_server_remoti_per_i_comandi_inviati"><span class="tocnumber">5.1.2</span> <span class="toctext">Restrizioni a cui sono soggetti i server remoti per i comandi inviati</span></a></li>
<li class="toclevel-3 tocsection-37"><a href="#Restrizioni_sui_mittenti_delle_mail_che_il_server_riceve"><span class="tocnumber">5.1.3</span> <span class="toctext">Restrizioni sui mittenti delle mail che il server riceve</span></a></li>
<li class="toclevel-3 tocsection-38"><a href="#Restrizioni_nei_destinatari_finali_delle_mail_che_il_nostro_server_riceve"><span class="tocnumber">5.1.4</span> <span class="toctext">Restrizioni nei destinatari finali delle mail che il nostro server riceve</span></a></li>
<li class="toclevel-3 tocsection-39">
<a href="#Test_delle_restrizioni"><span class="tocnumber">5.1.5</span> <span class="toctext">Test delle restrizioni</span></a>
<ul>
<li class="toclevel-4 tocsection-40"><a href="#soft_bounce"><span class="tocnumber">5.1.5.1</span> <span class="toctext">soft_bounce</span></a></li>
<li class="toclevel-4 tocsection-41"><a href="#warn_if_reject"><span class="tocnumber">5.1.5.2</span> <span class="toctext">warn_if_reject</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-42">
<a href="#Postgrey_2"><span class="tocnumber">5.2</span> <span class="toctext">Postgrey</span></a>
<ul>
<li class="toclevel-3 tocsection-43"><a href="#Configurazione_3"><span class="tocnumber">5.2.1</span> <span class="toctext">Configurazione</span></a></li>
<li class="toclevel-3 tocsection-44"><a href="#Il_giochino_di_Postgrey"><span class="tocnumber">5.2.2</span> <span class="toctext">Il giochino di Postgrey</span></a></li>
<li class="toclevel-3 tocsection-45"><a href="#Controindicazioni_.3F"><span class="tocnumber">5.2.3</span> <span class="toctext">Controindicazioni ?</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-46">
<a href="#Amavis-new_2"><span class="tocnumber">5.3</span> <span class="toctext">Amavis-new</span></a>
<ul>
<li class="toclevel-3 tocsection-47"><a href="#Content_Filter_con_Amavis-new"><span class="tocnumber">5.3.1</span> <span class="toctext">Content Filter con Amavis-new</span></a></li>
<li class="toclevel-3 tocsection-48"><a href="#Un_caporale_con_due_soldati"><span class="tocnumber">5.3.2</span> <span class="toctext">Un caporale con due soldati</span></a></li>
<li class="toclevel-3 tocsection-49"><a href="#Postfix_4"><span class="tocnumber">5.3.3</span> <span class="toctext">Postfix</span></a></li>
<li class="toclevel-3 tocsection-50"><a href="#Amavis"><span class="tocnumber">5.3.4</span> <span class="toctext">Amavis</span></a></li>
<li class="toclevel-3 tocsection-51"><a href="#Clamav_2"><span class="tocnumber">5.3.5</span> <span class="toctext">Clamav</span></a></li>
<li class="toclevel-3 tocsection-52"><a href="#Avvio_dei_servizi"><span class="tocnumber">5.3.6</span> <span class="toctext">Avvio dei servizi</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-53"><a href="#Conclusioni"><span class="tocnumber">6</span> <span class="toctext">Conclusioni</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Premessa">Premessa</span></h1>
<p>Il <i>mail server</i> che andremo ad implementare è un mail server <i>ufficiale</i>. Questo significa che :
</p>
<ol>
<li> Il nostro ipotetico dominio <i>mede.it</i> deve essere pubblicamente registrato</li>
<li> L'interfaccia eth0 che si collega al mondo esterno deve avere un indirizzo ip <i>fisso</i>
</li>
<li> Il <i>maintainer</i> del nostro dominio, se gestisce anche il DNS "pubblico" di <i>mede.t</i>, deve avere un record MX che punta al nostro server per informare il mondo che il server di posta "ufficiale" di <i>mede.it</i> siamo noi.</li>
</ol>
<p>Se non disponiamo di un indirizzo ip fisso esiste anche una seconda possibilità. Possiamo configurare il server in modalità <i>relay</i>. Senza perderci in troppe ciance diciamo che in questa modalità il nostro server non contatta direttamente i server SMTP destinatari, ma "passa" la posta al nostro server "ufficiale" (che presumibilmente stà dal nostro provider) che si occuperà del resto. I messaggi di posta interna all'azienda (ad esempio antonio@mede.it che scrive a lucia@mede.it) non usciranno all'esterno ma verranno trattati completamente dal nostro server.  Il problema qui è che poi dobbiamo <i>andarci a prendere la posta in arrivo dal server del provider</i> se vogliamo distribuirla ai nostri utenti. Magari faremo un articoletto anche su questo.
</p>
<h2><span class="mw-headline" id="Un_lavoro_di_squadra">Un lavoro di squadra</span></h2>
<p>La complessità di questa parte non è tanto il server SMTP/POP3 in sè da implementare (cosa relativamente banale) ma il <i>ping pong</i> dei diversi servizi coinvolti in un moderno Mail Server. Purtroppo dobbiamo cercare di difenderci da <i>virus</i> e <i>spam</i> se vogliamo dare un servizio decente e far sopravvivere il nostro server per più di <i>qualche giorno</i> prima di venire <i>bannati</i> dagli altri.
Il nostro MTA non fà tutto da solo, bisogna mettere in scena un coretto a <i>6 voci</i>, dove 5 si passano la patata bollente l'un l'altro per convalidare una mail in arrivo. La 6° (dovecot) recapita la mail all'utente finale quando ne fà richiesta. 
Vediamo quali sono i nostri interpreti:
</p>
<ol>
<li>
<b>Postfix</b> : Il nostro MTA che implementa il server SMTP della nostra azienda</li>
<li>
<b>Postgrey</b> : Servizio che implementa il <i>greylisting</i>
</li>
<li>
<b>Clamav</b> : L'antivirus usato da amavis-new per scanarizzare le mail</li>
<li>
<b>Spamassassin</b> : Usato da amavis-new per individuare lo spam</li>
<li>
<b>Amavis-new</b> : Il <i>content filter</i> che analizza le mail con <i>Clamav</i> e <i>SpamAssassin</i>
</li>
<li>
<b>Dovecot</b> : IMAP e POP3 server per permettere ai nostri utenti di scaricare le mail dal server</li>
</ol>
<p>Un bel <i>coretto</i> non c'è che dire ...
</p>
<h1><span class="mw-headline" id="Installazione">Installazione</span></h1>
<p>Iniziamo con l'installazione dei servizi, poi andremo a configurarli uno ad uno.
</p>
<h2><span class="mw-headline" id="Postfix">Postfix</span></h2>
<pre>sudo pacman -S postfix
</pre>
<p>controlliamo ora che il file /etc/passwd contenga :
</p>
<pre>postfix:x:73:73::/var/spool/postfix:/bin/false
</pre>
<p>e che /etc/group contenga :
</p>
<pre>postdrop:x:75:
postfix:x:73:
</pre>
<h2><span class="mw-headline" id="Postgrey">Postgrey</span></h2>
<p>Postgrey non è presente nei repo standard, lo dobbiamo prelevare da AUR.
Prima installamo i moduli perl necessari :
</p>
<pre># pacman -S perl-net-server perl-berkeleydb perl-io-multiplex postgrey
</pre>
<h2><span class="mw-headline" id="Clamav">Clamav</span></h2>
<pre>sudo pacman -S clamav
</pre>
<h2><span class="mw-headline" id="Spamassassin">Spamassassin</span></h2>
<pre>sudo pacman -S spamassassin
</pre>
<h2><span class="mw-headline" id="Amavis-new">Amavis-new</span></h2>
<p>Nemmeno Amavis è nei repo. Per fortuna, ancora una volta, ci aiuta AUR. Assicuriamoci di avere i pacchetti "make" e "patch" installati :
</p>
<pre># pacman -S make patch
</pre>
<p>E procediamo ad installare Amavis con il pacchetto <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/amavisd-new/">amavisd-new</a></span><sup><small>AUR</small></sup>, operazione lunga perché richiede numerose librerie perl da installare.
</p>
<p><br>
Alla fine rientra in gioco il mio repository <i>radioattivo</i>.
</p>
<pre># pacman -S --force stenoweb/perl-file-temp
</pre>
<p>Amavis vuole "espressamente" la versione 0.19 di <i>perl-file-temp</i>. Noi siamo gentili e gliela forniamo.
</p>
<h2><span class="mw-headline" id="Dovecot">Dovecot</span></h2>
<pre>sudo pacman -S dovecot
</pre>
<h1><span class="mw-headline" id="Il_giochino_delle_parti">Il giochino delle parti</span></h1>
<p>Bene, ora il software necessario è installato. Come funzionarà il tutto ? E' un bel balletto, vediamolo a grandi linee.
Quando un messaggio arriva al nostro MTA succederà questo:
</p>
<ol>
<li> Postfix controlla che mittente e destinatario soddisfino le sue impostazioni di sicurezza. Se non le soddisfano Postfix respinge la mail, se le soddisfano passa la palla a Postgrey</li>
<li> Postgrey analizza il mittente e risponde a Postfix con un esito positivo o negativo</li>
<li> Se la risposta di Postgrey è negativa Postfix respinge la mail, se è positiva passa la palla ad Amavis</li>
<li> Amavis chiama Clamav per il controllo antivirus. Se Clamav trova un virus Amavis dà esito negativo a Postfix che respinge la mail, altrimenti, sempre Amavis, chiama Spamassassin per il controllo antispam.</li>
<li> Se Spamassassin giudica la mail come Spam, Amavis risponde con esito negativo a Postfix che respinge la mail.</li>
<li> Se Amavis dopo il controlli antivirus e antispam dà esito positivo, Postfix recapita la mail sulla mailbox dell'utente destinatario.</li>
</ol>
<p>Uff, un bel giro in giostra fà la nostra mail ! Tutto questo ha un costo in performance, ma per evitare il più possibile spazzatura o infezioni ne vale la pena...
IL termina "respinge" che ho usato è generico, in realtà la mail può venire anche archiviata e segnalata, oppure recapitata lo stesso all'utente finale con una avviso. Stà a noi decidere il comportamento che più ci soddisfa.
</p>
<h1><span class="mw-headline" id="Configurazione_base">Configurazione base</span></h1>
<h2><span class="mw-headline" id="Postfix_2">Postfix</span></h2>
<p>Iniziamo la configurazione del nostro Mail Server. Il primo tassello è senza dubbio <i>Postfix</i> il nostro (mio?) MTA preferito. Forse il fatto che ci sia IBM all'origine ha per me il suo peso ? Bando alle ciance e via con i lavori ...
</p>
<p><a rel="nofollow" class="external text" href="http://www.postfix.org">Postfix</a> è un popolare, scalabile e sicuro MTA scritto da Witse Venema mentre lavorava in IBM. Postfix era originariamente noto come VMailer ed è stato anche commercializzato da IBM come Secure Mailer. Nel 1999, il suo nome è diventato Postfix, e il resto è storia. 
In questa guida l'ho scelto perchè è affidabile, veloce e (relativamente) facile da gestire. 
Il suo file di configurazione è facile da leggere e modificare, anche se ovviamente è utile conoscere le diverse opzioni che è possibile impostare e tutti i loro valori possibili (o almeno i principali vista la mole degli stessi...). 
Sono stati scritti libri interi su Postfix, quindi inutile sottolineare che questo è solo un buon punto di partenza.
</p>
<h3><span class="mw-headline" id="Parametri_di_configurazione">Parametri di configurazione</span></h3>
<p>Abbiamo già installato Postfix, ora procediamo con la configurazione base che si ottiene modificando il file <i> /etc/postfix/main.cf </i>, iniziamo da qui :
</p>
<pre>sudo nano /etc/postfix/main.cf
</pre>
<p>con questi parametri :
</p>
<pre>queue_directory = /var/spool/postfix
command_directory = /usr/sbin
daemon_directory = /usr/lib/postfix
mail_owner = postfix
</pre>
<h4><span class="mw-headline" id="myhostname_e_mydomain">myhostname e mydomain</span></h4>
<p>Definiamo il nome host internet del nostro server, di default il primo è il valore ritornato da <i> gethostbyname() </i>, il secondo il nome del dominio :
</p>
<pre>myhostname = archi.mede.it
mydomain = mede.it
</pre>
<h4><span class="mw-headline" id="myorigin">myorigin</span></h4>
<p>Questo identifica i nomi di dominio da cui si assume che le mail locali arrivino e sono inviate. E' più difficile da spiegare che da scrivere :). Dal momento che noi non abbiamo bisogno di domini multipli, impostiamo questo parametro uguale a mydomain. 
</p>
<pre>myorigin = $mydomain
</pre>
<h4><span class="mw-headline" id="mydestination">mydestination</span></h4>
<p>La lista dei domini verso i quali le mail sono inviate localmente. Insomma, per queste destinazioni le mail vengono considerate locali e trasferite alle caselle di posta locali.
</p>
<pre>mydestination = $myhostname, localhost.$mydomain, localhost, $mydomain
</pre>
<h4><span class="mw-headline" id="mynetworks">mynetworks</span></h4>
<p>Questo identifica le reti (o gli specifici host), che invieranno posta da questo server. Di default Postfix riceve le mail da tutte le interfacce di rete installate, ma permette di inviare solo dalla interfaccia di loopback (127.0.0.1) che, nel nostro caso, non và ovviamente bene. Il valore del parametro mynetworks può essere un singolo host, un indirizzo IP e la maschera di rete per indicare un range di host o di una sottorete, o qualsiasi numero di host separati da virgola o indirizzo IP e associati netmasks. 
Questo parametro è molto importante, deve essere presente e deve contenere SOLO la rete o gli host autorizzati, altrimenti il vostro server si trasforma in un <a href="https://en.wikipedia.org/wiki/Open_relay" class="extiw" title="wikipedia:Open relay">open relay</a>, ovvero un server attraverso cui <i> chiunque </i> può inviare mail. Gli open relay sono il bersaglio preferito dagli spammers, e sono, per fortuna, una razza quasi estinta (gli OpenRelay, non gli Spammers ...).
Nel nostro caso il mail server permetterà alla rete interna 192.168.20.* di inviare mail attraverso di esso:
</p>
<pre>mynetworks = 127.0.0.0/8, 192.168.20.0/24
</pre>
<h4><span class="mw-headline" id="masquerade_domains">masquerade_domains</span></h4>
<p>Ora i nostri utenti di rete invieranno mail ma molti client di posta inviano la mail usando il <a href="https://en.wikipedia.org/wiki/Fully_qualified_domain_name" class="extiw" title="wikipedia:Fully qualified domain name">fully qualified domain name</a> dell'host da cui inviano la mail. Per capirci meglio: se il mio host si chiama <i>mybox</i> e il mio utente <i>steno</i> chi riceve le mail che spedisco vede il mittente nella forma <i> steno@mybox.mede.it</i> che non è esattamente quello che voglio. Probabilmente non ho nemmeno un utente in quell'host e non riusciranno a rispondere alle mie mail. Risolviamo questo problema con il parametro <i>masquerade_domains</i>. Postfix sostitusce la parte domain con quanto specificato qui.
</p>
<pre>masquerade_domains = mede.it
</pre>
<p>Ora tutti gli host della mia rete possono inviare mail attraverso Posfix senza che venga identificato il nome dello specifico host che ha originato la mail. Le mail inviate dal mio host di esempio avranno come mittente <i>steno@mede.it</i>.
</p>
<h4><span class="mw-headline" id="alias_maps_e_alias_database">alias_maps e alias_database</span></h4>
<p>Generalmente coincidono e indicano l'organizzazione e il nome del file contenenti gli alias locali: un elenco di equivalenze che permettono di attribuire più indirizzi a un unico utente
</p>
<pre>alias_maps = hash:/etc/postfix/aliases
alias_database = $alias_maps
</pre>
<h4><span class="mw-headline" id="mailbox_size_limit">mailbox_size_limit</span></h4>
<p>Massima dimensione delle mailbox. In questo caso 0 (zero) specifica nessun limite.
</p>
<pre>mailbox_size_limit = 0
</pre>
<h4><span class="mw-headline" id="home_mailbox">home_mailbox</span></h4>
<p>Specifica dove verrà salvata la posta dell'utente relativamente alla propria home. Se non specifico nulla viene usato il formato <i>mbox</i> e salvato un file con il nome utente in <i>/var/spool/mail</i>. Io preferisco il formato Maildir, e specificando il seguente parametro ogni mail ricevuta crea un file in <i>/home/nomeutente/Maildir</i>
</p>
<pre>home_mailbox = Maildir/
</pre>
<p>Maggiori informazioni le trovate sul sito di <a rel="nofollow" class="external text" href="http://www.postfix.org/postconf.5.html">postfix</a>.
</p>
<h3><span class="mw-headline" id="Testare_Postfix">Testare Postfix</span></h3>
<p>Avviamo postfix per fare un test se tutto funziona regolarmente :
</p>
<pre>sudo /etc/rc.d/postfix start
</pre>
<p>Installiamo <i>telnet</i> e colleghiamoci con sulla porta 25
</p>
<pre>sudo pacman -S netkit-telnet
telnet localhost 25
</pre>
<p>Dovrei ottenere la risposta:
</p>
<pre>Trying 127.0.0.1...
Connected to archi.
Escape character is '^]'.
220 archi.mede.it ESMTP Postfix
</pre>
<p>Ora iniziamo il colloquio :
</p>
<pre>helo 192.168.20.10
</pre>
<p>Postfix risponde:
</p>
<pre>250 archi.mede.it
</pre>
<p>Continuiamo a scrivere (dopo ogni riga premete invio) :
</p>
<pre>mail from:test@gmail.com
rcpt to: admin@mede.it
data
subject: Mail di prova
Salve, ti mando una mail di prova
.
</pre>
<p>Dopo il "." Postfix dovrebbe rispondermi con qualcosa di simile:
</p>
<pre>250 2.0.0 Ok: queued as 13BF410D898D
</pre>
<p>Il numerone <i>13BF410D898D</i> è un numero random che cambia ogni volta.
Ora digitando:
</p>
<pre>quit
</pre>
<p>Si esce. Se non avete ricevuto errori siete a posto. Magari guardiamo se <i>admin</i> ha ricevuto la mail, per ora ci accontentiamo di guardare il file con il nostro editor. Andiamo in /home/admin/Maildir/new e dovrei vedere un file di testo che posso editare e/o visualizzare. Ad esempio :
</p>
<pre>sudo nano /home/admin/Maildir/new/1198938050.V803I22110bM48209.archi
</pre>
<p>E' la mail che avete appena inviato ? :)
</p>
<h3><span class="mw-headline" id="Aliases">Aliases</span></h3>
<p>Abbiamo configurato postfix perchè usi il file /etc/postfix/aliases per gli alias, facciamo una piccola modifica al file perchè mandi le mail di sistema al nostro utente <i>admin</i> anzichè al predefinito (che abbiamo disabilitato) <i>root</i>.
</p>
<pre>sudo nano /etc/postfix/aliases
</pre>
<p>All'inizio del file dovrei vedere una cosa del genere (se non c'e' basta aggiungerla) :
</p>
<pre>#Person who should get root's mail. Don't receive mail as root!
#root:          you
</pre>
<p>Togliamo il commento dalla seconda riga a mettiamo <i>admin</i>:
</p>
<pre>root:          admin
</pre>
<p>Usciamo dall'editor e digitiamo:
</p>
<pre>newaliases
</pre>
<p>Ora le mail dirette a <i>root</i> verranno girate al nostro utente <i>admin</i>.
</p>
<h3><span class="mw-headline" id="Avvio_del_servizio">Avvio del servizio</span></h3>
<p>Come al solito includiamo postfix dell'array DAEMONS in /etc/rc.conf :
</p>
<pre>DAEMONS=(... ... ... ... ... postfix ... ... ...)
</pre>
<h2><span class="mw-headline" id="Dovecot_2">Dovecot</span></h2>
<p><i>Dovecot</i> è un <i>Mail Delivery Agent</i> progettato per garantire la sicurezza. Supporta la maggior parte dei formati di caselle di posta: a noi interessa particolarmente il formato <i>Maildir</i> dal momento che lo abbiamo adottato. Questa sezione espone come configurarlo come server <b>imap</b> e <b>pop3</b>.
</p>
<h3><span class="mw-headline" id="Configurazione">Configurazione</span></h3>
<p>Cominciamo con il copiarci il file di esempio di Dovecot che rappresenta un ottimo punto di partenza e apriamolo con il nostro editor:
</p>
<pre>sudo cp /etc/dovecot/dovecot-example.conf /etc/dovecot/dovecot.conf
sudo nano /etc/dovecot/dovecot.conf
</pre>
<p>Possiamo notare che il file è bello corposo o_O, noi impostamo solo quello che ci interessa lasciando il resto invariato.
Cominciamo con l'abilitare i protocolli <a rel="nofollow" class="external text" href="https://it.wikipedia.org/wiki/POP3">pop3</a> e <a rel="nofollow" class="external text" href="https://it.wikipedia.org/wiki/IMAP">imap</a>
</p>
<pre>protocols = imap pop3
</pre>
<p>e proseguiamo con il disabilitare l'autenticazione <i>ssl</i> e abilitare le <i>passwords</i> in chiaro. Ok, non è il massimo della vita, ma la messa in sicurezza del server ve lo lascio come compito a casa:
</p>
<pre>ssl_disable = yes
disable_plaintext_auth = no
</pre>
<p>conludiamo con il formato UIDL (Unique Mail Identifier) da usare. Impostiamo il predefinito consigliato che sembra non dare fastidio nemmeno a Outlook 2003 ;)
</p>
<pre>pop3_uidl_format = %08Xu%08Xv
</pre>
<h3><span class="mw-headline" id="Autenticazione">Autenticazione</span></h3>
<p>Al fine di ottenere il nostro agognato <i>Single Signon</i> vogliamo far sì che Dovecot autentichi gli utenti utilizzando la stessa coppia utente/password utilizzata da Samba. I nostri utenti utilizzeranno sempre lo stesso account sia per il File Server che per la posta.
Questo si può fare in modi diversi, qui utilizzeremo  <a rel="nofollow" class="external text" href="https://it.wikipedia.org/wiki/Pluggable_authentication_modules">PAM</a> che di "riflesso" utilizzerà LDAP per l'autenticazione. Apriamo (se lo abbiamo chiuso) il file di configurazione /etc/dovecot/dovecot.conf e aggiungiamo (o cerchiamo e modifichiamo, meglio) il seguente parametro :
</p>
<pre>passdb pam {
 args = blocking=yes dovecot
}
</pre>
<p>In questo modo abbiamo detto a <i>Dovecot</i> di utilizzare <i>PAM</i> con le "regole" impostate nel file /etc/pam.d/dovecot che andiamo immediatamente a creare:
</p>
<pre>sudo nano /etc/pam.d/dovecot
</pre>
<p>così:
</p>
<pre>#%PAM-1.0
auth            sufficient      pam_ldap.so
auth            required        pam_unix.so nullok
account         sufficient      pam_ldap.so
account         required        pam_unix.so
</pre>
<p>Ora Dovecot per autenticare un utente utilizzerà PAM il quale prima chiederà a LDAP e poi utilizzerà l'utente locale unix.
</p>
<h3><span class="mw-headline" id="Avvio_del_servizio_2">Avvio del servizio</span></h3>
<p>Non ci resta che avviare il servizio:
</p>
<pre>sudo /etc/rc.d/dovecot start
</pre>
<p>e metterlo nel nostro array DAEMONS in /etc/rc.conf per un avvio automatico:
</p>
<pre>DAEMONS=(... ... ... ... ... dovecot ... ... ...)
</pre>
<h2><span class="mw-headline" id="Shorewall">Shorewall</span></h2>
<p>Mai dimenticarsi del Firewall ! Dobbiamo permettere il traffico sulle porte utilizzate da Dovecot e anche <i>costringere</i> gli utenti della nostra rete ad utilizzare il nostro server per spedire, altrimenti ...
</p>
<h3><span class="mw-headline" id="Configurazione_2">Configurazione</span></h3>
<p>Editiamo il file :
</p>
<pre>sudo nano /etc/shorewall/rules
</pre>
<p>e aggiungiamo le nuove regole:
</p>
<pre>POP3/ACCEPT      loc             $FW
IMAP/ACCEPT      loc             $FW
</pre>
<p>se vogliamo scaricare la posta anche quando siamo fuori dall'azienda dobbiamo anche abilitare l'accesso dall'esterno:
</p>
<pre>POP3/ACCEPT      net             $FW
IMAP/ACCEPT      net             $FW
</pre>
<h3><span class="mw-headline" id="La_regola_pi.C3.B9_importante">La regola più importante</span></h3>
<p>Stiamo filtrando tutta la posta per proteggere i nostri utenti da SPAM e Virus, ma anche per evitare di essere <i>bannati</i> dagli altri server di posta perchè <i>non "virtuosi"</i>, nel senso che ok, respingiamo le mail che arrivano, ma dobbiamo anche evitare di spedirla la spazzatura.
Se gli utenti della nostra rete utilizzano il nostro server per spedire siamo a posto, Amavis (come vedremo dopo) farà già il suo lavoro, ma se un nostro utente <i>buontempone</i> (o un utente "esterno" nostro ospite) ha il suo bel account su GMail o su Yahoo o qualunque altro, e usa l'SMTP di questo Provider per spedire la posta ? Magari aggiungiamo che si è beccato un virus con il Notebook mentre navigava da casa che lo ha trasformato in un <i>zombie</i> alla mercè degli Spammers e abbiamo fatto la frittata: appena accende il computer collegato alla nostra rete aziendale, ZAC! inizia a spedire tonnellate di SPAM <i>attraverso</i> il suo provider il quale cosa vedrà come mittente della montagna di spazzatura che stà arrivando ? MA NATURALMENTE IL NOSTRO INCOLPEVOLE SERVER che stà "nattando" la rete con un unico indirizzo IP. Risultato ? 10 minuti e siamo bannati. Garantito.
</p>
<p>Come evitare questo disastro ? Con questa regola da applicare sempre su /etc/shorewall/rules :
</p>
<pre>REDIRECT        loc             smtp            tcp     smtp    - !85.85.85.85,192.168.20.1
</pre>
<p>Dove "85.85.85.85" è l'indirizzo IP inventato (voi mettete quello vero!) pubblico del nostro server. In questo modo chiunque cerchi di "passare" attraverso il nostro server (ad eccezione di chi ci punta correttamente) utilizzando il protocollo SMTP della posta viene "girato" localmente sul server. Il nostro server <i>filtra</i> così il messaggio e, se passa i nostri canonici controlli, viene spedito da lui stesso. Non facciamoci scavalcare ! :D
</p>
<p>Bene. Ora non ci resta che riavviare il firewall:
</p>
<pre>sudo shorewall restart
</pre>
<h2><span class="mw-headline" id="Tutto_qua_.3F">Tutto qua ?</span></h2>
<p>Ora il nostro server può inviare mail dalla nostra rete. Tutto qua ? Eh eh, magari. Diciamo che già funziona, e in un mondo perfetto di sole persone oneste potremmo fermarci qua. 
Peccato non sia così e che dobbiamo difenderci dai rompic...  che popolano la rete e che vogliono magari venderci pillole blu anche a Natale...
</p>
<p>Meglio rimboccarci le maniche e vedere come possiamo almeno rendere loro la vita un po' più difficile.
</p>
<h1><span class="mw-headline" id="Filtraggio_della_posta">Filtraggio della posta</span></h1>
<p>Siamo felici perchè abbiamo un mail server funzionante e stiamo ricevendo mail dal mondo. Putroppo in breve tempo una quantità incredibile della posta che riceviamo sarà inevitabilmente spazzatura non richiesta: <i>Spam</i>. Qualche mail conterrà pure <i>virus</i> e <i>malware</i>, e magari come mittente c'e' pure un vostro ignaro amico. Lo Spam e la posta infetta da virus sono una <i>autentica epidemia</i>. <b>Un server di posta non protetto ha breve vita</b>, presto saremo <i>bannati</i> come “cattivi” dalle liste pubbliche e non riusciremo più nemmeno ad inviare posta perchè respinti dagli altri server. Insomma, un disastro. Avendo un server personale per la posta è <i>nostro compito</i>, dunque, proteggerlo e vedremo qui come farlo.
</p>
<p>Fortunatamente gli strumenti per combattere e limitare (non sconfiggere, badate bene) questo problema non mancano, come già detto prima configureremo Postfix per un primo livello di controllo della posta, installeremo <i>Postgrey</i> che implementa il <i>graylisting</i>, <i>Amavis-new</i> che esplora le vostre mail e invoca altri pacchetti quali <i>Spamassassin</i> per proteggere il vostro server dallo spam e <i>ClamAV</i> per la scansione antivirus. Abbiamo visto come addirittura il nostro <i>Shorewall</i> ci dà una mano con una importante regola.
Quello che dobbiamo fare è integrarli insieme. 
</p>
<p>Piccola nota: forse qualcuno si domanderà perché mai debba proteggere Linux dai virus. Il motivo è semplice: nella nostra rete interna la maggior parte dei computer avrà sicuramente una qualche versione di Windows a bordo che è il bersaglio preferito dei virus e malware. Quindi meglio prevenire che curare cercando di far arrivare meno spazzatura possibile a questi umili e indifesi client :).
</p>
<p>Iniziamo con Postfix.
</p>
<h2><span class="mw-headline" id="Postfix_3">Postfix</span></h2>
<p>Il nostro MTA già di suo ci permette di limitare lo spam e di proteggere il nostro server. Editiamo il nostro file di configurazione:
</p>
<pre>sudo nano /etc/postfix/main.cf
</pre>
<p>Postfix generalmente scrive nel log il motivo di rifiuto di una mail, e settando <i>smtpd_delay_reject = yes</i>, mostra il mittente e la stringa HELO che ha causato il rifiuto. Andiamo in fondo al file e aggiungiamo :
</p>
<pre>smtpd_delay_reject = yes
</pre>
<p>Rifiutamo anche tutte le mail dai server che non identificano correttamente se stessi usando il comando HELO (o EHLO) come richiesto dallo standard SMTP RFC. Aggiungiamo :
</p>
<pre>smtpd_helo_required = yes
</pre>
<p>Ora impostiamo una serie di <i>restrizioni</i> da applicare. A chi non supera queste... <i>"bye bye"</i> prima ancora di entrare. 
</p>
<h3><span class="mw-headline" id="Restrizioni_nei_comandi_HELO_o_EHLO">Restrizioni nei comandi HELO o EHLO</span></h3>
<p>Sono usati dal mail server remoto per identificare se stesso. Le restrizioni sono analizzate in cascata una alla volta.
</p>
<ul>
<li> <i>permit_mynetworks</i>: accetta le connessioni da qualsiasi mail server listato nel parametro <i>mynetworks</i> di main.cf</li>
<li> <i>reject_invalid_hostname</i>: rifiuta connessioni da tutti i server che non identificano se stessi usando un nome host corretto (fully qualified hostname)</li>
<li> <i>permit</i>: alla fine accetta le connessioni dai server che hanno passato i controlli precedenti.</li>
</ul>
<pre>smtpd_helo_restrictions =
        permit_mynetworks,
        reject_invalid_hostname,
        reject_non_fqdn_hostname,
        permit
</pre>
<h3><span class="mw-headline" id="Restrizioni_a_cui_sono_soggetti_i_server_remoti_per_i_comandi_inviati">Restrizioni a cui sono soggetti i server remoti per i comandi inviati</span></h3>
<ul>
<li> <i>reject_unauth_pipelining</i> : impone al nostro server di rifiutare le connessioni dai server che inviano troppo velocemente i comandi. Molti spammers fanno questo per tentare di velocizzare la fase di invio mail spazzatura.</li>
<li> <i>permit</i> : come sopra, accetta le connessioni se le precedenti restrizioni sono ok.</li>
</ul>
<pre>smtpd_data_restrictions =
        reject_unauth_pipelining,
        permit
</pre>
<h3><span class="mw-headline" id="Restrizioni_sui_mittenti_delle_mail_che_il_server_riceve">Restrizioni sui mittenti delle mail che il server riceve</span></h3>
<p>Viene usato il comando <i>SMTP MAIL FROM</i> per identificarli :
</p>
<ul>
<li> <i>permit_mynetworks</i> : vedi sopra</li>
<li> <i>reject_non_fqdn_sender</i> : rifiuta le mail da tutti i mittenti il cui nome non è specificato in modo esteso (sempre secondo quanto stabilisce il famoso "fully qualified host name"). Nota che gli host della nostra rete avranno probabilmente un nome host corto ma in questo caso sono già garantiti dalla regola precedente.</li>
<li> <i>reject_unknown_sender_domain</i> : rifiuta le mail che provengono da domini sconosciuti</li>
<li> <i>permit</i> : vedi sopra </li>
</ul>
<pre>smtpd_sender_restrictions =
        permit_mynetworks,
        reject_non_fqdn_sender,
        reject_unknown_sender_domain,
        permit
</pre>
<h3><span class="mw-headline" id="Restrizioni_nei_destinatari_finali_delle_mail_che_il_nostro_server_riceve">Restrizioni nei destinatari finali delle mail che il nostro server riceve</span></h3>
<p>Sono identificati usando il comando <i>SMTP RCPT TO</i> :
</p>
<ul>
<li> <i>reject_unverified_recipient</i> : rifiuta a priori una mail verso un utente sconosciuto. Tuttavia ho notato che se il server destinatario implementa Postgrey questo parametro, di fatto, ci impedisce di mandargli mail a causa del rifiuto di validare l'utente imposto dal funzionamento stesso di Postgrey. Occhio ai log, ed eventualmente disabilitare la restrizione. </li>
<li> <i>permit_mynetworks</i> : vedi sopra</li>
<li> <i>reject_unknown_recipient_domain</i> : rifiuta le mail quando il nostro mail server non è la destinazione finale e la destinazione non è un dominio valido</li>
<li> <i>reject_unauth_destination</i> : rifiuta le mail quando il dominio destinazione non è fra quelli serviti dal nostro server (definiti dal parametro mynetworks) oppure non è fra i domini definiti in relayhost. Questo impedisce che il nostro server venga utilizzato come open relay.</li>
<li> <i>check_policy_service</i> : fa in modo che postfix usi un servizio esterno per controlli aggiuntivi. Nel nostro caso <b>inet:127.0.0.1:10030</b> passa la palla a <i>Postgrey</i> per implementare le gray list. Lo vedremo più avanti.</li>
<li> <i>permit</i> : vedi sopra.</li>
</ul>
<pre>smtpd_recipient_restrictions =
        reject_unverified_recipient,
        permit_mynetworks,
        reject_unknown_recipient_domain,
        reject_unauth_destination,
        check_policy_service inet:127.0.0.1:10030
        permit
</pre>
<p>Bene, a questo punto il nostro server Postfix già respingerà autonomamente una parte delle mail non desiderate. Un'altra cosa che si potrebbe implementare è un check se il mittente è presente nelle liste pubbliche di spammer riconosciuti. Tuttavia secondo me gli svantaggi sono maggiori dei vantaggi: rallenta troppo il sistema e, peggio ancora, spesso le liste non sono precise. Con Postgrey nel fodero io preferisco non implementarlo. 
</p>
<h3><span class="mw-headline" id="Test_delle_restrizioni">Test delle restrizioni</span></h3>
<p>Postfix fornisce <i>vagonate</i> di parametri, a volte è utile testare una restrizione prima di buttare alle ortiche delle mail. Vi segnalo un paio di parametri utili allo scopo.
</p>
<h4><span class="mw-headline" id="soft_bounce">soft_bounce</span></h4>
<p>Aggiungiamolo con il comando postconf (ma naturalmente potremmo anche editare il file <b>/etc/postfix/main.cf</b>, è lo stesso) e riavviamo postfix:
</p>
<pre>sudo postconf -e "soft_bounce = yes"
sudo /etc/rc.d/postfix restart
</pre>
<p><i>N.B.: In alternativa al "restart" del servizio posso usare il comando postfix per rileggere la configurazione senza killare il processo, basta digitare : <b>sudo postfix reload</b> e le nuove impostazioni saranno operative.</i>
</p>
<p>Quando impostato a <b>yes</b>, le <i>hard reject responses</i> (5xx) sono convertite in <i>soft reject responses</i> (4xx). In questo modo il server mittente, dopo un intervallo di tempo, opera un nuovo tentativo. 
Impostare questo parametro significa, in pratica, poter controllare il file di log e vedere cosa il vostro server rifiuta dandovi il tempo, se necessario, di aggiustare la configurazione in attesa del nuovo tentativo.
Una volta trovata la configurazione ottimale disabilitare soft_bounce e ricaricare postfix.
</p>
<h4><span class="mw-headline" id="warn_if_reject">warn_if_reject</span></h4>
<p>Facendo precedere questo parametro alle altre direttive si fà in modo che postfix anzichè rifiutare la mail segnali un <b>warning</b> nel log.
Se non si è sicuri di quali effetti possa avere una nuova restrizione, questo parametro, dunque, permette di controllare prima e poi eventualmente impostare la restrizione come effettiva.
</p>
<p>Ad esempio :
</p>
<pre>smtpd_recipient_restrictions =
        reject_unverified_recipient,
        permit_mynetworks,
        warn_if_reject reject_invalid_hostname,
        reject_unknown_recipient_domain,
        reject_unauth_destination,
        check_policy_service inet:127.0.0.1:10030
        permit
</pre>
<p>Notate il <i>warn_if_reject</i> che precede la mia regola <i>reject_invalid_hostname</i>: se un client, dunque, usa un nome host HELO invalido quando ci invia un messaggio, rientra nella mia restrizione, ma con questo parametro impostato Postfix scrive nel log un <b>warning</b> e accetta la mail lo stesso.
</p>
<p>Riavviamo Postfix e controlliamo non ci siano errori:
</p>
<pre>sudo /etc/rc.d/postfix restart
</pre>
<p>Ottimo! Il primo passo è stato compiuto, solo server <i>apparentemente</i> ufficiali ci possono inviare mail.
</p>
<h2><span class="mw-headline" id="Postgrey_2">Postgrey</span></h2>
<p>Precedentemente in Postfix abbiamo impostato la direttiva <i>check_policy_service</i> per utilizzare un anche un servizio esterno per le restrizioni. In questo caso vogliamo usare <i>Postgrey</i> che implementa il graylisting. Cos'e' il graylisting ? Molti avranno sicuramente sentito parlare di <i>whitelist</i> (la lista dei buoni) e <i>blacklist</i> (la lista dei cattivi). Con Postgrey si implementa un livello intermedio tra i due, detto appunto <i>greylist</i> (che fantasia :)).
</p>
<p>Questo sistema sfrutta un concetto molto semplice: visto l'elevato numero di mail che gli spammers inviano, raramente tentano più di una volta l'invio della posta ad un destinatario. 
Con Postgrey il vostro server sfrutta questo fatto respingendo temporaneamente tutte le email provenienti da mittenti sconosciuti segnalando loro che la casella di posta del destinatario non è momentaneamente disponibile e mettendosi in ascolto per il secondo tentativo che un server "ufficiale" fà sempre.
</p>
<p>Semplice, efficace ed ingegnoso, non servono filtri bayesiani o altre diavolerie e, ve lo garantisco, per il momento questo sistema <i>spazza via da solo oltre il 95% dello spam !</i>.
</p>
<p>Più sotto vedremo in dettaglio il funzionamento.
</p>
<h3><span class="mw-headline" id="Configurazione_3">Configurazione</span></h3>
<p>La configurazione base di Postgrey è molto semplice. Anzi, praticamente nulla. Nelle <i>smtpd_recipient_restrictions</i> di Postfix abbiamo già impostato:
</p>
<pre>check_policy_service inet:127.0.0.1:10030
</pre>
<p>E siamo già a posto, possiamo avviare il servizio per metterlo in funzione
</p>
<pre>sudo /etc/rc.d/postgrey start
</pre>
<p>e inserirlo nell'array di avvio in <i>/etc/rc.conf</i>  prima (anche se forse non è importante l'ordine) di postfix :
</p>
<pre>DAEMONS=(... ... ... ... ... postgrey postfix ... ... ...)
</pre>
<p>Ulteriori configurazioni per Postgrey possono essere fatte editando il file dei default del servizio postgrey
</p>
<pre>sudo nano /etc/conf.d/postgrey
</pre>
<p>di particolare interesse possono essere i due parametri :
</p>
<ul>
<li> <i>--delay</i> : definisce per quanti secondi in messaggio viene messo in graylist. Di default 300 secondi.</li>
<li> <i>--max-age</i> : definisce per quanti giorni un mittente che ha già in passato superato la verifica rimane nella whitelist generata da postgrey. Finchè sono qui verranno in futuro accettati senza verifica. Di default 30 giorni.</li>
</ul>
<p>Per variare questi parametri bisogna metterli nella variabile POSTGREY_OPTS, e riavviare il servizio.
Ad esempio, per portare il <i>delay</i> a 180 secondi e il <i>max age</i> a 60 giorni :
</p>
<pre>POSTGREY_OPTS="--delay=180 --max-age=60"
</pre>
<p>Postgrey memorizza i suoi dati in formato Berkley DB nella cartella :
</p>
<pre>/var/spool/postfix/postgrey
</pre>
<p>Putroppo pare non ci siano comandi per gestire il database o per visualizzare la greylist. Se qualcuno vuole smentirmi è bene accetto.
</p>
<p>Possiamo personalizzare le whilelist editando il file dove vengono identificati i domini da non filtrare con greylist : 
</p>
<pre>sudo nano /etc/postfix/postgrey_whitelist_clients
</pre>
<p>Oppure i destinatari da non filtrare :
</p>
<pre>/etc/postfix/postgrey_whitelist_recipients
</pre>
<h3><span class="mw-headline" id="Il_giochino_di_Postgrey">Il giochino di Postgrey</span></h3>
<p>Con la configurazione di default vediamo a grandi linee cosa succede quando a Postgrey viene chiesta la verifica di una mail da un utente fino ad ora sconosciuto :
</p>
<ol>
<li> Postgrey rifiuta la mail e Postfix comunica che la mailbox dell'utente non è al momento disponibile</li>
<li> Postgrey memorizza la terna indirizzo IP dell'host sorgente, email del mittente, email del destinatario nella greylist</li>
<li> Al successivo tentativo del server mittente se non è trascorso il tempo di <i>delay</i> (300 secondi), postgrey continua a rifiutare la mail. Questo per evitare i rinvii troppo veloci operati dagli spammers.</li>
<li> Se al successivo reinvio il tempo di <i>delay</i> è trascorso postgrey accetta la mail e memorizza la terna indirizzo IP dell'host sorgente, email del mittente, email del destinatario nella sua <i>whitelist</i> per <i>max age</i> tempo (30 giorni)</li>
</ol>
<p>Come vediamo la <i>"terna"</i> rimane nella white list di default per 30 giorni, in questo modo chi ci invia regolarmente email non viene più " ritardato" da postgrey ma accettato subito.
</p>
<h3><span class="mw-headline" id="Controindicazioni_.3F">Controindicazioni ?</span></h3>
<p>Bhe, a parte un ritardo di 5 minuti la prima volta che qualcuno ci scrive sinceramente non ne vedo. Ok, il sistema si appesantisce perchè ogni nuovo messaggio deve essere inviato due volte, ma credetemi che i benefici sono enormi. Ho un semplice caso in cui con Postgrey i messaggi di spam sono passati da circa 8.000 al giorno a qualche decina.
</p>
<p>Godiamoci il <i>greylisting</i> finchè funziona, temo che se verrà implementato su larga scala (credo che i grossi provider con alto volume di traffico difficilmente lo faranno) gli spammers cominceranno ad uscire con delle contromisure...
</p>
<p>Una guerra infinita.
</p>
<h2><span class="mw-headline" id="Amavis-new_2">Amavis-new</span></h2>
<p>Abbiamo finito con le protezioni ? Neanche per sogno! Dobbiamo ancora gestire/segare il 5% dello spam che sfugge a PostFix+Postgrey, ma sopratutto dobbiamo aiutare i nostri poveri client windows nella loro titanica lotta a spyware e virus...
Configuriamo il sistema per utilizzare <i>amavis-new</i>, occhio al file di configurazione dello stesso: <b>UN VERO INCUBO</b>, quindi non addormentatevi sulla tastiera e magari salvate l'originale che se sbagliate qualche virgoletta o altro non funziona più un tubo ... O_o.  Iniziermo con la parte <i>Postfix</i> e con qualla <i>Spamassassin</i>, per conludere, poi, con quella relativa a <i>Clamav</i>
</p>
<h3><span class="mw-headline" id="Content_Filter_con_Amavis-new">Content Filter con Amavis-new</span></h3>
<p>Per questa configurazione sono state scelte delle applicazioni note per il buon livello di sicurezza che offrono e per la facilità con la quale possono essere modificati i propri file di configurazione. Come oramai abbiamo capito, per impostazione predefinita Postfix si mette in ascolto sulla porta 25 per la posta in ingresso. Quando arriva un nuovo messaggio di posta, dopo i suoi canonici controlli restrittivi (compreso Postgrey) il server lo inoltra' ad <i>amavisd-new</i> sulla porta 10024. Amavisd-new, successivamente, controlla il messaggio attraverso vari filtri e lo restituisce a Postfix sulla porta 10025; infine, il messaggio viene inviato alla mailbox del destinatario.
Complicato vero ? Più da scrivere che da fare :)
</p>
<h3><span class="mw-headline" id="Un_caporale_con_due_soldati">Un caporale con due soldati</span></h3>
<p>Cos'e' <i>Amavis-new</i> ? <b>Amavisd-new</b> è un framework per il filtraggio di contenuti che utilizza applicazioni di supporto per il riconoscimento di virus e spam. Il nostro <i>caporale filtratore</i> utilizzerà due <i>soldati</i> per la sua campagna d'armi: <a rel="nofollow" class="external text" href="http://www.clamav.net/">ClamAV</a> per il filtraggio dei virus e <a rel="nofollow" class="external text" href="http://spamassassin.apache.org/">Spamassassin</a> per quello dello spam. Spamassassin, a sua volta, può poggiarsi su applicazioni di livello inferiore, come ad esempio <a rel="nofollow" class="external text" href="http://razor.sourceforge.net/">Vipul's Razor</a> e <a rel="nofollow" class="external text" href="http://www.rhyolite.com/anti-spam/dcc/">DCC</a> (non trattati in questa guida). 
Rispetto ad altre tecnologie di controllo dello spam (come gli <i>RBL</i>, dall'inglese <i>Real-time Blackhole List</i>, termine con il quale si indicano impropriamente le tecnologie <i>DNSBL</i>, o di <i>DNS blacklist</i>, che consistono nella pubblicazione, da parte di un sito Internet, di una lista di indirizzi IP che, per varie ragioni, ma principalmente spam, dovrebbero essere bloccati), Spamassassin non valida un dato messaggio email in base ad un singolo test. Questo programma, invece, esegue una lista di controlli, sia interni, sia usando delle applicazioni esterne, per calcolare un punteggio da assegnare ad ogni messaggio di posta. Questo punteggio è determinato in base a: 
</p>
<ul>
<li> <a rel="nofollow" class="external text" href="https://it.wikipedia.org/wiki/Filtro_bayesiano">Filtro Bayesiano</a>
</li>
<li> Regole statiche basate su espressioni regolari</li>
<li> Reti distribuite e collaborative (RBL, Razor, Pyzor, DCC)</li>
</ul>
<p>In base al punteggio (configurabile) raggiunto, la mail sarà rifiutata o accettata.
</p>
<p>Quando al caporal Amavisd viene segnalato che la mail contiene virus o spam può fare le seguenti cose:
</p>
<ul>
<li> '<b>PASS'</b> : Il destinatario riceve la mail</li>
<li> '<b>DISCARD'</b>: Il destinatario non riceve la mail. Il mittente non riceve alcuna notifica del fallimento della spedizione, il messaggio viene posto in quarantena se abbiamo deciso di abilitare questa funzionalità:</li>
<li> '<b>BOUNCE'</b>: Il destinatario non riceve la mail. Il mittente riceve una notifica che la spedizione è fallita. Nessuna notifica, però, viene inviata se la mail contiene un virus e il mittente viene identificato come "fake", falso.</li>
<li> '<b>REJECT'</b>: Il destinatario non riceve la mail. Il mittente dovrebbe ricevere una notifica che la spedizione è fallita dal nostro MTA (Postfix).</li>
</ul>
<p>La differenza sostanziale tra BOUNCE e REJECT è su chi prepara questa DSN (Delivery Status Notification). con REJECT è il nostro MTA (Postfix) che la prepara e la spedisce, con BOUNCE è Amavis che lo fà (generalmente questa contiene maggiori informazioni). Tuttavia Postfix non supporta la funzionalità REJECT, quindi per noi i parametri validi sono PASS, DISCARD e BOUNCE.
</p>
<p>In Amavis, queste opzioni di chiamano <b>D_PASS</b>, <b>D_DISCARD</b> e <b>D_BOUNCE</b> e sono configurate con i parametri nel file <b>/etc/amavisd/amavisd.conf</b> :
</p>
<ul>
<li> <b>$final_spam_destiny</b>
</li>
<li> <b>$final_virus_destiny</b>
</li>
<li> <b>$final_banned_destiny</b>
</li>
<li> <b>$final_bad_header_destiny</b>
</li>
</ul>
<p>Nella nostra configurazione imposteremo amavis in modo che spam e virus siano cestinati (D_DISCARD), e siccome non disabiliteremo la quarantena, le mail spazzatura finiranno lì. Se volessimo disabilitare la quarantena le mail sarebbero buttate e perse.
</p>
<p>Ancora qualche appunto sulla quarantena. Amavis può porre le mail in quarantena quando trova spam/virus in una specifica directory oppure può inviarla ad un altro inidirizzo email perchè venga "spulciata" da un operatore umano che deciderà il destino della "presunta" spazzatura. Quindi, in pratica, potremmo ad esempio indirizzare tutta lo spam a spam@mede.it e i virus a virus@mede.it, oppure in alternativa salvarla il una directory del nostro server. Amavis permette di specificare la directory per la quarantena con il parametro <b>$QUARANTINEDIR</b>. Tuttavia è possibile scegliere cartelle diverse per lo spam e per i virus.
</p>
<h3><span class="mw-headline" id="Postfix_4">Postfix</span></h3>
<p>Sì, cavolo, ancora Postfix. Dobbiamo modificare il file dove vengono definiti i suoi <i>servizi</i> aggiungendone uno per <i>amavis</i> e configurarlo affinché ne faccia uso.
Modifichiamo il file <b>master.cf</b> (occhio, non <i>main.cf</i>), dove, appunto, sono specificate le impostazioni dei servizi di postfix:
</p>
<pre>sudo nano /etc/postfix/master.cf
</pre>
<p>e aggiungiamo in fondo :
</p>
<pre>## AMAVIS
##
amavis    unix    -    -    -    -    2    smtp
     -o smtp_data_done_timeout=1200
     -o smtp_send_xforward_command=yes
     -o disable_dns_lookups=yes 
127.0.0.1:10025    inet    n    -    -    -    -    smtpd
     -o content_filter=
     -o smtpd_restriction_classes=
     -o smtpd_delay_reject=no
     -o smtpd_client_restrictions=permit_mynetworks,reject
     -o smtpd_helo_restrictions=
     -o smtpd_sender_restrictions=
     -o smtpd_recipient_restrictions=permit_mynetworks,reject
     -o smtpd_data_restrictions=reject_unauth_pipelining
     -o smtpd_end_of_data_restrictions=
     -o mynetworks=127.0.0.0/8
     -o smtpd_error_sleep_time=0
     -o smtpd_soft_error_limit=1001
     -o smtpd_hard_error_limit=1000
     -o smtpd_client_connection_count_limit=0
     -o smtpd_client_connection_rate_limit=0
     -o smtpd_milters=
     -o local_header_rewrite_clients=
     -o local_recipient_maps=
     -o relay_recipient_maps=
     -o receive_override_options=no_header_body_checks,no_unknown_recipient_checks
</pre>
<p>I parametri sono <i>una marea</i> prendeteli per buoni, oppure (meglio) googolate alla ricerca di una spiegazione. Due cose però le scrivo. Cosa diavolo abbiamo fatto ? Semplice (si fà per dire) abbiamo definito due "servizi": <i>amavis</i> per il delivery via <i>smtp</i> della posta al content filter, e la porta di <i>reiniezione</i> (reinjection sulla 10025) dove ci aspettiamo la risposta. Facile no ? :D
Lo sò, lo sò vi viene voglia di installare <i>Exchange</i> ...
</p>
<p>Non abbiamo finito, ricercate la riga più sù dove stà scritto "pickup" e fatela diventare così:
</p>
<pre>pickup    fifo  n       -       n       60      1       pickup
  -o content_filter=
  -o receive_override_options=no_header_body_checks
</pre>
<p>Questo fà si che i messaggi locali (ad esempio quelli generati dal server stesso con crond per postmaster o root o chicchessia) non vengano filtrati.
</p>
<p>Bene ora un ultimo tocco a main.cf :
</p>
<pre>sudo nano /etc/postfix/main.cf
</pre>
<p>in cui, ovviamente (almeno per chi non si è ancora perso), dobbiamo dire a postfix di usare il content filter alltraverso il servizio che abbiamo definito. Aggiungiamo quindi in fondo :
</p>
<pre>content_filter = amavis:[127.0.0.1]:10024
</pre>
<p>Ok ? Utilizziamo il servizio <i>amavis</i> che stà sulla interfaccia di loopback (127.0.0.1) sulla porta 10024. Questo vi dovrebbe far intuire che potremmo usare anche un altro server per il content filter, ma non perdiamoci, nella nostra <i>Small Buisiness</i> abbiamo un unico server ;)
</p>
<h3><span class="mw-headline" id="Amavis">Amavis</span></h3>
<p>Bene, andiamo finalmente ad editare il nostro file-incubo che serve a configurare amavis. Perchè incubo ? Appena lo aprirete sull'editor capirete, diciamo che è un po' delicatino ...
</p>
<pre>sudo nano /etc/amavisd/amavisd.conf
</pre>
<p>Assicuriamoci che l'utente e il gruppo <b>amavis</b> siano impostati:
</p>
<pre>$daemon_user = 'amavis';
$daemon_group = 'amavis';  
</pre>
<p>Troviamo e impostiamo la variabile <b>$mydomain</b> con il dominio:
</p>
<pre>$mydomain = 'mede.it';  
</pre>
<p>e cambiamo il nome del nostro host (deve esistere!) con la variabile <b>$myhostname</b>
</p>
<pre>$myhostname = 'archi.mede.it'; 
</pre>
<p>troviamo la riga seguente e aggiungiamo il nostro dominio :
</p>
<pre>@local_domains_maps = ( [".$mydomain", ".mede.it"] );
</pre>
<p>Ora dobbiamo configurare la parte <b>spamassassin</b> di amavis-new. Questo primo fà si che tutte le mail indirizzate ai domini in <b>@local_domains</b> avranno specificato il punteggio spam nella header della mail, che siano spam oppure no.
</p>
<pre>$sa_tag_level_deflt  = undef;
</pre>
<p>Questo è il punteggio "spartiacque" delle mail. In ogni mail con punteggio superiore a <b>$sa_tag2_level_deflt</b> sarà considerata spam, verrà aggiunto un prefisso "[SPAM] " all'oggetto e sarà inviata al destinatario.
</p>
<pre>$sa_tag2_level_deflt = 5.0; 
</pre>
<p>Questo valore definisce il punteggio sopra cui la mail deve essere nessa in quarantena da Amavis. Definisce anche il livello sopra il quale il mittente viene avvisato (Delivery Status Notification, DSN) che il messaggio non è stato recapitato. Nessun DSN viene inviato, tuttavia, se il parametro <b>$sa_dsn_cutoff_level</b> è impostato ad un valore inferiore al punteggio spam (vedi dopo).
Siccome noi non vogliamo per niente al mondo avvisare gli spammers che gli abbiamo "sgamato" la mail impostiamo il parametro al valore assurdo di 10000.
</p>
<pre>$sa_kill_level_deflt = 10000;
</pre>
<p>Fino a questo momento tutto lo spam è inviato ai nostri utenti, con il solo oggetto modificato. Tuttavia, quando definiremo la variabile <b>$spam_quarantine_to</b> più sotto, in effetti ognuna di queste mail sarà considerata "bisognosa di quarantena" e inviata a chi definito dal parametro con oggetto e header modificato.
Questo parametro definisce il punteggio oltre al quale non siamo interessati ad inviare la notifica (DSN) al mittente. Possiamo lasciare questo valore dal momento che non siamo interessati ad inviare alcuna notifica (cambiaremo D_BOUNCE in D_DISCARD più sotto).
</p>
<pre>$sa_dsn_cutoff_level = 9;
</pre>
<p>Oltre questo livello la mail non viene nemmeno posta in quarantena
</p>
<pre>$sa_quarantine_cutoff_level = 20; 
</pre>
<p>Come preannunciato, non inviamo MAI alcuna notifica ai mittenti. Tutte le mail finiscono in quarantena. Il preferisco inviare le mail ad un responsabile perchè controlli i messaggi incriminati anzichè in una directory di quarantena, i filtri non sono perfetti e si potrebbero verificare dei falsi positivi. Per fare questo definiamo i destinatari, e la directory di quarantena verrà disabilitata automaticamente:
</p>
<pre>$final_virus_destiny      = D_DISCARD;
$final_spam_destiny       = D_DISCARD;
$final_banned_destiny     = D_DISCARD;
</pre>
<p>Gli indirizzi seguenti diventeranno, dunque, <b>virus@mede.it</b> e <b>spam@mede.it</b> e naturalmente devo ricordare di aggiungere questi destinatari sul mio server, o di "girarli" tramite alias a qualche indirizzo esistente. 
</p>
<pre>$virus_quarantine_to = "virus\@mydomain";
$banned_quarantine_to = "spam\@$mydomain";
$bad_header_quarantine_to = "spam\@$mydomain";
$spam_quarantine_to = "spam\@$mydomain";
</pre>
<p>Ora definiamo gli indirizzi di notifica. Questi destinatari riceveranno le notifiche sui virus trovati, per disabilitare la notifica basta commentare la riga.
</p>
<pre>$virus_admin               = "postmaster\@$mydomain";
$banned_admin              = "postmaster\@$mydomain";
</pre>
<p>Non sarete mica già stufi ! Ora definiamo chi debba essere il mittente delle notifiche :
</p>
<pre>$mailfrom_notify_admin     = "postmaster\@$mydomain";
$mailfrom_notify_recip     = "postmaster\@$mydomain";
$mailfrom_notify_spamadmin = "postmaster\@$mydomain";
$hdrfrom_notify_sender     = "amavisd-new &lt;postmaster\@$mydomain&gt;";
</pre>
<p>e per ultima la stringa che deve essere anteposta all' oggetto della mail che consideriamo SPAM :
</p>
<pre>$sa_spam_subject_tag = '[SPAM]  ';
</pre>
<p>Ora le mail arriveranno, se SPAM, con l'oggetto modificato che include questa stringa.
</p>
<p>Noiosa questa parte vero ? Almeno per me lo è stata, forse sono particolarmente allergico a questo file di configurazione che sembra (e probabilmente lo è) un sorgente scritto in perl. Veramente difficoltoso districarsi tra il marasma di opzioni, forse si potrebbe far meglio, ma l'importante è che faccia il suo dovere, e su questo non ci sono dubbi.
</p>
<h3><span class="mw-headline" id="Clamav_2">Clamav</span></h3>
<p>Amavis può utilizzare un ampio ventaglio di antivirus che comprende tutti i big commerciali del settore, noi abbiamo deciso per <i>clamav</i> dal momento che è open.
Lo abbiamo già installato, ora configuriamo, avviamolo e impostiamo amavis-new affinché lo utilizzi.
</p>
<p>Clamav ha due demoni, uno per la scansione (clamd) e uno per l'aggiornamento del database dei virus conosciuti (freshclam), facciamo in modo che entrambi siano attivi : 
</p>
<pre>sudo nano /etc/conf.d/clamav
</pre>
<p>e impostiamo i valori così:
</p>
<pre>START_FRESHCLAM="yes"
START_CLAMD="yes"
</pre>
<p>Ora modifichiamo i file di configurazione prima di clamav :
</p>
<pre>sudo nano /etc/clamav/clamd.conf
</pre>
<p>rimuoviamo (o commentiamo) la riga che inizia con "Example" e impostamo il parametro <i>AllowSupplementaryGroups</i>
che abilita clamd ad accedere ai file usando qualsiasi privilegio di gruppo abbia. Senza questo clamd non accede ai file usando i permessi di gruppo, limitando la scansione ai soli file leggibili da tutti.
</p>
<pre>AllowSupplementaryGroups yes
</pre>
<p>Ora dedichiamoci a <i>freshclam</i> :
</p>
<pre>sudo nano /etc/clamav/freshclam.conf
</pre>
<p>e rimuoviamo, come per clamd, la riga che inizia con "Example".
Ora proviamo ad avviare il servizio:
</p>
<pre>sudo /etc/rc.d/clamav start
</pre>
<p>in questo modo dovrebbero partire sia <i>ClamD</i> che <i>FreshClam</i>. Se questo è successo siete in gamba e avete dimostrato si saper usare bene il copia/incolla :D
Proviamo ad aggiornare le definizioni dei virus :
</p>
<pre>sudo freshclam
</pre>
<p>Dovrei ottenere qualcosa del genere:
</p>
<pre>ClamAV update process started at Fri Jan 25 16:14:49 2008
main.cvd is up to date (version: 45, sigs: 169676, f-level: 21, builder: sven)
daily.cvd is up to date (version: 5550, sigs: 25581, f-level: 21, builder: ccordes)
</pre>
<p>Ok ? Ora non preoccupatevi, ogni 12 ore Freshclam si avvierà da solo.
</p>
<p>L'ultimo tassello di questa interminabile fase è la configurazione di amavis perché usi clamav. Per far questo ritorniamo al nostro <i>incubo</i> :
</p>
<pre>sudo nano /etc/amavisd/amavisd.conf
</pre>
<p>andiamo a decommentare la parte relativa a clamav (occhio al percorso del file clamd.sock):
</p>
<pre>['ClamAV-clamd',
  \&amp;ask_daemon, ["CONTSCAN {}\n", "/var/lib/clamav/clamd.sock"],
  qr/\bOK$/, qr/\bFOUND$/,
  qr/^.*?: (?!Infected Archive)(.*) FOUND$/ ],
</pre>
<p>e aggiungiamo l'utente <i>clamav</i> al gruppo <i>amavis</i>:
</p>
<pre>sudo gpasswd -a clamav amavis
</pre>
<h3><span class="mw-headline" id="Avvio_dei_servizi">Avvio dei servizi</span></h3>
<p>Ufff, questa parte è stata lunghina e noiosa lo ammetto, ma che ci posso fare ?
Ricordiamoci di modificare l'array DAEMONS in /etc/rc.conf :
</p>
<pre>DAEMONS=(... postfix postgrey spamd clamav amavisd ...)
</pre>
<p>che contenga i nostri "impavidi" e proviamo con un virus di test che possiamo trovare <a rel="nofollow" class="external text" href="http://www.eicar.org/download/eicar.com">qui</a>:
</p>
<pre>wget <a rel="nofollow" class="external free" href="http://www.eicar.org/download/eicar.com">http://www.eicar.org/download/eicar.com</a>
</pre>
<p>e inviamo una mail di prova :
</p>
<pre>sendmail -f test@gmail.com admin@mede.it &lt; eicar.com
</pre>
<p>L'utente <i>admin@mede.it</i> (ricordiamo che <i>virus@mede.it</i> è un alias) dovrebbe ricevere una mail con la segnalazione del virus. Per il momento ci accontentiamo di controllare visualizzando il file contenuto /home/admin/MailDir/cur corrispondente alla mail.
</p>
<h1><span class="mw-headline" id="Conclusioni">Conclusioni</span></h1>
<p>Abbiamo (anzi, <i>ho</i>) penato un po' per questa parte <i>Mail Server</i>, ma alla fine il risultato è ottimo. Certo, sarebbe auspicabile semplificare un pochino magari accorpando qualche funzionalità (specie il content filter) direttamente su Postfix dal momento che oramai praticamente tutti i server di posta fitrano i messaggi.
Chissà magari un giorno qualcuno ci pensa, nel frattempo sorbiamoci stò mattone.
</p>
<p>Per la verità qualcosa esiste, e sono sicuramente il futuro in questo campo. Mi riferisco alle soluzioni di <i>groupware</i> che sempre più spesso vengono richieste, le quali permettono una reale collaborazione tra persone magari condividendo le cose più semplici come PIM e posta elettronica.
</p>
<p>Magari daremo un occhio a <a rel="nofollow" class="external text" href="http://www.zimbra.com/">Zimbra</a>, ma questa è un altra storia ...
</p>
</div>
<div id="catlinks" class="catlinks"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../../it/Category:Small_Business_Server.html" title="Category:Small Business Server (Italiano)">Small Business Server (Italiano)</a></li></ul>
</div></div>					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<ul id="f-list" style="margin: 0 2em">
									<li>
Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Small_Business_Server_(Italiano)/Mail_Server&amp;oldid=423031">https://wiki.archlinux.org/index.php?title=Small_Business_Server_(Italiano)/Mail_Server&amp;oldid=423031</a>"</li>
					<li id="lastmod"> This page was last modified on 28 February 2016, at 09:58.</li>
									<li id="copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
									<br><li id="privacy"><a href="../../en/ArchWiki:General_disclaimer.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="../../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
									<li id="disclaimer"><a href="../../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		</body>
</html>
