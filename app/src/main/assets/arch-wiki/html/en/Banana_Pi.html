<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8">
<title>Banana Pi - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style></style>
<meta name="generator" content="MediaWiki 1.26.4">
<meta name="robots" content="noindex,follow">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Banana_Pi skin-archlinux action-view">

		<div id="globalWrapper" style="width: 100%">
		<div id="column-content">
			<div id="content" class="mw-body" role="main" style="margin: 0.5em; margin-bottom:0; margin-top:0">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Banana Pi</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="contentSub"></div>
										<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<p>From the <a rel="nofollow" class="external text" href="http://www.lemaker.org/">manufacturer</a>:
</p>
<blockquote>
<p>Banana Pi is an open-source single-board computer. It can run Android 4.4, Ubuntu, Debian, Rasberry Pi Image, as well as the Cubieboard Image. It uses the AllWinner A20 SoC, and has 1GB DDR3 SDRAM
</p>
</blockquote>
<p>BananaPi is a minimalist computer built for the <a href="https://en.wikipedia.org/wiki/ARMv7-A" class="extiw" title="wikipedia:ARMv7-A">ARMv7-A architecture</a>. <a rel="nofollow" class="external text" href="http://www.bananapi.org/">More information about this project</a> and <a rel="nofollow" class="external text" href="http://www.bananapi.org/p/product.html">technical specification</a>.
</p>
<p>With its Allwinner SoC, a Banana board usually runs the well documented Sunxi Linux kernel. So for any hardware or kernel related tasks, you should <a rel="nofollow" class="external text" href="https://linux-sunxi.org/Main_Page">take a look at the Sunxi Wiki</a> as well. 
</p>
<div id="toc" class="toc">
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Article_preface"><span class="tocnumber">1</span> <span class="toctext">Article preface</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Installation"><span class="tocnumber">2</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-3">
<a href="#Using_original_ArchLinuxARM_tarball"><span class="tocnumber">2.1</span> <span class="toctext">Using original ArchLinuxARM tarball</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Install_basesystem_to_a_SD_card"><span class="tocnumber">2.1.1</span> <span class="toctext">Install basesystem to a SD card</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Compile_and_copy_U-Boot_bootloader"><span class="tocnumber">2.1.2</span> <span class="toctext">Compile and copy U-Boot bootloader</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Login_.2F_SSH"><span class="tocnumber">2.1.3</span> <span class="toctext">Login / SSH</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7">
<a href="#Using_prebuilt_ArchLinuxARM_images"><span class="tocnumber">2.2</span> <span class="toctext">Using prebuilt ArchLinuxARM images</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Download_the_source"><span class="tocnumber">2.2.1</span> <span class="toctext">Download the source</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Installation_2"><span class="tocnumber">2.2.2</span> <span class="toctext">Installation</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-10">
<a href="#Network"><span class="tocnumber">3</span> <span class="toctext">Network</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#SSH"><span class="tocnumber">3.1</span> <span class="toctext">SSH</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#X.org_driver"><span class="tocnumber">4</span> <span class="toctext">X.org driver</span></a></li>
<li class="toclevel-1 tocsection-13">
<a href="#Troubleshooting"><span class="tocnumber">5</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Ethernet_not_working"><span class="tocnumber">5.1</span> <span class="toctext">Ethernet not working</span></a></li>
<li class="toclevel-2 tocsection-15">
<a href="#HDMI_1080p_resolution"><span class="tocnumber">5.2</span> <span class="toctext">HDMI 1080p resolution</span></a>
<ul>
<li class="toclevel-3 tocsection-16"><a href="#Manually_change_the_resolution"><span class="tocnumber">5.2.1</span> <span class="toctext">Manually change the resolution</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#Automatically_set_resolution_on_boot"><span class="tocnumber">5.2.2</span> <span class="toctext">Automatically set resolution on boot</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Display_turns_off_after_idle_and_does_not_turn_on_again"><span class="tocnumber">5.2.3</span> <span class="toctext">Display turns off after idle and does not turn on again</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-19">
<a href="#Benchmarks"><span class="tocnumber">6</span> <span class="toctext">Benchmarks</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#SATA_HDD"><span class="tocnumber">6.1</span> <span class="toctext">SATA HDD</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Network_2"><span class="tocnumber">6.2</span> <span class="toctext">Network</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22"><a href="#See_also"><span class="tocnumber">7</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Article_preface">Article preface</span></h2>
<p>This article is strongly based on <a href="../en/Raspberry_Pi.html" title="Raspberry Pi">Raspberry Pi</a>. Moreover this article is not meant to be an exhaustive setup guide and assumes that the reader has setup an Arch system before.
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<h3><span class="mw-headline" id="Using_original_ArchLinuxARM_tarball">Using original ArchLinuxARM tarball</span></h3>
<p>This method will install unmodified ArchLinuxARM armv7 basesystem to your Banana Pi, meaning you'll have the latest mainline kernel running.
</p>
<h4><span class="mw-headline" id="Install_basesystem_to_a_SD_card">Install basesystem to a SD card</span></h4>
<p>Zero the beginning of the SD card:
</p>
<pre>dd if=/dev/zero of=/dev/sdX bs=1M count=8
</pre>
<p>Use <a href="../en/Fdisk.html" title="Fdisk">fdisk</a> to partition the SD card, and <a href="../en/File_systems.html" title="File systems">format</a> it with <code>mkfs.ext4 -O ^metadata_csum,^64bit /dev/sdX1</code>.
</p>
<p>Mount the ext4 filesystem, replacing <code>sda1</code> with the formatted partition:
</p>
<pre># mkdir mnt
# mount /dev/<i>sda1</i> mnt
</pre>
<p>Download and extract the root filesystem:
</p>
<pre># wget <a rel="nofollow" class="external free" href="http://archlinuxarm.org/os/ArchLinuxARM-armv7-latest.tar.gz">http://archlinuxarm.org/os/ArchLinuxARM-armv7-latest.tar.gz</a>
# bsdtar -xpf ArchLinuxARM-armv7-latest.tar.gz -C /mnt/
</pre>
<p>Create a file with the following boot script
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">boot.cmd</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
part uuid ${devtype} ${devnum}:${bootpart} uuid
setenv bootargs console=${console} root=PARTUUID=${uuid} rw rootwait

if load ${devtype} ${devnum}:${bootpart} ${kernel_addr_r} /boot/zImage; then
  if load ${devtype} ${devnum}:${bootpart} ${fdt_addr_r} /boot/dtbs/${fdtfile}; then
    if load ${devtype} ${devnum}:${bootpart} ${ramdisk_addr_r} /boot/initramfs-linux.img; then
      bootz ${kernel_addr_r} ${ramdisk_addr_r}:${filesize} ${fdt_addr_r};
    else
      bootz ${kernel_addr_r} - ${fdt_addr_r};
    fi;
  fi;
fi

if load ${devtype} ${devnum}:${bootpart} 0x48000000 /boot/uImage; then
  if load ${devtype} ${devnum}:${bootpart} 0x43000000 /boot/script.bin; then
    setenv bootm_boot_mode sec;
    bootm 0x48000000;
  fi;
fi</pre>
<p>Compile it and write it to the SD-card using the package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=uboot-tools">uboot-tools</a></span>
</p>
<pre># mkimage -A arm -O linux -T script -C none -a 0 -e 0 -n "BananPI boot script" -d boot.cmd /mnt/boot/boot.scr
# umount /mnt
</pre>
<h4><span class="mw-headline" id="Compile_and_copy_U-Boot_bootloader">Compile and copy U-Boot bootloader</span></h4>
<p>The next step is creating a u-boot image. Make sure you have <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=arm-none-eabi-gcc">arm-none-eabi-gcc</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=dtc">dtc</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=git">git</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=uboot-tools">uboot-tools</a></span> installed on your system. Then clone the u-boot source code and compile a Banana Pi image:
</p>
<pre>$ git clone <a rel="nofollow" class="external free" href="git://git.denx.de/u-boot.git">git://git.denx.de/u-boot.git</a>
$ cd u-boot
$ make -j4 ARCH=arm CROSS_COMPILE=arm-none-eabi- Bananapi_defconfig 
$ make -j4 ARCH=arm CROSS_COMPILE=arm-none-eabi-
</pre>
<p>If everything went fine you should have an U-Boot image: u-boot-sunxi-with-spl.bin. Now dd the image to your sdcard, where /dev/sdX is your sdcard.
</p>
<pre># dd if=u-boot-sunxi-with-spl.bin of=/dev/sdX bs=1024 seek=8
</pre>
<h4><span class="mw-headline" id="Login_.2F_SSH">Login / SSH</span></h4>
<p>SSH login for root is disabled by default. Login with the default user account and use <a href="../en/Su.html" title="Su">su</a>.
</p>
<table class="wikitable">
<tr>
<th> Type
</th>
<th> Username
</th>
<th> Password
</th>
</tr>
<tr>
<td>Root
</td>
<td>
<code>root</code>
</td>
<td>
<code>root</code>
</td>
</tr>
<tr>
<td>User
</td>
<td>
<code>alarm</code>
</td>
<td>
<code>alarm</code>
</td>
</tr>
</table>
<h3><span class="mw-headline" id="Using_prebuilt_ArchLinuxARM_images">Using prebuilt ArchLinuxARM images</span></h3>
<h4><span class="mw-headline" id="Download_the_source">Download the source</span></h4>
<p>First make sure you download the right image for your board. Although you can install the image for the Pi on the Pro as well for example, it doesn't include features like wireless support out of the box.
</p>
<ul>
<li> <a rel="nofollow" class="external text" href="http://www.lemaker.org/portal.php?mod=list&amp;catid=4">Arch image for Banana Pi</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://www.lemaker.org/portal.php?mod=list&amp;catid=5">Arch image for Banana Pro</a>
</li>
</ul>
<p>You can get customized images as well, like this <a rel="nofollow" class="external text" href="http://blog.eldajani.net/banana-pi-arch-linux-customized-distribution/">Arch / LXDE distribution for the Pi</a>.
</p>
<h4><span class="mw-headline" id="Installation_2">Installation</span></h4>
<p>See the <a rel="nofollow" class="external text" href="http://wiki.lemaker.org/SD_card_installation">Banana Pi documentation</a>.
You mostly need to download the <a rel="nofollow" class="external text" href="http://www.lemaker.org/article-26-1.html">Arch Linux image</a>, unpack it, and dump it to your SD card. If your SD card is larger than 4G, you might want to resize the filesystem with a tool like <code>parted</code> etc.
</p>
<h2><span class="mw-headline" id="Network">Network</span></h2>
<h3><span class="mw-headline" id="SSH">SSH</span></h3>
<p>Luckily the <a href="../en/Secure_Shell.html" title="Secure Shell">SSH daemon</a> is already installed by default. The default login data is:
</p>
<table class="wikitable">
<tr>
<th> Type
</th>
<th> Username
</th>
<th> Password
</th>
</tr>
<tr>
<td>Root
</td>
<td>
<code>root</code>
</td>
<td>
<code>bananapi</code>
</td>
</tr>
<tr>
<td>User
</td>
<td>
<code>bananapi</code>
</td>
<td>
<code>bananapi</code>
</td>
</tr>
</table>
<h2><span class="mw-headline" id="X.org_driver">X.org driver</span></h2>
<p>The X.org driver for Banana Pi can be installed with the <i>xf86-video-fbdev</i> package.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Ethernet_not_working">Ethernet not working</span></h3>
<p>In some cases, the Gbit ethernet connection is unstable or not working properly. It might help to limit the link speed to 100 Mbps using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=ethtool">ethtool</a></span>:
</p>
<pre>ethtool -s eth0 speed 100 duplex half autoneg off
</pre>
<h3><span class="mw-headline" id="HDMI_1080p_resolution">HDMI 1080p resolution</span></h3>
<p>There are two methods to achieve changing the resolution from the default 1280x720/60Hz to 1920x1080/60Hz.
</p>
<h4><span class="mw-headline" id="Manually_change_the_resolution">Manually change the resolution</span></h4>
<p>Yield all possible HDMI-resolutions:
</p>
<pre># cat /sys/class/graphics/fb0/modes
</pre>
<p>Change to desired resolution, e.g.:
</p>
<pre># echo "D:1920x1080p-60" &gt; /sys/class/graphics/fb0/mode
</pre>
<h4><span class="mw-headline" id="Automatically_set_resolution_on_boot">Automatically set resolution on boot</span></h4>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Arch does not provide the <i>sunxi-tools</i> package in <a href="../en/Official_repositories.html" title="Official repositories">official repositories</a>, so the <code>pacman -S ...</code> command in this section is probably specific to Arch Linux ARM. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Banana_Pi">Talk:Banana Pi#</a>)</div>
</div>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements.</b><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Does not comply with <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a>. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Banana_Pi">Talk:Banana Pi#</a>)</div>
</div>
<p>You need to edit the kernel parameters in the <code>uEnv.txt</code> and provide the required parameters in <code>script.bin</code>. As the <code>script.bin</code> is a binary file, you need to use the Sunix tools, to convert it to a <code>script.fex</code> text file, make your changes and reconvert it to the <code>script.bin</code>. (see also  <a rel="nofollow" class="external text" href="http://linux-sunxi.org/Fex_Guide#disp_init_configuration">Sunxi fex guide</a>, <a rel="nofollow" class="external text" href="http://linux-sunxi.org/Kernel_arguments">Sunix kernel arguments</a> and <a rel="nofollow" class="external text" href="http://forum.lemaker.org/viewthread.php?action=printable&amp;tid=1881">this thread</a>).
</p>
<pre>$ cd $HOME
$ mkdir $HOME/boot
$ sudo mount /dev/mmcblk0p1 $HOME/boot
$ cp $HOME/boot/script.bin $HOME/script.bin
$ pacman -S sunxi-tools
$ bin2fex $HOME/script.bin $HOME/script.fex
</pre>
<p>Now edit the created <code>script.fex</code> with an editor of your choice. Find the <code>[disp_init]</code> section and change/add the following parameters:
</p>
<pre>screen0_output_mode = 10
fb0_framebuffer_num = 3
fb0_scaler_mode_enable = 0
sunxi_fb_mem_reserve = 32
</pre>
<p>Save the changes, run <code>fex2bin</code>, backup and replace the previous <code>script.bin</code>.
</p>
<pre>$ $HOME/sunxi-tools/fex2bin $HOME/script.fex $HOME/script.bin
$ sudo cp $HOME/boot/script.bin $HOME/boot/script.bin.backup
$ sudo cp $HOME/script.bin $HOME/boot/script.bin
</pre>
<p>After creating a backup, you can change the <code>disp.screen0.output_mode</code> part of the <code>$HOME/boot/uEnv.txt</code> config with root privileges:
</p>
<pre>disp.screen0.output_mode=10:1920x1080p60
</pre>
<p>Unmount the boot partition, reboot and you should have 1080p/60Hz.
</p>
<h4><span class="mw-headline" id="Display_turns_off_after_idle_and_does_not_turn_on_again">Display turns off after idle and does not turn on again</span></h4>
<p>If you also have an issue with the display turning off after some idle time and not turning on again, you might want to disable <a href="../en/Display_Power_Management_Signaling.html" title="DPMS" class="mw-redirect">DPMS</a>. Therefore add these X11 arguments to the proper configuration of your display manager.
</p>
<pre>-s 0 -dpms
</pre>
<p>For example, if you use <a href="../en/SLiM.html" title="SLiM">SLiM</a>, you would modify in your <code>/etc/slim.conf</code>:
</p>
<pre>xserver_arguments -nolisten tcp vt07 -s 0 -dpms 
</pre>
<p>If for some reason the display still keeps turning off, e.g. when restarting your receiving device, you can turn it on again, by temporary change the resolution:
</p>
<pre># echo "D:1280x720p-60" &gt; /sys/class/graphics/fb0/mode
# echo "D:1920x1080p-60" &gt; /sys/class/graphics/fb0/mode
</pre>
<h2><span class="mw-headline" id="Benchmarks">Benchmarks</span></h2>
<p>Of course the following values might differ from yours, as they are dependend on the actual hardware connected (e.g. the HDD), but it might give you a feeling about the Banana Pi performances.
</p>
<h3><span class="mw-headline" id="SATA_HDD">SATA HDD</span></h3>
<p>I connected two different external HDDs (3,5" with external energy source) via SATA-L to eSATA-I cable to the Banana Pi. My reading/writing results using <a href="../en/Benchmarking/Data_storage_devices.html#Using_dd" title="Benchmarking/Data storage devices">dd</a> (average of 3 run times):
</p>
<table style="text-align: center;" class="wikitable">
<tr>
<th>
</th>
<th>HDD 1 (2 TB)
</th>
<th>HDD 2 (4 TB)
</th>
</tr>
<tr>
<th>Reading
</th>
<td>81.8 MB/s
</td>
<td>115.5 MB/s
</td>
</tr>
<tr>
<th>Writing
</th>
<td>37.6 MB/s
</td>
<td>39,4 MB/s
</td>
</tr>
</table>
<h3><span class="mw-headline" id="Network_2">Network</span></h3>
<p>Due to the Allwinner A20 SoC limitations the BPi is not able to use the full theoretical bandwidth of the Gigabit Ethernet NIC. Yet the BPi is able to use about 510 MBits per second.
</p>
<p>Benchmarking was done using <code>iperf</code> (average of 3 run times). Client BPi and Server were connected to a Gigabit capable switch via Gigabit Ethernet.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li> <a rel="nofollow" class="external autonumber" href="http://wiki.lemaker.org/BananaPro/Pi:FAQs">[1]</a>
</li></ul>

</div>
<div id="catlinks" class="catlinks">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:ARM_architecture.html" title="Category:ARM architecture">ARM architecture</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
</ul>
</div>
</div>					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
Extracted from <a href="https://wiki.archlinux.org"> ArchWiki </a> and licensed under <a href="http://www.gnu.org/copyleft/fdl.html"> GDL >= 1.3</a>
		</div>
		</div>
		</body>
</html>
