<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8">
<title>MacBookPro11,x - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style></style>
<meta name="generator" content="MediaWiki 1.26.4">
<meta name="robots" content="noindex,follow">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-MacBookPro11_x skin-archlinux action-view">

		<div id="globalWrapper" style="width: 100%">
		<div id="column-content">
			<div id="content" class="mw-body" role="main" style="margin: 0.5em; margin-bottom:0; margin-top:0">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">MacBookPro11,x</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="contentSub"></div>
										<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div style="width:45%; margin: 0 0 0.5em 0.5em;">
<p style="background:#333; color:white; padding:0.2em; border-bottom:5px #08c solid; margin:0; text-align:center; font-weight:bold;">Related articles</p>
<ul style="list-style-type:none; margin:0; padding:0.3em;">
<li style="padding:0.4em 0; line-height:1;"><a href="../en/Installation_guide.html" title="Installation guide">Installation guide</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/General_recommendations.html" title="General recommendations">General recommendations</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/MacBookPro10,x.html" title="MacBookPro10,x">MacBookPro10,x</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/MacBook.html" title="MacBook">MacBook</a></li>
</ul>
</div>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements.</b><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> This page flat-out ignores every possible <a href="../en/Help:Style.html" title="Help:Style">style</a> rule (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:MacBookPro11,x">Talk:MacBookPro11,x#</a>)</div>
</div>
<p>The MacBook Pro 11,x consists of models with Retina display shipped by Apple In Late 2013 and Mid 2014. Like its predecessors, it is based on Intel chipset, although some manual configuration might be required in specific cases in order to deal with Apple-related features.
</p>
<p>Like previous MacBook models, the MacBook Pro 11,x supports UEFI. This page will cover the current status of hardware support on Arch Linux, as well as post-installation recommendations.
</p>
<div id="toc" class="toc">
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Preparing_for_the_Installation"><span class="tocnumber">1</span> <span class="toctext">Preparing for the Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Firmware_updates"><span class="tocnumber">1.1</span> <span class="toctext">Firmware updates</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Partitioning"><span class="tocnumber">1.2</span> <span class="toctext">Partitioning</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4">
<a href="#Installation"><span class="tocnumber">2</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Booting_the_live_image"><span class="tocnumber">2.1</span> <span class="toctext">Booting the live image</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Console"><span class="tocnumber">2.2</span> <span class="toctext">Console</span></a></li>
<li class="toclevel-2 tocsection-7">
<a href="#Internet"><span class="tocnumber">2.3</span> <span class="toctext">Internet</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Wired"><span class="tocnumber">2.3.1</span> <span class="toctext">Wired</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Wireless"><span class="tocnumber">2.3.2</span> <span class="toctext">Wireless</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-10"><a href="#Bootloader"><span class="tocnumber">2.4</span> <span class="toctext">Bootloader</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11">
<a href="#Post_installation"><span class="tocnumber">3</span> <span class="toctext">Post installation</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Console_2"><span class="tocnumber">3.1</span> <span class="toctext">Console</span></a></li>
<li class="toclevel-2 tocsection-13">
<a href="#Graphics"><span class="tocnumber">3.2</span> <span class="toctext">Graphics</span></a>
<ul>
<li class="toclevel-3 tocsection-14"><a href="#MacBook_Pro_11.2C1"><span class="tocnumber">3.2.1</span> <span class="toctext">MacBook Pro 11,1</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#MacBook_Pro_11.2C2"><span class="tocnumber">3.2.2</span> <span class="toctext">MacBook Pro 11,2</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#MacBook_Pro_11.2C3"><span class="tocnumber">3.2.3</span> <span class="toctext">MacBook Pro 11,3</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#MacBook_Pro_11.2C5"><span class="tocnumber">3.2.4</span> <span class="toctext">MacBook Pro 11,5</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Microcode"><span class="tocnumber">3.2.5</span> <span class="toctext">Microcode</span></a></li>
<li class="toclevel-3 tocsection-19"><a href="#HiDPI"><span class="tocnumber">3.2.6</span> <span class="toctext">HiDPI</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#Xfce"><span class="tocnumber">3.2.7</span> <span class="toctext">Xfce</span></a></li>
<li class="toclevel-3 tocsection-21"><a href="#lightdm"><span class="tocnumber">3.2.8</span> <span class="toctext">lightdm</span></a></li>
<li class="toclevel-3 tocsection-22"><a href="#MATE"><span class="tocnumber">3.2.9</span> <span class="toctext">MATE</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#GNOME"><span class="tocnumber">3.2.10</span> <span class="toctext">GNOME</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#Getting_the_integrated_intel_card_to_work_on_11.2C3"><span class="tocnumber">3.2.11</span> <span class="toctext">Getting the integrated intel card to work on 11,3</span></a></li>
<li class="toclevel-3 tocsection-25"><a href="#Alternative_method_to_disable_NVIDIA_card"><span class="tocnumber">3.2.12</span> <span class="toctext">Alternative method to disable NVIDIA card</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-26"><a href="#Sound"><span class="tocnumber">3.3</span> <span class="toctext">Sound</span></a></li>
<li class="toclevel-2 tocsection-27">
<a href="#Touchpad"><span class="tocnumber">3.4</span> <span class="toctext">Touchpad</span></a>
<ul>
<li class="toclevel-3 tocsection-28"><a href="#Ctrl-Click_as_Right-Click"><span class="tocnumber">3.4.1</span> <span class="toctext">Ctrl-Click as Right-Click</span></a></li>
<li class="toclevel-3 tocsection-29"><a href="#input-mtrack"><span class="tocnumber">3.4.2</span> <span class="toctext">input-mtrack</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-30"><a href="#Keyboard_backlight"><span class="tocnumber">3.5</span> <span class="toctext">Keyboard backlight</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#Screen_backlight"><span class="tocnumber">3.6</span> <span class="toctext">Screen backlight</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#Suspend"><span class="tocnumber">3.7</span> <span class="toctext">Suspend</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Powersave"><span class="tocnumber">3.8</span> <span class="toctext">Powersave</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#SD_Card_Reader"><span class="tocnumber">3.9</span> <span class="toctext">SD Card Reader</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#Repurpose_the_power_key"><span class="tocnumber">3.10</span> <span class="toctext">Repurpose the power key</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#Web_cam"><span class="tocnumber">3.11</span> <span class="toctext">Web cam</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-37">
<a href="#What_does_not_work"><span class="tocnumber">4</span> <span class="toctext">What does not work</span></a>
<ul>
<li class="toclevel-2 tocsection-38"><a href="#General"><span class="tocnumber">4.1</span> <span class="toctext">General</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#Wi-Fi"><span class="tocnumber">4.2</span> <span class="toctext">Wi-Fi</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#Backlight_keys_.2F_Suspend_support"><span class="tocnumber">4.3</span> <span class="toctext">Backlight keys / Suspend support</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-41"><a href="#Discussions"><span class="tocnumber">5</span> <span class="toctext">Discussions</span></a></li>
<li class="toclevel-1 tocsection-42"><a href="#See_also"><span class="tocnumber">6</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Preparing_for_the_Installation">Preparing for the Installation</span></h2>
<h3><span class="mw-headline" id="Firmware_updates">Firmware updates</span></h3>
<p>Before proceeding with the installation of Arch Linux, it is important to ensure that the latest firmware updates for you MacBook are installed. This procedure requires OS X.
In OS X, open the App Store and check for updates. If your mac finds and installs any updates, make sure to <b>reboot</b> your computer, and then check again for updates to make sure that you installed everything.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>If you uninstalled OS X or want to reinstall it, <a rel="nofollow" class="external text" href="https://support.apple.com/en-us/HT204904">Apple</a> has great instructions.</div>
<p>It is advisable to keep OS X installed, because MacBook firmware updates can only be installed using OS X. However, if you plan to remove OS X completely, make backups of these files, which you will need in Linux for adjusting the <a href="#Color_Profile">color profile</a>:
</p>
<pre>/Library/ColorSync/Profiles/Displays/*
</pre>
<h3><span class="mw-headline" id="Partitioning">Partitioning</span></h3>
<p>By default, the MacBook's drive is formatted using GPT and contains at least 3 partitions:
</p>
<ul>
<li> <b>EFI</b>: the ~200 MB <a href="../en/EFI_System_Partition.html" title="EFI System Partition">EFI System Partition</a>.</li>
<li> <b>OS X</b>: the main partition containing your OS X installation. It is formatted using <a href="../en/File_systems.html" title="File systems">HFS+</a>.</li>
<li> <b>Recovery</b>: A recovery partition used for special purposes.</li>
</ul>
<p>As a general rule, partitioning is no different from any other hardware that Arch Linux can be installed on. If you plan on keeping OS X for the purpose of dual booting, you need to manually shrink the main OS X HFS+ partition from within OS X's Disk Utility program. 
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>The OS X <b>Recovery partition</b> is not visible inside OS X <code>Disk Utility</code>. However, the partition will be automatically moved after the OS X partition if you resize it.</div>
<div style="padding: 5px; margin: 0.50em 0; background-color: #FFDDDD; border: thin solid #DDBBBB; overflow: hidden;">
<strong> Warning: </strong> If you OS X partition is encrypted with FileVault 2, you <b>must</b> disable the disk encryption before proceeding. After the OS X partition has been resized, FileVault 2 can be re-enabled.</div>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>If you plan to remove OS X, it is advisable to <b>disable</b> the MacBook startup sound before proceeding with partitioning. Just boot in OS X, mute your system sound and reboot again to the Arch Linux Installation media. Please keep in mind that the volume of the startup sound can only be modified reliably in OS X.</div>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<h3><span class="mw-headline" id="Booting_the_live_image">Booting the live image</span></h3>
<p>The Apple boot manager is accessible by holding the <code>Alt</code> button during power on. As any other computer that does not have a CDROM drive, you need to use an <a href="../en/USB_flash_installation_media.html" title="USB flash installation media">USB flash installation media</a>. After booting, please refer to the official <a href="../en/Installation_guide.html" title="Installation guide">Installation guide</a>.
</p>
<h3><span class="mw-headline" id="Console">Console</span></h3>
<p>As this model of notebook has a high DPI display, the console font displayed will be extremely small and depending on your preferences is likely to be uncomfortable to use. You may wish to change this for a more legible font, an example of which is;
</p>
<pre>$ setfont sun12x22
</pre>
<p>If you want to make this change permanent, add the following line to <code>/etc/vconsole.conf</code>
</p>
<pre> FONT=sun12x22
</pre>
<h3><span class="mw-headline" id="Internet">Internet</span></h3>
<h4><span class="mw-headline" id="Wired">Wired</span></h4>
<p>Thunderbolt Ethernet adapters and USB-to-Ethernet adapters should be picked up automatically. 
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>You may have to power on the machine with the Thunderbolt Ethernet adapter plugged in for it to be picked up initially.</div>
<h4><span class="mw-headline" id="Wireless">Wireless</span></h4>
<p>As mentioned below, <code>broadcom-wl</code> is sufficient if you are using the Linux mainline kernel. For custom kernels, you need to use <code>broadcom-wl-dkms</code>. Both are available from the <a href="../en/Arch_User_Repository.html" title="AUR" class="mw-redirect">AUR</a>. The easiest way to get Wi-Fi connectivity during install is to build the package driver on a separate system. Note that it does have to be built against the exact same kernel version as used by the installer, and this may differ from the latest version. If built against the wrong kernel you may encounter an error <i>(ERROR: could not insert 'wl': Invalid argument)</i> upon modprobe. Build the package as follows:
</p>
<pre>$ curl -O <a rel="nofollow" class="external free" href="https://aur.archlinux.org/cgit/aur.git/snapshot/broadcom-wl-dkms.tar.gz">https://aur.archlinux.org/cgit/aur.git/snapshot/broadcom-wl-dkms.tar.gz</a>
$ tar -zxvf broadcom-wl-dkms.tar.gz
$ cd broadcom-wl-dkms
$ makepkg -s
</pre>
<p>This will give you a package (<code>broadcom-wl-*.pkg.tar.xz</code>) which can be installed using <a href="../en/Pacman.html" title="Pacman">pacman</a>. Put this package on a USB drive, mount it, and install the package using:
</p>
<pre># pacman -U broadcom-wl-*.pkg.tar.xz
# modprobe wl
</pre>
<p>You may now use <code>wifi-menu</code> to connect to your network of choice. 
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>You need to repeat this process when you have finished your installation and booting into the system for the first time. If kernel versions differ, you may want to ensure to install a number of essential packages while you have connectivity and before you boot into your system, these allow you to build the broadcom driver again and connect (provided you put the AUR tarball for the driver on USB drive too):
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=dkms">dkms</a></span>,<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=wpa_supplicant">wpa_supplicant</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=dhcpcd">dhcpcd</a></span> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=dialog">dialog</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=netctl">netctl</a></span> are needed if you want to use <code>wifi-menu</code> again after you boot)</div>
<h3><span class="mw-headline" id="Bootloader">Bootloader</span></h3>
<p>MacBooks can be easily configured to use <a href="../en/Systemd-boot.html" title="Systemd-boot">systemd-boot</a> or <a href="../en/GRUB.html" title="GRUB">GRUB</a> directly from the Apple bootloader, without the need for third-party tools such as <a href="../en/REFInd.html" title="REFInd">rEFInd</a>. Systemd-boot is the recommended way for systems that support UEFI.
</p>
<ul>
<li> First, make sure you mounted the EFI System Partition at <code>/boot</code>
</li>
<li> Proceed with <a href="../en/Installation_guide.html" title="Installation guide">Installation</a> normally</li>
<li> Once inside the chrooted enviroment, type the following command to install <i>systemd-boot</i>:</li>
</ul>
<pre># bootctl --path=/boot install</pre>
<p>The above command will copy the <i>systemd-boot</i> binary to <code>/boot/EFI/Boot/BOOTX64.EFI</code> and add <i>systemd-boot</i> itself as the default EFI application (default boot entry) loaded by the EFI Boot Manager. 
</p>
<ul><li> Proceed to <a href="../en/Systemd-boot.html#Configuration" title="Systemd-boot">systemd-boot#Configuration</a> in order to correctly set up the bootloader</li></ul>
<p>At the next reboot, the Apple Boot Manager, shown when holding down the option key when booting the MacBook, should display Arch Linux (it will be displayed as <code>EFI Boot</code> as a possible boot option).
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>If you wish to use GRUB, have a look at the <a href="../en/MacBook.html#Using_the_native_Apple_bootloader_with_GRUB" title="MacBook">MacBook</a> page.</div>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDFFDD; border: thin solid #BBDDBB; overflow: hidden;">
<strong> Tip: </strong>If you installed Arch Linux alongside OS X, you will be able to change the default boot location from  system Settings inside OS X. If Arch Linux does not show up as a possible boot option, you will have to mount the EFI System Partition inside OS X before selecting your boot option:
<pre>$ diskutil mount disk0s1</pre>
<p>Keep in mind, however, it is also possible to load OS X from <a href="../en/Systemd-boot.html" title="Systemd-boot">systemd-boot</a>. 
</p>
</div>
<h2><span class="mw-headline" id="Post_installation">Post installation</span></h2>
<h3><span class="mw-headline" id="Console_2">Console</span></h3>
<p>Largest console font can be achieved by adding <code>FONT=sun12x22</code> to <code>/etc/vconsole.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># nano /etc/vconsole.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
FONT=sun12x22</pre>
<h3><span class="mw-headline" id="Graphics">Graphics</span></h3>
<h6><span class="mw-headline" id="MacBook_Pro_11.2C1">MacBook Pro 11,1</span></h6>
<ul><li> Works, see <a href="../en/Intel_graphics.html" title="Intel graphics">Intel graphics</a>
</li></ul>
<h6><span class="mw-headline" id="MacBook_Pro_11.2C2">MacBook Pro 11,2</span></h6>
<ul><li> Intel works from 3.13.4-1-ARCH</li></ul>
<h6><span class="mw-headline" id="MacBook_Pro_11.2C3">MacBook Pro 11,3</span></h6>
<ul>
<li> Nvidia works (both 319.60 and 331.17 drivers)
<ul><li> Follow <a rel="nofollow" class="external free" href="http://cberner.com/2013/03/01/installing-ubuntu-13-04-on-macbook-pro-retina/">http://cberner.com/2013/03/01/installing-ubuntu-13-04-on-macbook-pro-retina/</a>
</li></ul>
</li>
<li> Intel works after patching grub, see below</li>
</ul>
<h6><span class="mw-headline" id="MacBook_Pro_11.2C5">MacBook Pro 11,5</span></h6>
<ul>
<li> The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=xf86-video-nouveau">xf86-video-nouveau</a></span> package seems to be stable. Switching to VTs and back works fine from MATE and GNOME. SOmetimes Chromium causes a "kernele rejected pixbuf" error which freezes the desktop.</li>
<li> The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=nvidia-dkms">nvidia-dkms</a></span> driver has been crashing a lot.</li>
<li> The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=nvidia">nvidia</a></span> driver seems to be super stable, but GNOME desktop won't like to start, showing you a "Oh no! Something has gone wrong" message. Cinnamon Desktop is buttery smooth with the nvidia driver, and if you want your GNOME desktop, you can run `gnome-shell --relace &amp;` while in cinnamon desktop to switch to Gnome Shell as a workaround.</li>
</ul>
<h6><span class="mw-headline" id="Microcode">Microcode</span></h6>
<p>You may need to install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=intel-ucode">intel-ucode</a></span>, especially if you have Nvidia drivers. Read the wiki page to learn more about <a href="../en/Microcode.html" title="Microcode">Microcode</a>.
</p>
<h6><span class="mw-headline" id="HiDPI">HiDPI</span></h6>
<p>See <a href="../en/HiDPI.html" title="HiDPI">HiDPI</a> for information on how to tweak the system for a Retina screen.
</p>
<h6><span class="mw-headline" id="Xfce">Xfce</span></h6>
<p>If you are using <a href="../en/Xfce.html" title="Xfce">Xfce</a>, you will probably experience tearing in Firefox, VLC, etc. Until newer versions of xfwm support OpenGL rendering, use another compositing window manager like <a href="../en/Compton.html" title="Compton">compton</a> with <code>backend = "glx"</code>.
</p>
<h6><span class="mw-headline" id="lightdm">lightdm</span></h6>
<p>If you are using lightdm on HiDPI/Retina screens you may experience a small login box
, to use the native resolution of 2560x1600 on the login screen create a script
</p>
<pre>  #!/bin/sh
  xrandr --output eDP1 --primary --mode 2560x1600
</pre>
<p>and set it as display-setup-script in /etc/lightdm/lightdm.conf
</p>
<h6><span class="mw-headline" id="MATE">MATE</span></h6>
<p>MATE's Marco seems to have problems. Replace it with GNOME's Mutter for nice animated effects. This works best with the nouveau driver.
</p>
<pre># mutter --replace &amp;&amp;
</pre>
<p>Or configure MATE to use Mutter in dconf...
</p>
<h6><span class="mw-headline" id="GNOME">GNOME</span></h6>
<p>It all works great out of the box with the nouveau driver.
</p>
<h4><span class="mw-headline" id="Getting_the_integrated_intel_card_to_work_on_11.2C3">Getting the integrated intel card to work on 11,3</span></h4>
<p>By default the integrated card is powered off. To fix this we need a grub function called "apple_set_os". This function has not officially been merged yet, so we need to build grub ourselves. Download the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/grub-git/">grub-git</a></span><sup><small>AUR</small></sup> package from the AUR. Using something like:
</p>
<pre>$ packer -G grub-git
$ cd grub-git
</pre>
<p>Get the patch from here: <a rel="nofollow" class="external free" href="http://lists.gnu.org/archive/html/grub-devel/2013-12/msg00442.html">http://lists.gnu.org/archive/html/grub-devel/2013-12/msg00442.html</a>
</p>
<p>Put the patch contents into a file labeled something like "apple.patch"
</p>
<p>Add this patch to your PKGBUILD and run:
</p>
<pre>$ makepkg -si
</pre>
<p>Reboot into OS X and download gfxCardStatus v2.2.1 (newer versions do not work properly) run the app and specify the integrated card.
</p>
<p>Reboot and at the grub prompt type 'c' to get into console, followed by "apple_set_os" at the prompt.
</p>
<p>You should now be able to install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=xf86-video-intel">xf86-video-intel</a></span> and get your card running.
</p>
<p>Note that the HDMI port and MiniDP are soldered to the nvidia card meaning that to run external displays you need to use the dedicated card.
</p>
<h4><span class="mw-headline" id="Alternative_method_to_disable_NVIDIA_card">Alternative method to disable NVIDIA card</span></h4>
<p>While the above method for switching graphics works, there is a more effective method that does not require the use of gfxCardStatus or a patched GRUB installation (but it can be used if desired).
</p>
<p>First, the Intel GPU will not function without a patch called apple_set_os. You can either use a patched GRUB (as seen above) or use the apple_set_os.efi patch via rEFInd or chainload it via GRUB, the EFI patch can be download here, <a rel="nofollow" class="external free" href="https://github.com/0xbb/apple_set_os.efi">https://github.com/0xbb/apple_set_os.efi</a>, this tricks the machine into thinking that it is booting a Mac OS X installation, making the hardware behave as such, allowing the Intel GPU to be used. rEFInd should automatically detect the patch as described on the application page. This will need to be loaded before each boot of Arch or else the Intel GPU will not function, to load it automatically it can be chainloaded via GRUB. Also, download and install the Intel drivers as described above.
</p>
<p>Then you will need to download an application called gpu-switch for switching the GPU on dual MacBook Pros, it is fairly easy to use as well. It can be downloaded from here, <a rel="nofollow" class="external free" href="https://github.com/0xbb/gpu-switch">https://github.com/0xbb/gpu-switch</a>.
</p>
<p>Secondly, once you have downloaded gpu-switch, extract the application to your home directory and open up a terminal emulator and cd to that directory. To switch to the Intel graphics, run <code>gpu-switch -i</code> as sudo, and the card will be active on reboot. Conversely, to enable the dedicated card instead, run <code>gpu-switch -d</code> as sudo. You must have booted with the aforementioned patch for this to work.
</p>
<p>Next, gpu-switch will not completely power down the dedicated card. To do that, you will have to create a custom grub menuentry and compile a program that will power off the dedicated card.
</p>
<p>To do that, please refer to the following article, <a href="../en/MacBookPro10,x.html#Graphics_2" title="MacBookPro10,x">MacBookPro10,x#Graphics_2</a>.
</p>
<p>You should now have working integrated graphics and the dedicated GPU should now power down. If you get a blank screen after doing this, wait and see what happens, if it stays blank for a prolonged period of time, try resetting the SMC, and then booting back into Arch.
</p>
<p>I noticed that afterwards VGA switcheroo disabled the nouveau driver, if this workaround still does not work, try installing a cronjob package, and adding the following:
</p>
<p><code>@reboot echo OFF &gt; /sys/kernel/debug/vgaswitcheroo/switch</code>
<code>@reboot echo IGD &gt; /sys/kernel/debug/vgaswitcheroo/switch</code>
</p>
<p>I'm not sure if the vgaswitcheroo commands actually do anything, I need somebody to test this workaround and let me know how it works for them.
</p>
<p>To see if you dedicated GPU is actually disabled, run:
</p>
<pre># cat /sys/kernel/debug/vgaswitcheroo/switch
</pre>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>gpu-switch has been tested only on a select few models, those being MacBookPro9,1, MacBookPro10,1, and MacBookPro11,3. Use at your own risk.</div>
<h3><span class="mw-headline" id="Sound">Sound</span></h3>
<ul>
<li> Headphones work</li>
<li> Speakers work from kernel 3.13 and 3.12.2. 3.12.1 only with patch
<ul>
<li> Patch: <a rel="nofollow" class="external free" href="https://bugzilla.kernel.org/attachment.cgi?id=114081">https://bugzilla.kernel.org/attachment.cgi?id=114081</a>.</li>
<li> See discussion here: <a rel="nofollow" class="external free" href="https://bugzilla.kernel.org/show_bug.cgi?id=64401">https://bugzilla.kernel.org/show_bug.cgi?id=64401</a>
</li>
</ul>
</li>
<li> Optical audio can be turned off and on with above sound patch.</li>
</ul>
<p>If you do not want to hear the annoying sound at system start-up, one way to get rid of it is to turn sound off while under Mac OS.
</p>
<p>Volume keys can be made to work with <code>xfce4-volumed</code> (if you are using Xfce).
</p>
<p>Also, if you are using PulseAudio, sometimes it thinks HDMI is the default sound card; to solve this problem, install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=pavucontrol">pavucontrol</a></span> and set Analog Stereo as the fallback device.
</p>
<h3><span class="mw-headline" id="Touchpad">Touchpad</span></h3>
<p>One method is to install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=xf86-input-synaptics">xf86-input-synaptics</a></span> and configure to your liking in <code>/etc/X11/xorg.conf.d/50-synaptics.conf</code>:
</p>
<pre>Section "InputClass"
    MatchIsTouchpad "on"
    Identifier      "touchpad catchall"
    Driver          "synaptics"
    # 1 = left, 2 = right, 3 = middle
    Option          "TapButton1" "1"  
    Option          "TapButton2" "3"
    Option          "TapButton3" "2"
    # Palm detection
    Option          "PalmDetect" "1"
    # Horizontal scrolling
    Option "HorizTwoFingerScroll" "1"
    # Natural Scrolling (and speed)
    Option "VertScrollDelta" "-100"
    Option "HorizScrollDelta" "-100"
EndSection
</pre>
<h4><span class="mw-headline" id="Ctrl-Click_as_Right-Click">Ctrl-Click as Right-Click</span></h4>
<p>Using this SuperUser receipt <a rel="nofollow" class="external autonumber" href="http://superuser.com/questions/217615/how-to-right-click-using-the-keyboard-from-ubuntu-on-a-mac">[1]</a> I got Ctrl-click working as right-click. I had to increase the sleep time to 0.1 though.
</p>
<h4><span class="mw-headline" id="input-mtrack">input-mtrack</span></h4>
<p>Another method is to use <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/xf86-input-mtrack-git/">xf86-input-mtrack-git</a></span><sup><small>AUR</small></sup>. If you like to have a thumb resting on the touchpad, this driver is the right choice, because it has an option for IgnoreThumb.
</p>
<p>With this config the touchpad behavior becomes more osx-like.
</p>
<pre>/etc/X11/xorg.conf.d/00-touchpad.conf
</pre>
<pre>Section "InputClass"
    MatchIsTouchpad "on"
    Identifier      "Touchpads"
    Driver          "mtrack"
    Option          "Sensitivity" "0.64"
    Option          "FingerHigh" "5"
    Option          "FingerLow" "1"
    Option          "IgnoreThumb" "true"
    Option          "IgnorePalm" "true"
    Option          "DisableOnPalm" "true"
    Option          "TapButton1" "1"
    Option          "TapButton2" "3"
    Option          "TapButton3" "2"
    Option          "TapButton4" "0"
    Option          "ClickFinger1" "1"
    Option          "ClickFinger2" "2"
    Option          "ClickFinger3" "3"
    Option          "ButtonMoveEmulate" "false"
    Option          "ButtonIntegrated" "true"
    Option          "ClickTime" "25"
    Option          "BottomEdge" "30"
    Option          "SwipeLeftButton" "8"
    Option          "SwipeRightButton" "9"
    Option          "SwipeUpButton" "0"
    Option          "SwipeDownButton" "0"
    Option          "ScrollDistance" "75"
    Option          "VertScrollDelta" "-111"
    Option          "HorizScrollDelta" "-111"
EndSection
</pre>
<h3><span class="mw-headline" id="Keyboard_backlight">Keyboard backlight</span></h3>
<ul>
<li> Works, see <a href="../en/MacBook.html#Keyboard_Backlight" title="MacBook">MacBook#Keyboard_Backlight</a>
</li>
<li> On KDE controlling the backlight with the increase or decrease brightness keys work fine, but they need upower to start before the desktop. To do this create the file <code>/etc/systemd/system/kdm.service.d/kbd_backlight.conf</code> with this content (you might need to create the directory as well)</li>
</ul>
<pre>[Unit]
Requires=upower.service
After=upower.service
</pre>
<h3><span class="mw-headline" id="Screen_backlight">Screen backlight</span></h3>
<ul>
<li> Intel, works on Linux 3.13</li>
<li> Framebuffer, works for MacBook Pro 11,1 and 11,3 via <code>/sys/class/backlight/gmux_backlight/brightness</code>.</li>
<li> Brightness in <code>/sys/class/backlight/gmux_backlight/brightness</code> can be modified comfortably via the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gmux_backlight/">gmux_backlight</a></span><sup><small>AUR</small></sup> utility without root privileges. Requires the <code>setpci</code> setting below.</li>
<li> Nvidia, does not work using default settings. Try adding <code>setpci -v -H1 -s 00:01.00 BRIDGE_CONTROL=0</code> to <code>/etc/rc.local</code>.</li>
</ul>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>If the screen does not show the prompt or the login manager (i.e. a black screen), append <code>i915.invert_brightness=1</code> to the kernel. </div>
<h3><span class="mw-headline" id="Suspend">Suspend</span></h3>
<ul>
<li> Works from Linux 3.13
<ul><li> It may be necessary to disable USB's wakeup ability by by echoing 'XHC1' to '/proc/acpi/wakeup' in order to prevent immediate wakeup on suspend.</li></ul>
</li>
<li> No backlight after suspend with Linux 3.12
<ul><li> Use hibernate instead</li></ul>
</li>
</ul>
<h3><span class="mw-headline" id="Powersave">Powersave</span></h3>
<p>Disabling the internal cardreader and bluetooth controller may save battery life. When not using them, create the following <a href="../en/Udev.html" title="Udev">udev</a> rules:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/rules.d/99-apple_cardreader.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">SUBSYSTEMS=="usb", ATTRS{idVendor}=="05ac", ATTRS{idProduct}=="8406", RUN+="/usr/local/sbin/remove_ignore_usb-device.sh 05ac 8406"</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/rules.d/99-apple_broadcom_bcm2046_bluetooth.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">SUBSYSTEMS=="usb", ATTRS{idVendor}=="05ac", ATTRS{idProduct}=="8289", RUN+="/usr/local/sbin/remove_ignore_usb-device.sh 05ac 8289"
SUBSYSTEMS=="usb", ATTRS{idVendor}=="0a5c", ATTRS{idProduct}=="4500", RUN+="/usr/local/sbin/remove_ignore_usb-device.sh 0a5c 4500"</pre>
<p>As udev's <code>OPTIONS=="ignore_device"</code> may not work reliably, the above rules use <a rel="nofollow" class="external text" href="https://gist.github.com/anonymous/9c9d45c4818e3086ceca">a script</a> to manually remove the usb device from <code>/sys/bus/usb/devices/</code>.
</p>
<p>If battery life is not satisfactory, it may help to use power saving utilities, such as <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=tlp">tlp</a></span>, and/or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=powertop">powertop</a></span> from the official repositories. To better optimize battery life, TLP also has a configuration file located at <code>/etc/default/tlp</code> that you can edit to suit your machine. For more information, visit the wiki pages for these tools, <a href="../en/TLP.html" title="TLP">TLP</a> and <a href="../en/Powertop.html" title="Powertop">Powertop</a>, respectively.
</p>
<h3><span class="mw-headline" id="SD_Card_Reader">SD Card Reader</span></h3>
<ul><li> Disappears sporadically after suspend as of Linux 3.18. Workaround is to create <code>/etc/modprobe.d/xhci-reset-on-suspend.conf</code> with:</li></ul>
<pre>  # Reset XHCI USB devices on suspend/resume, fixes SD Card reader vanishing after suspend 
  options xhci_hcd quirks=0x80
</pre>
<p>Note: As of Linux 3.18.6-1 (and possibly earlier versions post-3.18), this fix <b>may</b> not be needed and might cause issues ranging from failed suspend to the SD card not being recognized at all. Test with and without the fix to determine which works best for you.
</p>
<h3><span class="mw-headline" id="Repurpose_the_power_key">Repurpose the power key</span></h3>
<p>By default systemd handles the rMBPs power key as defined in /etc/systemd/logind.conf. By setting
</p>
<pre>   HandlePowerKey=ignore
</pre>
<p>systemd ignores power key events.
</p>
<p>Now the power key can be repurposed as keycode 124. For example in i3 conf:
</p>
<pre>   bindcode 124 ...
</pre>
<h3><span class="mw-headline" id="Web_cam">Web cam</span></h3>
<p>A reverse engineered driver is being developed here: <a rel="nofollow" class="external free" href="https://github.com/patjak/bcwc_pcie/">https://github.com/patjak/bcwc_pcie/</a> . It is marked experimental, but basic functionality seems to be working. Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bcwc-pcie-dkms/">bcwc-pcie-dkms</a></span><sup><small>AUR</small></sup> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bcwc-pcie-git/">bcwc-pcie-git</a></span><sup><small>AUR</small></sup>.
</p>
<h2><span class="mw-headline" id="What_does_not_work">What does not work</span></h2>
<p>Updated 2016-07-21
</p>
<h3><span class="mw-headline" id="General">General</span></h3>
<h3><span class="mw-headline" id="Wi-Fi">Wi-Fi</span></h3>
<ul><li> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/broadcom-wl/">broadcom-wl</a></span><sup><small>AUR</small></sup> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/broadcom-wl-dkms/">broadcom-wl-dkms</a></span><sup><small>AUR</small></sup> from the <a href="../en/Arch_User_Repository.html" title="AUR" class="mw-redirect">AUR</a> works
<ul><li> Stability is an issue for some, look at <a href="../en/Broadcom_wireless.html" title="Broadcom wireless">Broadcom wireless</a> for possible fixes (e.g. downgrading kernel works if your card is BCM4360)</li></ul>
</li></ul>
<h3><span class="mw-headline" id="Backlight_keys_.2F_Suspend_support">Backlight keys / Suspend support</span></h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/linux-macbook/">linux-macbook</a></span><sup><small>AUR</small></sup> is an AUR package created specifically for MacBook laptops that includes patches for these issues, as well fixing powering off correctly and CPU frequency scaling with the intel_pstate driver.
</p>
<h2><span class="mw-headline" id="Discussions">Discussions</span></h2>
<ul><li> <a rel="nofollow" class="external free" href="https://bbs.archlinux.org/viewtopic.php?id=171883">https://bbs.archlinux.org/viewtopic.php?id=171883</a>
</li></ul>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li> <a href="../en/MacBookPro10,x.html" title="MacBookPro10,x">MacBookPro10,x</a>
</li>
<li> <a href="../en/MacBook.html" title="MacBook">MacBook</a>
</li>
</ul>

</div>
<div id="catlinks" class="catlinks">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Apple.html" title="Category:Apple">Apple</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li></ul>
</div>
</div>					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
Extracted from <a href="https://wiki.archlinux.org"> ArchWiki </a> and licensed under <a href="http://www.gnu.org/copyleft/fdl.html"> GDL >= 1.3</a>
		</div>
		</div>
		</body>
</html>
