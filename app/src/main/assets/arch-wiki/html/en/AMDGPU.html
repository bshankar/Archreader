<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8">
<title>AMDGPU - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style></style>
<meta name="generator" content="MediaWiki 1.26.4">
<meta name="robots" content="noindex,follow">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-AMDGPU skin-archlinux action-view">

		<div id="globalWrapper" style="width: 100%">
		<div id="column-content">
			<div id="content" class="mw-body" role="main" style="margin: 0.5em; margin-bottom:0; margin-top:0">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">AMDGPU</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="contentSub"></div>
										<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div style="width:45%; margin: 0 0 0.5em 0.5em;">
<p style="background:#333; color:white; padding:0.2em; border-bottom:5px #08c solid; margin:0; text-align:center; font-weight:bold;">Related articles</p>
<ul style="list-style-type:none; margin:0; padding:0.3em;">
<li style="padding:0.4em 0; line-height:1;"><a href="../en/AMD_Catalyst.html" title="AMD Catalyst">AMD Catalyst</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/ATI.html" title="ATI">ATI</a></li>
<li style="padding:0.4em 0; line-height:1;"><a href="../en/Xorg.html" title="Xorg">Xorg</a></li>
</ul>
</div>
<p><b>amdgpu</b> is the open source graphics driver for the latest AMD Radeon graphics cards.
</p>
<p>At the moment there is support for the <a rel="nofollow" class="external text" href="http://xorg.freedesktop.org/wiki/RadeonFeature/">Volcanic Islands</a>, some cards of the <a rel="nofollow" class="external text" href="https://www.phoronix.com/scan.php?page=news_item&amp;px=AMD-AMDGPU-Released">Sea Islands</a> family and the <a rel="nofollow" class="external text" href="https://www.phoronix.com/scan.php?page=news_item&amp;px=AMDGPU-SI-Experimental-Code">Southern Islands</a> family (more experimental than Sea Islands and coming only in Linux 4.9). AMD has absolutely no plans for supporting the pre-GCN GPUs.
</p>
<p>Owners of unsupported AMD/ATI video cards can use the <a href="../en/ATI.html" title="ATI">Radeon open source</a> or <a href="../en/AMD_Catalyst.html" title="AMD Catalyst">AMD's proprietary</a> driver instead.
</p>
<div id="toc" class="toc">
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Selecting_the_right_driver"><span class="tocnumber">1</span> <span class="toctext">Selecting the right driver</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Installation"><span class="tocnumber">2</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#AMDGPU_PRO"><span class="tocnumber">2.1</span> <span class="toctext">AMDGPU PRO</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Configuration"><span class="tocnumber">3</span> <span class="toctext">Configuration</span></a></li>
<li class="toclevel-1 tocsection-5">
<a href="#Loading"><span class="tocnumber">4</span> <span class="toctext">Loading</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Enable_early_KMS"><span class="tocnumber">4.1</span> <span class="toctext">Enable early KMS</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#Performance_tuning"><span class="tocnumber">5</span> <span class="toctext">Performance tuning</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Enabling_video_acceleration"><span class="tocnumber">5.1</span> <span class="toctext">Enabling video acceleration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Enable_amdgpu_for_Sea_Islands_or_Southern_Islands_cards"><span class="tocnumber">6</span> <span class="toctext">Enable amdgpu for Sea Islands or Southern Islands cards</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Disable_radeon_driver"><span class="tocnumber">7</span> <span class="toctext">Disable radeon driver</span></a></li>
<li class="toclevel-1 tocsection-11">
<a href="#Troubleshooting"><span class="tocnumber">8</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Xorg_or_applications_won.27t_start"><span class="tocnumber">8.1</span> <span class="toctext">Xorg or applications won't start</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Selecting_the_right_driver">Selecting the right driver</span></h2>
<p>Depending on the card you have, find the right driver in <a href="../en/Xorg.html#ATI" title="Xorg">Xorg#ATI</a>. This page has instructions for <b>AMDGPU</b> and <b>AMDGPU PRO</b>.
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>If coming from the proprietary Catalyst driver, see <a href="../en/AMD_Catalyst.html#Uninstallation" title="AMD Catalyst">AMD Catalyst#Uninstallation</a> first.</div>
<p><a href="../en/Help:Reading.html#Installation_of_packages" title="Install" class="mw-redirect">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=xf86-video-amdgpu">xf86-video-amdgpu</a></span> package. It provides the DDX driver for 2D acceleration and it pulls in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=mesa">mesa</a></span> as a dependency, providing the DRI driver for 3D acceleration.
</p>
<p>To enable OpenGL support, also install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=mesa-libgl">mesa-libgl</a></span>. If you are on x86_64 and need 32-bit support, also install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=lib32-mesa-libgl">lib32-mesa-libgl</a></span> from the <a href="../en/Multilib.html" title="Multilib">multilib</a> repository.
</p>
<p>Support for <a href="#Enabling_video_acceleration">accelerated video decoding</a> is provided by <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=mesa-vdpau">mesa-vdpau</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=lib32-mesa-vdpau">lib32-mesa-vdpau</a></span> packages.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=xf86-video-amdgpu">xf86-video-amdgpu</a></span> package is only used for Xorg acceleration and not strictly required.</div>
<h3><span class="mw-headline" id="AMDGPU_PRO">AMDGPU PRO</span></h3>
<div style="padding: 5px; margin: 0.50em 0; background-color: #FFDDDD; border: thin solid #DDBBBB; overflow: hidden;">
<strong> Warning: </strong>AMDGPU PRO is still in beta. Arch Linux is not officially supported.</div>
<p>AMD provides a proprietary, binary userland driver called <i>AMDGPU PRO</i>, which works on top of the open-source AMDGPU kernel driver. This hybrid approach allows the in-kernel component to be recompiled by the Arch Linux maintainers when required (e.g. on a kernel or Xorg update), while keeping the same binary userspace part. This should remedy the problem where the driver provided by AMD is out of date and incompatible with newer kernels or Xorg versions (a problem that was very common with the old <a href="../en/AMD_Catalyst.html" title="AMD Catalyst">AMD Catalyst</a> driver). For a detailed overview of the hybrid system, see <a rel="nofollow" class="external text" href="http://www.phoronix.com/scan.php?page=news_item&amp;px=MTgwODA">this article</a>.
</p>
<p>The AMDGPU PRO driver provides OpenGL, OpenCL, Vulkan and VDPAU support. It aims to provide better performance than the open-source driver.
</p>
<p>See the <a rel="nofollow" class="external text" href="http://support.amd.com/en-us/kb-articles/Pages/AMD-Radeon-GPU-PRO-Linux-Beta-Driver%E2%80%93Release-Notes.aspx">release notes</a> and the <a rel="nofollow" class="external text" href="https://www.phoronix.com/forums/forum/linux-graphics-x-org-drivers/amd-linux/855699-amd-representative-says-their-vulkan-linux-driver-will-be-here-soon/page6">announcement at the Phoronix forum</a> for more information.
</p>
<p>There are packages for the amdgpu-pro components in the <a href="../en/Arch_User_Repository.html" title="AUR" class="mw-redirect">AUR</a> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/amdgpu-pro/">amdgpu-pro</a></span><sup><small>AUR</small></sup>), visit <a rel="nofollow" class="external free" href="https://github.com/Corngood/archlinux-amdgpu">https://github.com/Corngood/archlinux-amdgpu</a> for issues or pull requests.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>Xorg will automatically load the driver and it will use your monitor's EDID to set the native resolution. Configuration is only required for tuning the driver.
</p>
<p>If you want manual configuration, create <code>/etc/X11/xorg.conf.d/20-amdgpu.conf</code>, and add the following:
</p>
<pre>Section "Device"
    Identifier "AMD"
    Driver "amdgpu"
EndSection
</pre>
<p>Using this section, you can enable features and tweak the driver settings.
</p>
<h2><span class="mw-headline" id="Loading">Loading</span></h2>
<p>The <code>amdgpu</code> kernel module should load fine automatically on system boot.
</p>
<p>If it does not happen, then:
</p>
<ul>
<li> Make sure you have the latest <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=linux-firmware">linux-firmware</a></span> package installed. This driver requires the latest firmware for each model to successfully boot.</li>
<li> Make sure you do <b>not</b> have <code>nomodeset</code> or <code>vga=</code> as a <a href="../en/Kernel_parameters.html" title="Kernel parameter" class="mw-redirect">kernel parameter</a>, since <code>amdgpu</code> requires <a href="../en/Kernel_mode_setting.html" title="KMS" class="mw-redirect">KMS</a>.</li>
<li> Also, check that you have not disabled <code>amdgpu</code> by using any <a href="../en/Kernel_modules.html#Blacklisting" title="Kernel modules">kernel module blacklisting</a>.</li>
</ul>
<h3><span class="mw-headline" id="Enable_early_KMS">Enable early KMS</span></h3>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDFFDD; border: thin solid #BBDDBB; overflow: hidden;">
<strong> Tip: </strong>If you have problems with the resolution, <a href="../en/Kernel_mode_setting.html#Forcing_modes_and_EDID" title="Kernel mode setting">Kernel mode setting#Forcing modes and EDID</a> may help.</div>
<p><a href="../en/Kernel_mode_setting.html" title="Kernel mode setting">Kernel mode setting</a> (KMS) is supported by the amdgpu driver and is mandatory and enabled by default. 
</p>
<p>KMS is typically initialized after the <a href="../en/Arch_boot_process.html#initramfs" title="Arch boot process">initramfs stage</a>. It is possible, however, to enable KMS during the initramfs stage. To do this, add the <code>amdgpu</code> module to the <code>MODULES</code> line in <code>/etc/mkinitcpio.conf</code>:
</p>
<pre>MODULES="... amdgpu ..."
</pre>
<p>Now, regenerate the initramfs:
</p>
<pre># mkinitcpio -p linux
</pre>
<p>The change takes effect at the next reboot.
</p>
<h2><span class="mw-headline" id="Performance_tuning">Performance tuning</span></h2>
<h3><span class="mw-headline" id="Enabling_video_acceleration">Enabling video acceleration</span></h3>
<p>See <a href="../en/Hardware_video_acceleration.html" title="Hardware video acceleration">Hardware video acceleration</a>.
</p>
<h2><span class="mw-headline" id="Enable_amdgpu_for_Sea_Islands_or_Southern_Islands_cards">Enable amdgpu for Sea Islands or Southern Islands cards</span></h2>
<p><code>amdgpu</code> has experimental support for Sea Islands (CIK) and Southern Islands (SI; since Linux 4.9) cards, which is disabled by default. One possible reason why you might want to enable it and switch from radeon to <code>amdgpu</code> is that AMD announced their user space <a rel="nofollow" class="external text" href="https://www.khronos.org/vulkan/">Vulkan</a> driver will only be supporting the new <code>amdgpu</code> stack <a rel="nofollow" class="external autonumber" href="https://phoronix.com/scan.php?page=news_item&amp;px=AMDGPU-Vulkan-Driver-Only">[1]</a>. Same might be the case for the new OpenCL driver, which was also mentioned in the <a rel="nofollow" class="external text" href="http://www.x.org/wiki/Events/XDC2015/Program/deucher_zhou_amdgpu.pdf">XDC presentation</a>.
</p>
<p>If you want to enable <code>amdgpu</code> and use it with your Sea Islands or Southern Islands product, you have to recompile your kernel. Probably the easiest way to setup a custom kernel is using the ABS, described in <a href="../en/Kernels/Arch_Build_System.html" title="Kernels/Arch Build System">Kernels/Arch Build System</a>. You can also uncomment <code>make menuconfig</code> or <code>make nconfig</code> in the PKGBUILD, which will allow you to verify that the CIK option is selected by following the instructions from <a rel="nofollow" class="external text" href="https://wiki.gentoo.org/wiki/Amdgpu#Feature_support">Gentoo wiki</a>.
</p>
<p>For Sea Islands (CIK), set "Enable amdgpu support for CIK parts" to "yes", then compile and install your kernel.
</p>
<pre>CONFIG_DRM_AMDGPU_CIK=Y
</pre>
<p>For Southern Islands (SI; since Linux 4.9), set "Enable amdgpu support for SI parts" to "yes", then compile and install your kernel.
</p>
<pre>CONFIG_DRM_AMDGPU_SI=Y
</pre>
<p>It may also be needed to use the <code>amdgpu.exp_hw_support=1</code> <a rel="nofollow" class="external autonumber" href="https://www.phoronix.com/scan.php?page=news_item&amp;px=AMDGPU-Iceland-Experimental">[2]</a> as <a href="../en/Kernel_parameters.html" title="Kernel parameter" class="mw-redirect">kernel parameter</a> or by setting the <a href="../en/Kernel_modules.html#Using_files_in_.2Fetc.2Fmodprobe.d.2F" title="Kernel modules">kernel module</a> options.
</p>
<h2><span class="mw-headline" id="Disable_radeon_driver">Disable radeon driver</span></h2>
<p>To prevent <code>radeon</code> from loading, you can disable it in the Kconfig or <a href="../en/Kernel_modules.html#Blacklisting" title="Blacklist" class="mw-redirect">blacklist</a> the <code>radeon</code> module.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/radeon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">
blacklist radeon</pre>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Xorg_or_applications_won.27t_start">Xorg or applications won't start</span></h3>
<ul>
<li> "(EE) AMDGPU(0): [DRI2] DRI2SwapBuffers: drawable has no back or front?" error after opening glxgears, can open Xorg server but OpenGL apps crash.</li>
<li> "(EE) AMDGPU(0): Given depth (32) is not supported by amdgpu driver" error, Xorg won't start.</li>
</ul>
<p>Setting the screen's depth under Xorg to 16 or 32 will cause problems/crash. To avoid that, you should use a standard screen depth of 24 by adding this to your "screen" section (assuming you have one, assuming you don't add this to <code>/etc/X11/xorg.conf.d/10-screen.conf</code>).
</p>
<pre>Section "Screen"
       DefaultDepth    24
       SubSection      "Display"
               Depth   24
       EndSubSection
EndSection
</pre>
</div>
<div id="catlinks" class="catlinks"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Graphics.html" title="Category:Graphics">Graphics</a></li>
<li><a href="../en/Category:X_server.html" title="Category:X server">X server</a></li>
</ul>
</div></div>					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
Extracted from <a href="https://wiki.archlinux.org"> ArchWiki </a> and licensed under <a href="http://www.gnu.org/copyleft/fdl.html"> GDL >= 1.3</a>
		</div>
		</div>
		</body>
</html>
