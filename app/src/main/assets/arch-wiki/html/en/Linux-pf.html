<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8">
<title>Linux-pf - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style></style>
<meta name="generator" content="MediaWiki 1.26.4">
<meta name="robots" content="noindex,follow">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Linux-pf skin-archlinux action-view">

		<div id="globalWrapper" style="width: 100%">
		<div id="column-content">
			<div id="content" class="mw-body" role="main" style="margin: 0.5em; margin-bottom:0; margin-top:0">
				<a id="top"></a>
				
				<div class="mw-indicators">
</div>
				<h1 id="firstHeading" class="firstHeading" lang="en">Linux-pf</h1>
				
				<div id="bodyContent" class="mw-body-content">
					<div id="contentSub"></div>
										<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" width="48" height="48"></a></p>
<div>
<b>Reason:</b> UKSM is no longer part of linux-pf (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Linux-pf#linux-pf_does_not_contain_TuxOnIce_and_UKSM_anymore">Talk:Linux-pf#linux-pf does not contain TuxOnIce and UKSM anymore</a>)</div>
</div>
<p><a rel="nofollow" class="external text" href="http://pf.natalenko.name/">Linux-pf</a> is a kernel package based on the stock -ARCH kernel, with the following patches applied:
</p>
<ul>
<li> <a rel="nofollow" class="external text" href="http://ck-hack.blogspot.com/">The latest Con Kolivas' -ck patchset, including BFS</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://algo.ing.unimo.it/people/paolo/disk_sched/">BFQ</a> (as default I/O scheduler)</li>
<li> <a rel="nofollow" class="external text" href="http://kerneldedup.org/projects/uksm/">UKSM</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://aufs.sourceforge.net/">AUFS3</a>
</li>
</ul>
<div id="toc" class="toc">
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Installation"><span class="tocnumber">1</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#From_the_unofficial_repository"><span class="tocnumber">1.1</span> <span class="toctext">From the unofficial repository</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#From_the_AUR"><span class="tocnumber">1.2</span> <span class="toctext">From the AUR</span></a></li>
<li class="toclevel-2 tocsection-4">
<a href="#Manual_compilation"><span class="tocnumber">1.3</span> <span class="toctext">Manual compilation</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Install_compiled_package"><span class="tocnumber">1.3.1</span> <span class="toctext">Install compiled package</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Configuration"><span class="tocnumber">2</span> <span class="toctext">Configuration</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Tips_and_tricks"><span class="tocnumber">3</span> <span class="toctext">Tips and tricks</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Forum_thread_for_linux-pf"><span class="tocnumber">4</span> <span class="toctext">Forum thread for linux-pf</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#See_also"><span class="tocnumber">5</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<h3><span class="mw-headline" id="From_the_unofficial_repository">From the unofficial repository</span></h3>
<p>Precompiled packages (generic or CPU-family optimized) are available from the <a href="../en/Unofficial_user_repositories.html#archlinuxcn" title="Unofficial user repositories">archlinuxcn</a> unofficial repository. See <a href="../en/Unofficial_user_repositories.html" title="Unofficial user repositories">Unofficial user repositories</a> for configuration details.
</p>
<p>After an <a href="../en/Pacman.html#Upgrading_packages" title="Pacman">upgrade</a>, running <code>pacman -Sl <i>repo_name</i></code> will show the packages available in the given repository. Afterwards, just install the <i>linux-pf</i> and <i>linux-pf-headers</i> packages (for generic binaries - platform-specific binaries are also available in some repositories and will be listed in the output from the aforementioned pacman command). See the <a href="#Configuration">#Configuration</a> section for additional configuration steps.
</p>
<h3><span class="mw-headline" id="From_the_AUR">From the AUR</span></h3>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/linux-pf/">linux-pf</a></span><sup><small>AUR</small></sup> from the <a href="../en/Arch_User_Repository.html" title="AUR" class="mw-redirect">AUR</a>. A long-term support version of linux-pf is available with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/linux-pf-lts/">linux-pf-lts</a></span><sup><small>AUR</small></sup>.
</p>
<h3><span class="mw-headline" id="Manual_compilation">Manual compilation</span></h3>
<p>There are a number of options a user is asked to choose from, should he/she select to compile from the PKGBUILD:
</p>
<pre>
==&gt; Hit &lt;Y&gt; to use your running kernel's config
    (needs IKCONFIG and IKCONFIG_PROC)
==&gt; Hit &lt;L&gt; to run 'make localmodconfig'
==&gt; Hit &lt;N&gt; (or just &lt;ENTER&gt;) to build an all-inclusive kernel like stock -ARCH
    (warning: it can take a looong time)
</pre>
<p>The &lt;Y&gt; option is for users who have already compiled and are running a custom kernel. The PKGBUILD reads the running kernel's configuration and uses it for the subsequent compilation.
The &lt;L&gt; option tries some kind of autodetection of the user's hardware: it first tries to use the <a href="../en/Modprobed-db.html" title="Modprobed-db">modprobed-db</a> module database, then falls back to the linux kernel's <code>make localmodconfig</code> functionality. The last option is self-explanatory.
</p>
<pre>
==&gt; Kernel configuration options before build:
    &lt;M&gt; make menuconfig (console menu)
    &lt;N&gt; make nconfig (newer alternative to menuconfig)
    &lt;G&gt; make gconfig (needs gtk)
    &lt;X&gt; make xconfig (needs qt)
    &lt;O&gt; make oldconfig
    &lt;ENTER&gt; to skip configuration and start compiling
</pre>
<p>Choose one of these to use your favourite user interface for configuring the kernel. Note that the last option might still prompt with unresolved/new configuration options, if you have selected &lt;Y&gt; or &lt;L&gt; in the previous step.
</p>
<pre>
==&gt; An non-generic CPU was selected for this kernel.
==&gt; Hit &lt;G&gt;     :  to create a generic package named linux-pf
==&gt; Hit &lt;ENTER&gt; :  to create a package named after the selected CPU
                   (e.g. linux-pf-core2 - recommended)
==&gt; This option affects ONLY the package name. Whether or not the
==&gt; kernel is optimized was determined at the previous config step.
</pre>
<p>If you have selected a specific CPU optimization for your kernel in the previous step, the default action is to append the CPU to the package name. This way, a subsequent package update from the repository will pull the optimized package and not the generic one. This also will help better compatibility with 3rd party precompiled modules (e.g. nvidia-pf), which might break things if loaded on optimized linux-pf kernels.
</p>
<h4><span class="mw-headline" id="Install_compiled_package">Install compiled package</span></h4>
<p>After the compilation finishes, an additional <i>linux-pf-headers[-cpu]</i> package will be created. Do not forget to install it too, if you plan on using additional modules like <a href="../en/NVIDIA.html" title="NVIDIA">NVIDIA</a> or <a href="../en/VirtualBox.html" title="VirtualBox">VirtualBox</a>.
</p>
<pre># pacman -U linux-pf-core2-3.3.2-1-$CPUTYPE.pkg.tar.xz linux-pf-headers-core2-3.3.2-1-$CPUTYPE.pkg.tar.xz
</pre>
<p>During the kernel installation, <a href="../en/Mkinitcpio.html" title="Mkinitcpio">mkinitcpio</a> will be called by the install script to recreate the initramfs.
</p>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong> Note: </strong>If you make any changes to <code>/etc/mkinitcpio.conf</code> after the installation, you must run <code>mkinitcpio -p linux-pf</code> to have the initial ramdisk recreated.</div>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>Then, you need to add a boot entry in <a href="../en/Boot_Loader.html#Configuration_files" title="Boot Loader" class="mw-redirect">boot loader configuration file</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" title="ArchWiki:Requests">broken link</a>: invalid section]</sup> which points to linux-pf (the following example is from one of the maintainer's boxes):
</p>
<pre>
title  Linux-pf 3.2
root   (hd0,4)
kernel (hd0,0)/vmlinuz-linux-pf root=/dev/disk/by-label/ROOT ro vga=0x318 lapic resume=/dev/disk/by-label/SWAP video=vesafb:ywrap,mtrr:3 fastboot quiet
initrd (hd0,0)/initramfs-linux-pf.img
</pre>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<ul>
<li> If you notice disk-related performance problems or occasional hiccups, it might be an I/O scheduler issue. Try a different one than the linux-pf default (BFQ) by echoing to <code>/sys/block/sda/queue/scheduler</code> <i>cfq</i>, <i>noop</i> or <i>deadline</i>: <code># echo noop &gt;</code>. Note, the aforementioned command only sets the I/O scheduler for the 1st hard drive and additional <i>echoes</i> will be needed if you have more. If the situation improves, then append "<i>elevator</i>=<i><b>cfq</b></i>" (or <i><b>noop</b></i> or <i><b>deadline</b></i>) to the linux-pf command line in <code>/boot/grub/menu.lst</code>, to make the change permanent.</li>
<li> For people who build their own tailored kernels and compilation aborts with with an error about "missing include/config/dvb/*.h files", setting <i>[*] Digital TV support</i> at <i>Device Drivers / &lt;M&gt; Multimedia support</i> and leaving everything else out, creates just the necessary dvb.h, which allows the compilation to continue.</li>
</ul>
<h2><span class="mw-headline" id="Forum_thread_for_linux-pf">Forum thread for linux-pf</span></h2>
<p>There is a <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=103462">discussion thread</a> at the BBS for reporting errors, impressions, ideas and requests.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li> <a rel="nofollow" class="external text" href="https://bitbucket.org/nous/linux-pf/">linux-pf mercurial repository</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://pf.natalenko.name/">Patchset homepage</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://pf.natalenko.name/forum">Patchset community forum</a>
</li>
<li> <a rel="nofollow" class="external text" href="http://freecode.com/projects/pf-kernel">Patchset changelog</a>
</li>
</ul>

</div>
<div id="catlinks" class="catlinks">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Kernel.html" title="Category:Kernel">Kernel</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
<li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li>
</ul>
</div>
</div>					<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
Extracted from <a href="https://wiki.archlinux.org"> ArchWiki </a> and licensed under <a href="http://www.gnu.org/copyleft/fdl.html"> GDL >= 1.3</a>
		</div>
		</div>
		</body>
</html>
